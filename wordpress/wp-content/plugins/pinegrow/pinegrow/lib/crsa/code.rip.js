function updateRulesListOriginal(s,e,n){e[n]&&(c=$("<ul/>").appendTo(s),r=null,$.each(e[n],function(e,t){var l=t.media||null,a=(r!=l&&(r&&(c=c.parent().closest("ul")),l)&&(a=$("<li/>").appendTo(c).html('<div class="crsa-cm-media">'+l+"</div>").data("media",l),c=$("<ul/>").appendTo(a)),r=l,$("<li/>",{class:"crsa-input-rule-c"}).appendTo(c).data("crsa-rule",t));$("<a/>",{class:"crsa-input-rule",href:"#"}).html(t.selector).appendTo(a);"class"==t.type&&$("<a/>",{class:"crsa-input-rule-remove",href:"#"}).html("x").appendTo(a)}),r)&&(c=c.parent().closest("ul"));var c,r,t=$("<div/>",{class:"crsa-input-rule-c"}).appendTo(s),d=($("<a/>",{class:"crsa-input-rule",href:"#"}).html("+ Add Class").appendTo(t),$("<div/>",{class:"crsa-rule-props"}).appendTo(s),s.find("a.crsa-input-rule-remove").on("click",function(e){var t=$(e.delegateTarget).parent().data("crsa-rule"),l=selectedElement.data,t=(l.removeClass(t.class),getValuesForObject(selectedElement));s.html(""),updateRulesList(s,l,t,n),e.preventDefault()}),$("#crsa-rules-out .panel-content")),o=selectedElement.data;s.find("a.crsa-input-rule").on("click",function(e){var t,l,a=$(e.delegateTarget).parent().data("crsa-rule");a||(l=$("#crsa-rules"),d.html("").append(l),$("#crsa-rules-out").data("panel").show()),a&&(1?t=getObjectFromRule(a):("class"==a.type&&o.addClass(a),t=getObjectFromRule(a),selectedPage.crsacss("addRule",t.selector+" {}"),l=getValuesForObject(selectedElement),s.html(""),updateRulesList(s,o,l,n)),methods.showProperties(t,s.find("> .crsa-rule-props"))),e.preventDefault()}),d.off("crsa-cm-class-selected").on("crsa-cm-class-selected",function(e,t){var l;t.selector;"class"==t.type&&(l=t.class,willMakeChange(selectedPage,getElementName(o)+" | Add class "+l),o.addClass(l),selectElement(o),didMakeChange(selectedPage))}),d.off("crsa-cm-new").on("crsa-cm-new",function(e,t){selectedPage.crsacss("addLessRule",t,{},function(e){"class"==e.type&&o.addClass(e.class);var t=getObjectFromRule(e),l=getValuesForObject(selectedElement);s.html(""),updateRulesList(s,o,l,n),methods.showProperties(t,s.find("> .crsa-rule-props")),selectedPage.crsacss("closeClassManager",d)})})}var CrsaPlacer=function(){function a(){return selectedElement&&"element"==selectedElement.type?h.$element&&selectedElement.data.get(0)==h.$element.get(0)?selectedElement.data.is("body")?null:selectedElement.data.parent():selectedElement.data:null}var u=$("#crsa-placer"),m=u.find(".panel-content"),h=(this.def=null,this.$element=null,this.clone=!1,this.$cloneSource=null,this.$target=null,this.undoRecorded=!1,this),g=($body.on("crsa-element-selected",function(e,t){var l,a;u.is(":visible")&&(t&&"element"==t.type?(this.undoRecorded=!1,l=t.data,a=getIframeOfElement(l),h.$target=l,h.$element&&h.$element.get(0)==l.get(0)||g(a,l,h.$element,h.def)):g(null,null,h.$element,h.def))}),this.setDef=function(e){this.def=e,this.$element=null,this.clone=!1,this.$cloneSource=null,this.$target=this.$target||a(),this.undoRecorded=!1,g(selectedPage,this.$target,null,h.def)},this.setElement=function(e,t){this.$element=e,this.clone=t,this.$cloneSource=t?e:null,this.def&&($("li.crsa-factory-element.selected").removeClass("selected"),this.def=null);var l=a();this.$target=l,t&&(this.$element=e.clone(!0),removeCrsaClasses(this.$element)),this.undoRecorded=!1,g(selectedPage,l,this.$element,null)},function(a,l,s){u.find("div.crsa-drop-target").remove();var n=$('<div class="crsa-drop-target"></div>'),c=n,r=h.def;if(s?r=getType(s):h.$cloneSource&&(r=getType(h.$cloneSource)),a&&l&&r){$('<div class="alert alert-info">Select the position for <strong>'+r.name+"</strong>:</div>").appendTo(c);var e=l,t=[];if(!l.is("body"))for(;0!=(e=e.parent()).length&&(t.push(e.get(0)),!e.is("body"))&&t.length<3;);for(var d=t.length-1;0<=d;d--)var o=$(t[d]),c=$('<div class="crsa-drop-parent"></div>').html(getElementName(o,null,!0,!1,!1)).appendTo(c).data("parent",o);c=$('<div class="crsa-drop-selected"></div>').appendTo(c),$("<span/>").html(getElementName(l,null,!0,!1,!1)).appendTo(c);function i(e){crsaWillChangeDom();var t=e.data("loc"),l=e.data("loc-el");s||(s=h.$cloneSource?h.$cloneSource.clone(!0):createElementFromDefinition(r),removeCrsaClasses(s)),s[t](l),scrollCanvasToElement(s,a)}var p=l.children().filter(function(e){return!!getType($(this))});$("<div/>",{class:"crsa-drop-loc crsa-drop-loc-prepend"}).data("loc","prependTo").data("loc-el",l).appendTo(c),p.each(function(e,t){var l=$(t);$("<div/>",{class:"crsa-drop-child"}).data("child",l).html(getElementName(l,null,!0,!1,!1)).appendTo(c),e!=p.length-1&&$("<div/>",{class:"crsa-drop-loc crsa-drop-loc-after"}).data("loc","insertAfter").data("loc-el",l).appendTo(c)}),$("<div/>",{class:"crsa-drop-loc crsa-drop-loc-append"}).data("loc","appendTo").data("loc-el",l).appendTo(c);c.find(".crsa-drop-loc").on("mouseover",function(e){var t=$(e.delegateTarget);i(t),highlightElement(s),s.addClass("crsa-placed")}).on("mouseout",function(e){s&&(s.detach(),highlightElement(null),s.removeClass("crsa-placed"))}).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=$(e.delegateTarget),t=(h.undoRecorded||(s&&s.detach(),willMakeChange(a,"Placed / "+r.name),s&&i(t),h.undoRecorded=!0),s||i(t),s.removeClass("crsa-placed"),methods.updateStructureAndWireAllElemets(a,s.parent(),!0),highlightElement(null),didMakeChange(a,s.parent()),elementWasInserted(s),s=null,n.scrollTop());g(a,l,s),u.find("div.crsa-drop-target").scrollTop(t)}),c.find(".crsa-drop-child").on("mouseover",function(e){var t=$(e.delegateTarget).data("child");highlightElement(t),scrollCanvasToElement(t,a)}).on("mouseout",function(e){$(e.delegateTarget).data("child");highlightElement(null)}).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=$(e.delegateTarget).data("child");selectElement(t),scrollCanvasToElement(t,a),g(a,t,s)}),n.find(".crsa-drop-parent").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=$(e.delegateTarget).data("parent");selectElement(t),scrollCanvasToElement(t,a),g(a,t,s)})}else $('<div class="alert alert-info">Select the target element...</div>').appendTo(c);m.append(n),u.is(":visible")||u.show()})};
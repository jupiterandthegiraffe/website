window.PgCSSStylesheet=function(){var e=new window.PgStylesheet,s=(e.fileType="css",e.inline=!1,e.inlineSheetPgel=null,e.sourceToSave=null,new PgDelayedTasks),y=(e.hasDelayedUpdate=!1,!1),t=require("postcss"),o=t.postcssPG,r=o.pgStringify,i=o.pgStringifyWithIds;e.isCompilableStylesheet=function(){return!1},e.getAutocompleteArr=function(){return[]},e.getInlineSheet=function(e){var t;return this.inlineSheetPgel&&(e||(t=this.inlineSheetPgel.getPage())&&(e=t.$iframe.get(0)),e)&&e.contentDocument&&(t=$(e.contentDocument.documentElement),t=this.inlineSheetPgel.getDOMElement(t))&&t.sheet?t.sheet:null},e.elementStyle=!1,e.element=null,e.styleRuleName="Style attribute";function n(e,r){function i(e,t){for(var s=0;s<e.length;s++){if("auto-detect"==pinegrow.autoFormatCss&&pgcssf.detectFormatting(e[s],t,s,r.formattingOptions),"rule"==e[s].type){if(e[s].nodes||(e[s].nodes=[]),!r.canAddRuleIds(e[s],r.atruleWithNoChild))continue;e[s]["pg-node-id"]=d(),e[s]["pg-main-file"]=r.getUniqueName(),(r.isImported()||r.inline)&&(e[s]["pg-file"]=r.getUniqueName());var o=e[s].selector;(-1<o.indexOf(".pg-state-")||-1<o.indexOf(".pg-node-id-"))&&(y=!0)}e[s].nodes&&0<e[s].nodes.length&&i(e[s].nodes,!0)}}r.formattingOptions={},r.emptyNodes=[],i(e,!1)}function l(e,i){function n(e){for(var t,s,o,r=0;r<e.length;r++)"rule"==e[r].type?(e[r].nodes||(e[r].nodes=[]),0==e[r].nodes.length&&i.emptyNodes.push(e[r]),(o=(t=e[r].nodes)[(s=t.length)-1])&&"decl"==o.type&&"pg-id"==o.prop&&(e[r]["pg-node-id"]=o.value,t.splice(s-1,1),(o=t[--s-1])&&"decl"==o.type&&"pg-main"==o.prop&&(e[r]["pg-main-file"]=o.value.replace(/[\"\']/g,""),t.splice(s-1,1),s--),o=t[s-1])&&"decl"==o.type&&"pg-file"==o.prop&&(e[r]["pg-file"]=o.value.replace(/[\"\']/g,""),t.splice(s-1,1),s--)):"decl"!=e[r].type||"pg-id"!=e[r].prop&&"pg-main"!=e[r].prop&&"pg-file"!=e[r].prop||(e.splice(r,1),r--),e[r].nodes&&0<e[r].nodes.length&&n(e[r].nodes)}i.emptyNodes=[],n(e)}var c=0,u=t.postcss,a=t.postcssSafeParser,h=t.autoprefixer,d=function(){return++c};return e.showCanCleanTheCodeAlert=function(){function e(){function i(e){for(var t=0;t<e.length;t++){if("rule"==e[t].type){for(var s=e[t].selector.split(","),o=[],r=0;r<s.length;r++)s[r].indexOf(".pg-state-")<0&&s[r].indexOf(".pg-node-id-")<0&&o.push(s[r]);e[t].selector=o.join(",")}e[t].nodes&&0<e[t].nodes.length&&i(e[t].nodes)}}var e=t.rootNode,e=(i(e.nodes),y=!1,t.source=t.getSourceForRules(e),crsaMakeFileFromUrl(t.url));t.save(e,function(e){e&&showAlert("Error: "+e,"Can't save this file")})}var t=this;pinegrow.showAlert("<p>This file contains some special Pinegrow CSS selectors that help Pinegrow keep track of active CSS rules. Under certain conditions, previous versions of Pinegrow left these temporary helpers in the stylesheet code. This issue is now fixed, but some Pinegrow selectors are still left in this stylesheet.</p><p>Do you want to remove the Pinegrow selectors from the stylesheet and then save it?</p>","Clean <b>"+this.name+"</b>","No","Yes",function(){},function(){e()})},e.canEditRuleSelector=function(){return!this.elementStyle},e.canAddChangeMediaQuery=function(){return!this.elementStyle},e.lastNodeId=function(){return c},e.reload=function(e){pinegrow.codeEditors.ignoreCodeForUrl(this.url),this.inline?e&&e(this):this.load(this.url,e,!0)},e.callPostcss=function(e,t,s){e=e||"";var o=[],r=(pinegrow.getSetting("disable-formating","0"),this.sourceStylesheet&&"1"==pinegrow.getSetting("compilable-use-autoprefixer","1")&&(r=function(){var e=pinegrow.getSetting("compilable-autoprefixer-browsers",pinegrow.defaults.autoprefixer,!1);if(e&&e.length){e=e.split(",").map(function(e){return e.trim()});if(e.length)return e}return[]}(),o.push(h({browsers:r}))),u(o).process(e,{parser:a}));if(this.elementStyle)try{t(r.result)}catch(e){s("Error parsing inline style")}else r.then(function(e){t(e)});r.error&&((o=r.error).reason&&o.line?s(o.reason+":"+o.line):s(o.message))},e.parseSource=function(t,o){this.resetError();var r=this;this.sourceToSave=null,this.recursiveImports=null,this.callPostcss(t,function(e){c=0;var t=e.root,s=((r.compiledFile?l:n)(t.nodes,r),r.getSourceForRules(t));o&&o(null,s,t)},function(e){r.codeError=e,r.source=t,o&&o(e)})},e.addIdsToNodes=function(e){this.compiledFile?l(e):n(e,this)},e.updateSingleRule=function(e,t,s,o){var r;this.setChanged(!0),this.setNeedFormatting(!0),this.elementStyle||this.inline||!e["pg-node-id"]?this.elementStyle&&s&&0?((r=pinegrow.getCollection()).forEachElement(function(e){e.setInlineStylePropertyValue(s,o,!1,!1)}),pinegrow.changeManager.didChange(r,"Set style "+s,{undoCombineKey:"setAttr_style_"+s,source:"elementStyle"}),t&&t()):this.setSourceForRules(this.rootNode,t):(this.source=null,pinegrow.stylesheets.applyToPagesSingle(this,e),t&&t())},e.setAllCssText=function(t,e){var s,o,r,i,n=this;this.rootNode?(this.source=t,this.elementStyle?(i=pinegrow.getCollectionForElement(this.element),t=t.replace(this.styleRuleName,"").replace(/[\{\}]/g,""),t=this.filterSource(t),o=s=!1,i.forEachElement(function(e){t!=(e.getAttr("style")||"")&&(t.length?e.setAttr("style",t):e.removeAttr("style"),s=!0,e.dynamic)&&!e.dynamicStyleWarned&&(o=!0,e.dynamicStyleWarned=!0)}),s&&pinegrow.changeManager.didChange(i,"Set style attribute",{undoCombineKey:"setAttr_style",source:"elementStyle"}),o&&pinegrow.showQuickError(`WARNING: Inline style on dynamic elements can't be saved.`)):this.inline?this.inlineSheetPgel&&(r=this.source,i=this.inlineSheetPgel.getPage())&&(n.getSourceForRules(n.rootNode,!0),pinegrow.undoManager.getHistoryForPage(i).ignore(function(){n.inlineSheetPgel.html(r)})):pinegrow.stylesheets.applyToPages(this)):this.parseSource(t,function(e,t,s){e||(n.rootNode=s,(n.rootNode.pgStylesheet=n).setAllCssText(t))})},e.setSource=function(e,o,r,i,t){var n=this;t=!1,this.fast||t?(this.source=e,this.sourceToSave=e,t&&(this.hasDelayedUpdate=!0,pinegrow.stylesheets.applyToPagesQuick(n,e),s.run("delayedUpdate",function(){n.setSource(e)},2e3)),o&&o()):(this.hasDelayedUpdate=!1,s.cancel("delayedUpdate"),r=r||!1,this.inline&&(e=this.filterSource(e)),this.sourceBeingCurrentlyParsed=e,this.parseSource(e,function(e,t,s){n.sourceBeingCurrentlyParsed=null,e?(n.codeError=e,o&&o()):(n.codeError=null,getTrimed(n.parsedSource)==getTrimed(t)&&null!==n.source||(n.source=n.parsedSource=t,n.loaded&&n.setChanged(!0)),r||(n.rootNode=s,n.rootNode.pgStylesheet=n),i||n.setAllCssText(n.source),n.loadAllImportedFiles(o))}))},e.getSourceToSave=function(s){var o,e,r,i;null!=this.sourceToSave?s(null,this.sourceToSave):(e=(o=this).getSource(),r="1"==pinegrow.getSetting("compilable-remove-empty-rules","1"),i=function(e){function s(e){for(var t=0;t<e.length;t++)"rule"==pgcssh.getNodeType(e[t])?r&&0==e[t].nodes.length&&(e[t].remove(),t--):"import"==pgcssh.getNodeType(e[t])&&e[t].nodes&&0<e[t].nodes.length&&s(e[t].nodes)}return s(e.nodes),e},e&&0!=e.length?r?this.callPostcss(e,function(e){var t=e.root,t=i(t),t=o.getSourceForRules(t);o.sourceToSave=t,s&&s(null,t)},function(e){s&&s(e)}):s&&s(null,e):s&&s(null,""))},e.getSource=function(){return this.source||(this.source=this.getSourceForRules()),this.source},e.getSourceForRules=function(e,t,s){var o;return(e=e||this.getRootNode())?(this.elementStyle&&(this.formattingOptions={indent:"","before-first-nested-decl":"","before-decl-after-decl":" ","before-nested-decl-after-decl":" ","after-decl":"","after-rule":"","rule-between":""}),!s&&(t||this.compiledFile)||this.updateNodeFormatting(e,s),o=pinegrow.pgPostCSSHelper.getSource(e,t?i:r,t),"atrule"!==e.type||"charset"!==e.name||o.endsWith(";")||(o+=";"),o):""},e.setSourceForRules=function(e,t,s){this.setNeedFormatting(!0);var o=this.getSourceForRules(e);this.setSource(o,t,s)},e.regenerateAndSetCssSource=function(e,t,s){void 0===t&&(t=!0),s=s||this.getRootNode();var o=this.getSourceForRules(s);t?this.setSource(o,e):(this.setAllCssText(o),setTimeout(function(){e&&e()},10))},e.updateNodeWithSource=function(r,e,i){var n=this;this.parseSource(e,function(e,t,s){var o;e?i&&i(error):(o=pinegrow.pgPostCSSHelper.getRootNodeFor(r)==n.getRootNode()?pinegrow.pgPostCSSHelper.replaceNodeWithAndUpdatePgId(r,s.nodes[0]):(o=pinegrow.pgPostCSSHelper.getNodeIndices(r),o=pinegrow.pgPostCSSHelper.getNodeByIndices(n.getRootNode(),o),pinegrow.pgPostCSSHelper.replaceNodeWithAndUpdatePgId(o,s.nodes[0])),i&&i(null,o))})},e.updateNodeStylesheetWithSource=function(r,e,i){var n=this;this.parseSource(e,function(e,t,s){var o;e?i&&i(e):(o=s.nodes[0],pinegrow.pgPostCSSHelper.replaceNodeWith(r,o),o.raws.before=r.raws.before,n.setSourceForRules(pinegrow.pgPostCSSHelper.getRootNodeFor(o),function(e){i&&i(e,o)}))})},e.regenerateRules=function(o){this.parseSource(this.source,function(e,t,s){o(e?{nodes:[]}:s)})},e.getRuleById=function(){},e.getRuleSelector=function(e){return e.selector},e.getCssSource=function(e,t,s,o){var r,i;(!this.fast||s)&&(!this.source||t||s)?s?(r="",this.getImportedStylesheets().forEach(function(t){t.getCssSource(function(e){o&&(e=o(e,t)),r+="\n"+e},!0,!0)}),i=this.getSourceForRules(null,t),o&&(i=o(i,this)),e(r=(r+="\n"+i).replace(/@import\s[^;]+;/gm,function(e){return 0<=e.indexOf("https://")?e:""}))):e(this.getSourceForRules(null,t)):e(this.source)},e.updateImportedListOrder=function(){},e.getIndexForSourceStylesheet=function(){return"source-"+this.index},e.getImportedStylesheetFromRelativeUrl=function(e,t){e=crsaGetUrlAndParamsFromImport(e)[0];var s=t||this.importedFiles,o=[];o.push(this.getFullUrlFor(e));for(var r=0;r<s.length;r++)if(-1<o.indexOf(s[r].url))return s[r]},e.ignoreImportedFile=function(e,t){var s=this.getImportedStylesheetFromRelativeUrl(e.params);s&&(s.ignore=t,this.setRecursiveImportsError(null))},e.removeImportedFile=function(e){var t=this.getImportedStylesheetFromRelativeUrl(e.params),t=this.importedFiles.indexOf(t);-1<t?this.importedFiles.splice(t,1):this.setRecursiveImportsError(null)},e.addImportedFile=function(e,t){function s(){i.load(r,function(){console.log("done "+i.url),pinegrow.dispatchEvent("on_css_loaded",null,i),l()})}var o=crsaGetUrlAndParamsFromImport(e.params)[0],r=crsaCombineUrlWith(this.url,o),i=pinegrow.stylesheets.getStylesheetByKey(r),n=!1,l=function(e){n&&pinegrow.refreshCurrentProjectDelayed(!0),t&&t(e)},o=this.checkRecursiveImports(r,!0);o?l(o):i?l():((i=PgCSSStylesheet()).loaded=!1,i.index=pinegrow.stylesheets.getLastIndex(!0),o=crsaMakeFileFromUrl(r),crsaIsFileExist(o)||(n=!0,crsaCreateDirs(crsaGetFileDir(o)),fs.writeFile(o,"",function(e){if(e)return console.log(e);console.log("Imported file created!"),s()}))),i.addParentStylesheet(this),this.importedFiles.indexOf(i)<0&&pinegrow.stylesheets.stylsheetUsed({url:r,pgStylesheet:i},"child",this),i.loaded||s()},e.getImportedFiles=function(){if(this.ignore)return[];var e=this,t=[],s=e.rootNode.nodes;if(s)for(var o=0;o<s.length;o++)if("atrule"==s[o].type&&"import"==s[o].name){var r=crsaGetUrlAndParamsFromImport(s[o].params)[0];if(!crsaIsAbsoluteUrl(r)){r=crsaCombineUrlWith(e.url,r);if(e.checkRecursiveImports(r,!0))return;var i=pinegrow.stylesheets.getStylesheetByKey(r);i||((i=PgCSSStylesheet()).index=pinegrow.stylesheets.getLastIndex(!0)),i.addParentStylesheet(e),t.push({cs:i,href:r}),e.importedFiles.indexOf(i)<0&&pinegrow.stylesheets.stylsheetUsed({url:r,pgStylesheet:i},"child",e)}}return t},e.loadFromUrl=function(e,t){this.load(e,t,!1,!0)},e.load=function(n,i,l,e,c,u){this.resetError();var s,t,o,r,a,h,d,g,p=this,S=this.setNakedUrl(n),f=function(e,t,o){function s(){p.appliedToPage=!0,y&&p.showCanCleanTheCodeAlert(),i&&(p.elementStyle?(i(p,e,t,o),pinegrow.dispatchEvent("on_css_loaded",null,p)):setTimeout(function(){u&&p.setChanged(!0);function s(){i(p,e,t,o),pinegrow.dispatchEvent("on_css_loaded",null,p)}p.compiledFile?p.getSourceToSave(function(e,t){e||(getTrimed(p.compiledFileSource)==getTrimed(t)?p.setChanged(!1):p.setChanged(!0)),s()}):s()},1))}var r;!p.appliedToPage&&p.compiledFile&&(p.sourceStylesheet.changedOnce||p.usedExistedCompiled)?(r=p.compiledFileSource,p.sourceStylesheet.regenerateAndSetCssSource(function(){getTrimed(r)!=getTrimed(p.source)&&p.setChanged(!0),s()})):s()},m=function(){if(p.ignore&&!l)f();else{var e=require("fs"),t=pinegrow.getMappedRemoteFileForUrl(S,"css");if(t&&(crsaIsFileExist(t)&&(S=crsaMakeUrlFromFile(t)),p.mappedRemote=!0),isApp()&&crsaIsFileUrl(S))try{var s=crsaMakeFileFromUrl(S),o=pinegrow.codeEditors.getCodeForUrl(n);null===o&&crsaIsFileExist(s)&&(o=e.readFileSync(s,{encoding:"utf8"})),console.log("loaded css "+n),p.compiledFile?(p.compiledFileSource=o,f()):p.setSource(o,function(){p.setChanged(!1),p.loaded=!0,f(),p.setLocalFile(s)})}catch(e){p.setSource("",f),c||(p.error=e.message)}else{function r(e){console.log("loaded css "+n),p.setLoadingFailed(!1),t&&p.setLocalFile(t),p.compiledFile?(p.compiledFileSource=e,p.loaded=!0,f()):p.setSource(e,function(){p.loaded=!0,f()})}function i(e){var t="Failed loading css "+n;if(console.log(t),e&&0){console.log("Retrying...");try{pgGetHttpRequest(n,function(e){console.log(e),r(e)},function(){i()})}catch(e){i()}}else p.loaded=!0,p.setLoadingFailed(!0),p.setSource("",f),p.error=t}e=pinegrow.getCurrentProject();e&&e.loaded_from_backend&&e.hasContentForUrl(n)?e&&(p.loaded_from_project_content=!0,e.getContentOfUrl(n,function(e){null===e?i(!0):r(e)})):$.ajax({url:n,data:null,dataType:"text"}).done(function(e){r(e)}).fail(function(){i(!0)})}}};this.elementStyle&&this.element?(d=p.element.getAttr("style")||"",d=p.styleRuleName+"{"+d+"}",g=!1,p.setSource(d,function(){g||(g=!0,p.loaded=!0,f())},!1,!0)):!(e||this.sourceStylesheet&&this.sourceStylesheet.loaded)&&(s=null,d=this.getProjectInfo(),o=isApp()?d.getSetting("compiledStylesheet"):null,r=d.makeUrlRelative(this.url),t=o&&(o[this.url]||o[r]),!(s=t?o[r]?d.makeUrlAbsolute(o[r]):o[this.url]:s)&&crsaIsFileUrl(this.url)&&(r=crsaGetExtFromUrl(this.url),o=crsaRemoveUrlParameters(this.url),o=(r=r?o.substr(0,o.length-r.length):o)+"scss",r=r+"less",crsaIsFileExist(crsaMakeFileFromUrl(o))?s=o:crsaIsFileExist(crsaMakeFileFromUrl(r))&&(s=r)),o=this.getUseStylesheetSource(S),s)?(crsaGetExtFromUrl(s),r=crsaGetNameFromUrl(S),a=crsaGetNameFromUrl(s),h=function(){var e,t=pinegrow.stylesheets.getStylesheetByKey(s);t?((p.sourceStylesheet=t).addCompiledStylesheet(p),p.loaded=t.loaded,p.ignore=t.ignore,p.usedExistedCompiled=!0,m()):("scss"==(e=crsaGetExtFromUrl(s))?t=PgSCSSStylesheet():"less"==e&&(t=PgLESSStylesheet()),t&&(t.index=p.getIndexForSourceStylesheet()),t&&(p.compiledFile=!0,(p.sourceStylesheet=t).ignore=p.ignore,t.load(s,function(){p.loaded=t.loaded,t.getError()&&!t.loaded?(pinegrow.showQuickError(`Could not load ${t.url}.`),p.compiledFile=!1,p.sourceStylesheet=null):p.stopWatchingFileForChanges(),m()},l,null,p))),pinegrow.stylesheets.stylsheetUsed({url:s,pgStylesheet:t},"source",p)},"true"==o||t?h():null==o?pinegrow.showAlert("Do you want to use <b>"+a+"</b> as a source file for <b>"+r+"</b> and compile it with SASS/LESS?","Use SASS/LESS Source File","No","Yes",function(){p.setUseStylesheetSource("false"),m()},function(){p.setUseStylesheetSource("true"),h()}):m()):m()},e.getPageStylesheetFrom=function(e){var t=e.$iframe.get(0);return this.inline?this.getInlineSheet(t):pinegrow.stylesheets.findAttachmentFor(this,e)},e.duplicate=function(e){var t=PgCSSStylesheet(),s=(t.name=this.name.replace(/\.css($|[\?\/])/i,".copy.css"),this.url.split("/"));return 0<s.length?s.splice(s.length-1,1):s=[""],t.url=s.join("/")+"/"+t.name,t.loaded=this.loaded,t.ignore=this.ignore,t.setSource(this.getSource(),function(){e&&e(t)}),t},e.detachedFromSourceStylesheet=function(){this.compiledFile=!1,this.sourceStylesheet=null},e.filter=function(e){return{haveTo:"doNothing"}},e.getDeclCharachter=function(){return null},e.saveCompiledCss=function(s,o,r,i,n){var l=this;this.getSourceToSave(function(e,t){e?console.log(e):(t=l.filterSource(t),i&&(t=i(t)),n?n.writeFile(s,t,function(){l.lastSavedAt=(new Date).getTime(),console.log("saved css path "+s),l.setChanged(!1),o&&o()}):(crsaWriteFileWithBackup(r,s,t,"utf8"),l.lastSavedAt=(new Date).getTime(),console.log("saved css path "+s),l.setChanged(!1),o&&o()))})},e.save=function(e,o,r,i,n){if(this.compiledFile)this.saveCompiledCss(e,o,r,i,n);else{function t(t,s){var e=require("path");s=e.resolve(s),crsaIsFileExist(s)||(c=!0),t.getCssSource(function(e){setTimeout(function(){try{e=l.filterSource(e),i&&(e=i(e)),n?n.writeFile(s,e,function(){t.lastSavedAt=(new Date).getTime(),console.log("saved css path "+s),t.setChanged(!1)}):(crsaWriteFileWithBackup(r,s,e,"utf8"),t.lastSavedAt=(new Date).getTime(),console.log("saved css path "+s),t.setChanged(!1)),crsaIsFileUrl(t.url)&&t.localFile!=s&&t.setUrl(crsaMakeUrlFromFile(s)),pinegrow.dispatchEvent("on_css_file_saved",null,t),u--,a()}catch(e){o(e)}},10)})}var l=this,c=(r=r||require("fs"),!1),u=0,a=function(){0==u&&(c&&pinegrow.refreshCurrentProjectDelayed(!0),o)&&o()},s=(u++,t(this,e),this.importedFiles);if(0<s.length){p=require("path");for(var h=0;h<s.length;h++){u++;var d=s[h];t(d,d.localFile)}}}},e.setUseStylesheetSource=function(e){var t=this.getProjectInfo(),s=(s=t.getSetting("useSourceStylesheet"))||{},o=t.makeUrlRelative(this.url);delete s[this.url],s[o]=e,t.setSetting("useSourceStylesheet",s),t.save()},e.getUseStylesheetSource=function(){var e=this.getProjectInfo(),t=e.getSetting("useSourceStylesheet");return t&&(t[e.makeUrlRelative(this.url)]||t[this.url])||null},e.setSourceStylesheet=function(e){this.compiledFile=!0,this.sourceStylesheet=e;var t=this.getProjectInfo(),s=(s=isApp()?t.getSetting("compiledStylesheet"):null)||{},o=t.makeUrlRelative(this.url),r=t.makeUrlRelative(e.url),r=(delete s[this.url],s[o]=r,t.setSetting("compiledStylesheet",s),t.getSetting("useSourceStylesheet"));delete(r=r||{})[this.url],delete r[o],t.setSetting("useSourceStylesheet",r),t.save()},e.resetSourceStylesheet=function(){this.detachedFromSourceStylesheet();var e=this.getProjectInfo(),t=(t=isApp()?e.getSetting("compiledStylesheet"):null)||{},s=e.makeUrlRelative(this.url),t=(delete t[this.url],t[s]="",e.setSetting("compiledStylesheet",t),e.getSetting("useSourceStylesheet"));delete(t=t||{})[this.url],t[s]="false",e.setSetting("useSourceStylesheet",t),e.save()},e.resetError=function(){this.error=null,this.codeError=null,this.recursiveImports=null},e.getError=function(){return this.error||this.codeError||(this.sourceStylesheet?this.sourceStylesheet.getError():null)||this.recursiveImports},e.forgetCachedSource=function(){this.source=null},e.renameRuleSelector=function(e,t,s,o){this.canEdit(!1,!0)?pinegrow.pgPostCSSHelper.renameRuleSelector(e,t)&&(this.forgetCachedSource(),pinegrow.dispatchEvent("on_css_node_updated",null,{node:e,stylesheet:this,edited_by:o}),this.setSourceForRules(pinegrow.pgPostCSSHelper.getRootNodeFor(e),s,!0)):s&&s()},e.canHasImportMoreThanOneLevel=function(){return!1},e.stringifyNode=function(e){return this.filterSource(pinegrow.pgPostCSSHelper.getSource(e))},e.loadInline=function(e,o){function t(e,t,s){setTimeout(function(){o(e,t,s),pinegrow.dispatchEvent("on_css_loaded",null,i)},1)}var s,r,i;e.ownerNode&&(s=getElementPgNode($(e.ownerNode)))?(this.name="(inline)",$(e.ownerNode),r=s.html(),this.inline=!0,this.inlineSheetPgel=s,(i=this).setSource(r,function(){i.loaded=!0,pinegrow.stylesheets.applyToPages(i,function(){t()})})):o&&t()},e.remove=function(){pinegrow.stylesheets.isStylesheetUsed(this)||(s.destroy(),0<this.parentPgStylesheets.length&&(this.parentPgStylesheets=[]),this.sourceStylesheet&&(this.sourceStylesheet.removeFromCompiledStylesheet(this),this.sourceStylesheet.remove(!0),this.sourceStylesheet=null),e=null,this.removeSuper())},e};
var PgFastEditor=function(s,l){if(!s)throw"No container found";s.data("pg-fast-editor",this);var d=this,n=$('<ul class="fast-editor-list"></ul>').appendTo(s),a=$('<i class="icon-bin crsa-delete-item"></i>'),i=(this.itemSelector="li.crsa-node-item",l["add-new-placeholder-text"]=l["add-new-placeholder-text"]||"Add new...",this.itemLengthToAddPlaceholder=l["item-length-to-add-placeholder"]||0,function(e){var t=$(e.target),a=t.closest("li");t.hasClass("crsa-delete-item")&&(t=d.getNodeFrom(a),l.onItemRemoved(t.prop,t.value))&&(a.remove(),stylePaneHelper.onNodeRemoved())}),r=function(e){var t=$(e.target).closest(".crsa-node-item");t.hasClass("add-new-node")||t.hasClass("placeholder-node")||(t=t.find("> div:not(.pg-tree-quick-insert-line)"),a.appendTo(t))},p=function(e){a.detach()};this.isAllowedToAddNewNodeAt=function(e,t){e=t.closest("li");return!(t.is("span")||t.is("i")||e.data("placeholder-item")||e.hasClass("add-new-node"))},this.getNodeFrom=function(e){return e.data("list-item")},this.getLengthWithoutPlaceholders=function(e){return null},this.pasteTriggeredForNewField=function(e){var t=pinegrow.clipboard.getCurrentItem();if("attributes"==t.type){for(var a=l.parseCodeAndGetArray(t.code),o=0;o<a.length;o++){for(var s=!1,i=0;i<this.list.length;i++)if(a[o].prop==this.list[i].prop){this.list[o].value=a[o].value,s=!0;break}s||this.list.push(a[o])}this.show()}},this.addingNewNode=function(e){e.addClass("item-prop")},this.addNewNodeUI=function(e,t,a,o){var s=e.closest("li"),i=(s.addClass("crsa-node-item"),e.text());""!=i&&(i={prop:i,value:""},e.off("keydown").off("blur"),this.list.push(i),s.data("node",i).data("list-item",i).data("placeholder-item",!1).data("new-added",!0),i=$('<span class="item-value"></span>').appendTo(e.parent()),e.removeAttr("contenteditable"),i.attr("contenteditable","true"),crsaSelectText(i[0]),setTimeout(()=>{s.data("new-added",!1)},0))},this.nodeEditDone=function(e){var t,a=$(e),o=a.closest("li"),s=a.text(),i=this.getNodeFrom(o);""==s&&0?l.onItemRemoved(i.prop,i.value)&&(o.remove(),stylePaneHelper.onNodeRemoved()):(o=a.data("oldText"),t="",a.hasClass("item-prop")?(t="prop",i.prop=s):a.hasClass("item-value")&&(t="value",i.value=s),l.onItemChanged(i.prop,i.value,t,o))},this.getStringOfSelectedItems=function(e,o,s){s=s||"",o=o||" ";var i="";return n.find("> .selected-item").each(function(e,t){var a=$(t),a=d.getNodeFrom(a);i+=a.prop+o+a.value+s}),i.trim()},this.setList=function(e){this.list=e},this.show=function(){s.html(""),n=$('<ul class="fast-editor-list"></ul>').appendTo(s);for(var e=d.list.length,t=0;t<e;t++){var a=d.list[t];l.isAllowedToShow&&!l.isAllowedToShow(a.prop,a.value)||$('<li class="crsa-node-item"><div><span class="item-prop">'+a.prop+'</span><span class="item-value">'+a.value+"</span></div></li>").appendTo(n).data("list-item",a)}n.off("click","li",i).on("click","li",i).off("mousemove","li",r).on("mousemove","li",r).off("mouseleave","li",p).on("mouseleave","li",p);var o={"add-new-placeholder-text":l["add-new-placeholder-text"]};(stylePaneHelper=new PgStylePaneHelper(this,n,o)).addTriggers(n),stylePaneHelper.supportInsertBorders()}};
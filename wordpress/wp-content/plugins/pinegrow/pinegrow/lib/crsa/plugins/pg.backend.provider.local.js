class PgBackendProviderLocal{constructor(){var e=require("nw.gui");this.path=require("path"),this.data_dir=this.path.join(e.App.dataPath,"pg_tutorials")}callApi(e,a,t,s){return this[e]?this[e](a,t,s):(s&&s({error:`Unknown local API call ${e}.`}),null)}getProjectDir(e){return this.path.join(this.data_dir,e)}apiGetProjects(t,e,a){var t={user:{name:"Local user",level:2,email:"",id:1},projects:[],lessons:{}},s={};if(localStorage["lessons"]&&(s=JSON.parse(localStorage["lessons"])),$.each(s,function(e,a){e in t.lessons||(t.lessons[e]=a)}),localStorage.pgRecentFiles)for(var s=JSON.parse(localStorage.pgRecentFiles),r=pinegrow.thumbnailMaker.enabled,l=[],o=(t.projects=s.map(function(e){var a,t=e.file,s=(t.startsWith("internal:")||(t=crsaMakeUrlFromFile(e.file)),r&&(a=e.thumb?pgMakeFileUrl(crsaGetBaseForUrl(window.location.href)+e.thumb):pinegrow.thumbnailMaker.getStoredThumbnailUrl(e.file)),crsaGetNameFromUrl(t));return l.push(t),{name:s,url:t,project_id:t,thumb:a,is_file:!e.project}}),pgGetUniqueShortNamesForUrls(l)),i=0;i<o.length;i++){var n=pgUrlToDisplayString(o[i]);50<n.length&&(n="&hellip;"+n.substr(n.length-50)),t.projects[i].name=n}e(t)}apiLoadProject(e,a,t){t({status:404})}apiSaveProject(e,a,t){a&&a()}apiDeleteProjects(e,a,t){var s=this;e.project_ids.forEach(function(e){var a,t=s.path.join(s.data_dir,e.replace("tutorial_",""));crsaIsFileExist(t)&&((a=new CrsaFile).path=t,a.deleteFileAndFolder(t))}),a&&a()}apiSetLessonStatus(e,a,t){var s={};(s=localStorage["lessons"]?JSON.parse(localStorage["lessons"]):s)[e.lesson_id]=e.status,localStorage["lessons"]=JSON.stringify(s),a&&a()}apiSetLessonStatusMultiple(a,e,t){var s={};localStorage["lessons"]&&(s=JSON.parse(localStorage["lessons"])),a.lesson_ids.forEach(function(e){s[e]=a.status}),localStorage["lessons"]=JSON.stringify(s),e&&e()}}
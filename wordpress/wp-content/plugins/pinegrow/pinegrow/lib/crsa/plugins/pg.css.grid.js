$(function(){var Ne;pgf.edit_css&&($("body").one("pinegrow-ready",function(u,ue){var S=new PgFramework("pg.css.grid","CSS Grid");S.type="pg.css.grid",S.allow_single_type=!0,S.description="CSS Grid",S.author="Pinegrow",S.author_link="https://pinegrow.com",S.has_actions=!1,S.show_in_manager=!1,S.default=!0,S.setScriptFileByScriptTagId("plugin-pgcssgrid"),ue.addFramework(S),S.mode="css";class r{constructor(e,t,n){this.class_style=e,this.prefix=t||"",this.pgel=n,this.key=(e?e.key:"--")+t}isValidForPgel(e){return!this.class_style||ue.classStyles.isStyleOnPgel(e,this.class_style)}hasGrid(e,t){for(var n=t||["grid","inline-grid","grid-cols-","grid-rows-","auto-cols-","auto-rows-"],i=this.getClasses(),r=0;r<n.length;r++)if(n[r].endsWith("-")&&!e){for(var s=0;s<i.length;s++)if(i[s].startsWith(this.prefix+n[r]))return!0}else for(s=0;s<i.length;s++)if(i[s]===this.prefix+n[r])return!0;return!1}isGridItem(){return this.hasGrid(!1,["col-","row-","[grid-area"])}getClasses(e){for(var t=this.class_style?this.class_style.classes:ue.classStyles.getInlineClassesForPgel(this.pgel),n=[],i=0;i<t.length;i++){var r,s=splitBracketsAware(t[i],":");this.prefix?(r=s.pop(),s.join(":")+":"===this.prefix&&n.push(e?r:t[i])):1===s.length&&n.push(t[i])}return n}toOption(e){var t="[TW] ",n='<span style="opacity:0.6;">[TW]</span> ';return this.class_style?(t+=this.class_style.getDisplayName()+" - ",n+='<span class="pg-css-grid-tw-style-in-menu">'+this.class_style.getDisplayName()+"</span> - "):t+="",this.prefix?(t+=this.prefix.toUpperCase().substring(0,this.prefix.length-1),n+=this.prefix.toUpperCase().substring(0,this.prefix.length-1)):(t+="ALL",n+="ALL"),(e?this.isGridItem():this.hasGrid())&&(t+=e?" - Pos set":" - Grid set",n+=e?" - Pos set":" - Grid set"),{key:this.key,name:t,html:n}}getShortName(){var e='<span style="opacity:0.6;">[TW]</span> ';return this.class_style?e+='<span class="pg-css-grid-tw-style-in-menu">'+this.class_style.getDisplayName()+"</span>":e+="",this.prefix?e+=" - "+this.prefix.toUpperCase().substring(0,this.prefix.length-1):e+=" - ALL",e}addPrefixToClasses(e){const t=this;return e.map(function(e){return t.prefix+e})}isSame(e){return e.key===this.key}}function T(e,t,n){n=n||ce(e);var i,r,s=x(t,n,!0);return s=e.parent&&(r=ce(e.parent),i=x(t,r,!1,!1))&&(r=r.indexOf(i),(s?n.indexOf(s):0)<r)?n[r]:s}function C(){function t(e){var t,n,i;(i=(e=i=e.get$DOMElement())?"grid"==(n=e.css("display"))||"inline-grid"==n?e:0!=(t=e.parent()).length&&1==t.get(0).nodeType&&("grid"==(n=t.css("display"))||"inline-grid"==n)?t:null:null)&&((n=new G).show(i),s.push(n))}g.cancel("updateCSSGridControls"),s.forEach(function(e){e.destroy()}),s=[];var n=o;ue.selectedElements.forEachElement(function(e){t(e),n==e&&(n=null)}),n&&t(n)}function m(e){var n;return"none"==e?null:(n=[],(e||"").split(/["']/).forEach(function(e){var t;(e=$.trim(e)).length&&(t=[],n.push(t),e.split(/\s+/).forEach(function(e){t.push(e="."==e?"":e)}))}),n)}function e(e,t,n,i,r){for(var s={},o=e;o<=t;o++)s[n.replace(/\#NUM/g,o)]=i.replace(/\#NUM/g,o),r&&(s[r.replace(/\#NUM/g,o)]=i.replace(/\#NUM/g,o));return s}function p(e,t){return e=e.replace(/ /g,"_"),e=t?e:"["+e+"]"}function t(t){var n={};return Pe().forEach(function(e){n[e]=t+e}),n}function d(){_e={display:{class:"grid",values:{grid:"grid"}},"grid-template-areas":{custom_to_css:function(e){var t=e.match(/^\[grid\-template\-areas\:(.*)\]$/);return t?ke(t[1].trim()):null},custom_to_class:function(e){return e?`[grid-template-areas:${p(e,!0)}]`:null},replace_re:/^\[grid\-template\-areas\:/,class:"dummy-grid-template-areas-#VAL"},"grid-area":{custom_to_css:function(e){var t=e.match(/^\[grid\-area\:(.*)\]$/);return t?ke(t[1].trim()):null},custom_to_class:function(e){return e?`[grid-area:${p(e,!0)}]`:null},replace_re:/^\[grid\-area\:/,class:"dummy-grid-area-#VAL"},"grid-template-columns":{custom_to_css:function(e){var t=e.match(/^grid-cols-([0-9]+)$/);if(t){for(var n=parseInt(t[1]),i="",r=1;r<=n;r++)1<r&&(i+=" "),i+="1fr";return i}return null},class:"grid-cols-#VAL",values:{...e(1,12,"repeat(#NUM, minmax(0, 1fr))","grid-cols-#NUM","repeat(#NUM, 1fr)"),none:"grid-cols-none",auto:"grid-rows-auto",subgrid:"grid-cols-subgrid"}},"grid-template-rows":{custom_to_css:function(e){var t=e.match(/^grid-rows-([0-9]+)$/);if(t){for(var n=parseInt(t[1]),i="",r=1;r<=n;r++)1<r&&(i+=" "),i+="1fr";return i}return null},class:"grid-rows-#VAL",values:{...e(1,12,"repeat(#NUM, minmax(0, 1fr))","grid-rows-#NUM","repeat(#NUM, 1fr)"),none:"grid-rows-none",auto:"grid-rows-auto",subgrid:"grid-rows-subgrid"}},"disabled-grid-column":{class:"col-span-#VAL",custom_to_css:function(e){return"col-auto"===e?"auto":null},custom_to_class:function(e){return"auto"===e?"col-auto":null},values:{...e(1,12,"span #NUM / span #NUM","col-span-#NUM"),"1 / -1":"col-span-full",auto:"col-auto"}},"grid-column-start":{class:"col-start-#VAL",values:{...e(1,13,"#NUM","col-start-#NUM"),auto:"col-start-auto"}},"grid-column-end":{class:"col-end-#VAL",replace_re:/^col\-span\-/,values:{...e(1,13,"#NUM","col-end-#NUM"),auto:"col-end-auto"}},"disabled-grid-row":{class:"row-span-#VAL",custom_to_css:function(e){return"row-auto"===e?"auto":null},custom_to_class:function(e){return"auto"===e?"row-auto":null},values:{...e(1,12,"span #NUM / span #NUM","row-span-#NUM"),"1 / -1":"row-span-full",auto:"row-auto"}},"grid-row-start":{class:"row-start-#VAL",values:{...e(1,13,"#NUM","row-start-#NUM"),auto:"row-start-auto"}},"grid-row-end":{class:"row-end-#VAL",replace_re:/^row\-span\-/,values:{...e(1,13,"#NUM","row-end-#NUM"),auto:"row-end-auto"}},"grid-auto-columns":{class:"auto-cols-#VAL",values:{auto:"auto-cols-auto","min-content":"auto-cols-min","max-content":"auto-cols-max","minmax(0, 1fr)":"auto-cols-fr"}},"grid-auto-rows":{class:"auto-rows-#VAL",values:{auto:"auto-rows-auto","min-content":"auto-rows-min","max-content":"auto-rows-max","minmax(0, 1fr)":"auto-rows-fr"}},"column-gap":{custom_to_css:function(e){return e.startsWith("gap-x-")?e.replace("gap-x-",""):null},custom_to_class:function(e){return null===e?null:"gap-x-"+e},class:"gap-x-#VAL",values:t("gap-x-")},"row-gap":{custom_to_css:function(e){return e.startsWith("gap-y-")?e.replace("gap-y-",""):null},custom_to_class:function(e){return null===e?null:"gap-y-"+e},class:"gap-y-#VAL",values:t("gap-y-")},gap:{custom_to_css:function(e){return!e.startsWith("gap-")||e.startsWith("gap-x-")||e.startsWith("gap-y-")?null:e.replace("gap-","")},custom_to_class:function(e){return null===e?null:"gap-"+e},class:"disabled-gap-#VAL",values:t("gap-"),replace_re:/^gap\-[^xy]/}},w=[],$.each(_e,function(e,t){var n=t.class.replace("#VAL",""),i=(t.prefix=n,{});$.each(t.values,function(e,t){i[t]=e,w.push(t)}),t.class_to_css_value=i})}function c(E,e){function s(e,t,n){var i=parseInt(t.attr("data-idx")),r=i<e.length?e[i]:n;ue.showPrompt(`<p>Edit the track name. Track names must end with <b>-start</b> or <b>-end</b> if you wish to use grid handles for element placement along those tracks, for example <code>main-start</code>.</p><p>Separate multiple names with spaces, for example <code>main-start content-start</code>.</p><p>Leave empty to clear the track name.</p>`,"Edit track name",r.name||"","for example, content-end",null,function(e){e&&!function(e){for(var t=e.split(" "),n=0;n<t.length;n++)t[n].length;return!0}(e)?ue.showQuickError("Invalid track name(s)."):(r.name=e,Z(),ee(!0))})}function t(e,t){if(Y&&ge(Y)){var n=t.getCurrentDeviceDef();if(n)if(("all"===n.size?"":n.size+":")===Y.prefix)return}N.showGrid()}function n(e,t){"css"!=N.mode||t.edited_by&&"cssgridcontrol"==t.edited_by||(t.node&&t.node.parent==Y||t.stylesheet.elementStyle&&!Y&&t.stylesheet.element===E)&&N.showGrid(Y)}function o(e,t,n){t&&t.source&&t.source==N||n&&n.contains(E)&&N.showGrid(Y)}function a(){N.showGrid(Y)}e=e||ue.getSelectedPage().activeView;var N=this,R=(this.mode=S.mode,$('<div class="pg-dm-grid-view"></div>')),i=new PgUIView(R,"pgdmgrid"),r=(this.view=i,this.pageView=e,R.addClass(this.mode),E.getPage()),l=new PgDelayedTasks,z=(this.setDeviceDef=function(e){this.dmSizeDef=e,this.dmSizeSlug=e?e.slug:"-md"},this.setDeviceDef(e?Ce(e):null),[]),te=(r.callFrameworkHandler("on_get_device_sizes",z),function(){for(var e=[],t=["c","r","a"],n="--g#SLUG-",i=0;i<z.length;i++){for(var r=!1,s=n.replace("#SLUG",z[i].slug),o=0;o<t.length;o++)if(E.getInlineStylePropertyValue(s+t[o])){r=!0;break}r&&e.push(z[i].size)}return e}),T=$('<div class="pg-dm-grid-view-selector"></div>').appendTo(R),r=$('<div class="pg-dm-grid-view-container"></div>').appendTo(R),F=$('<div class="pg-dm-grid-view-options"></div>').appendTo(r),V=$('<div class="pg-dm-grid-view-grid"></div>').appendTo(r),A=(crsaHandleExternalLinks(R),[]),G=[],D=[],h=null,m=null,M=null,I=null,O=null,L=null,H=!1,_=null,U=!1,W={},B=[],ne=function(){B=[],D.forEach(function(e){e.forEach(function(e){e&&B.indexOf(e)<0&&B.push(e)})})},X=null,Y=null,p={},w=function(e,t){return $e(e,t)},ie=function(e,t){switch(void 0===t&&(t=N.dmSizeSlug),e){case"grid-template-columns":return`--g${t}-c`;case"grid-template-rows":return`--g${t}-r`;case"grid-template-areas":return`--g${t}-a`;case"grid-gap":return`--g${t}-gap`}return null},u=function(e,t){var n=pgDmStore.getSkillByKey("grid");pgDmStore.setSkillParam(E,n,e,t)},re=function(){ne(),W={};var t=0;chroma.scale(["#0497cc","#b2d12e"]).mode("lch").colors(B.length).forEach(function(e){W[B[t]]=e,t++})},d=function(e,t){return e<D.length&&t<D[e].length?D[e][t]:""},j=function(e,t){A.splice(t,0,e);var n=0;D.forEach(function(e){e.splice(t,0,d(n,t)),n++})},Q=function(e,t){G.splice(t,0,e);for(var n=[],i=0;i<A.length;i++)n.push(d(t,i));D.splice(t,0,n)},se="1fr",oe="100px",K=function(e,t){return $('<div class="pg-dm-grid-view-grid-'+e+'"></div>').appendTo(t||V)},c=new Ne,q=function(e,t,n){var i;return!!(ge(Y)&&0<=t.indexOf("gap"))||(i=c.test(t,n),e.setError(i?null:"Invalid value"),i)},Z=function(){if(le()){F.empty(),V.empty(),T.empty(),V.css("min-height","0");function r(e,t,n,i){var r=new PgInputField("size",{type:"slider",name:"W",slider_def_unit:"px",slider_min:0,without_text:!0,options:l});r.setValue(e),q(r,"grid-template-columns",e),r.on("input change",function(e){var t=r.getValue();q(r,"grid-template-columns",t)&&(n[i].size=t,ee("change"===e.type))}),r.appendTo(t)}var n,i,s,t,o,a,l=[{key:"100px",name:"100px",html:"100px <small>Fixed size</small>"},{key:"1fr",name:"1fr",html:"1fr <small>Divide available space</small>"},{key:"auto",name:"auto",html:"auto <small>Content size</small>"},{key:"minmax(100px, 1fr)",name:"minmax(100px, 1fr)",html:"minmax(100px, 1fr) <small>Min 100px, max 1fr</small>"},{key:"minmax(100px, auto)",name:"minmax(100px, auto)",html:"minmax(100px, auto) <small>Min 100px, max the content size</small>"},{key:"fit-content(40%)",name:"fit-content(40%)",html:"fit-content(40%) <small>Content size, but not larger than 40%</small>"},{key:"repeat(3, 200px)",name:"repeat(3, 200px)",html:"repeat(3, 200px) <small>Repeat 3 times</small>"},{key:"repeat(auto-fill, minmax(100px, 1fr))",name:"repeat(auto-fill, minmax(100px, 1fr))",html:"repeat(auto-fill, minmax(100px, 1fr)) <small>Fill with as many cols/rows as possible</small>"},{key:"repeat(auto-fit, minmax(100px, 1fr))",name:"repeat(auto-fit, minmax(100px, 1fr))",html:"repeat(auto-fit, minmax(100px, 1fr)) <small>Fit the available cols/rows into the space</small>"},{key:"none",name:"none",html:"None <small>Track template is not defined. Only valid with a single row or column.</small>"}],e=[{key:"100px",name:"100px",html:"100px <small>Fixed size</small>"},{key:"1fr",name:"1fr",html:"1fr <small>Divide available space</small>"},{key:"auto",name:"auto",html:"auto <small>Content size</small>"},{key:"minmax(100px, 1fr)",name:"minmax(100px, 1fr)",html:"minmax(100px, 1fr) <small>Min 100px, max 1fr</small>"},{key:"minmax(100px, auto)",name:"minmax(100px, auto)",html:"minmax(100px, auto) <small>Min 100px, max the content size</small>"},{key:"fit-content(40%)",name:"fit-content(40%)",html:"fit-content(40%) <small>Content size, but not larger than 40%</small>"},{key:"minmax(0, 1fr)",name:"minmax(0, 1fr)",html:"minmax(0, 1fr) <small>Min 0, max 1fr</small>"},{key:"min-content",name:"min-content"},{key:"max-content",name:"max-content"}];if(U=0<A.length&&0<G.length,"dm"==N.mode){for(var u=K("devices",T),d=te(),c=new PgButtonToolbar,g=(u.prepend(c.$element.addClass("pg-tabs-toolbar")),new PgToolbarTabButtons(c,"tabs")),p=0;p<z.length;p++){var h=z[p],m=0<=d.indexOf(h.size),f=N.dmSizeDef&&h.size==N.dmSizeDef.size,f=g.addTab(h.name_short,null,h,f).setClosable(!1);m&&f.$element.append('<i class="icon icon-check"></i>'),h.name_short}g.onTabSelected=function(e){var t=e.data,n=(N.setDeviceDef(t),N.showGrid(),ue.getSelectedPage());n&&n.view.setActiveViewSizeWithDef(t),N.onDeviceSizeChanged&&N.onDeviceSizeChanged(n,t)},0}if("css"==N.mode){for(var _=X.getShownNodes(),w=[],v=(de()&&(w=ce(E)),new PgInputField("rule",{type:"select",name:"CSS Rule",without_text:!1,show_empty:!1,options:function(){var t=0,n=[];return de()&&w.forEach(function(e){n.push(e.toOption())}),n.push({key:"css-item-1",name:"Style attribute"}),n=n.concat(_.map(function(e){return{key:`css-item`+t++,name:pgcssh.getRuleDisplayName(e)}}))}})),y=null,p=0;p<_.length;p++)if(_[p]===Y){y=`css-item`+p;break}for(p=0;p<w.length;p++)if(ge(Y)&&Y.isSame(w[p])){y=w[p].key;break}y=y||(w.length?w[0].key:"css-item-1"),v.setValue(y),v.on("change",function(e){var t=v.getValue();if(t.startsWith("css-item"))var n=parseInt(t.replace("css-item","")),i=0<=(n=Math.min(n,_.length-1))?_[n]:"style_attribute";else for(var r=0;r<w.length;r++)if(t===w[r].key){i=w[r];break}N.showGrid(i)}),v.appendTo(T)}if(U&&(u=(u=$(`<div class="pg-css-grid-field-gaps crsa-field"><label>Gap col/row</label><div></div></div>`).appendTo(F)).find("div"),(n=new PgInputField("gap",ge(Y)?{type:"select",name:"Gap",without_text:!0,options:Pe(!0),can_add_items:!0,show_empty:!0}:{type:"slider",name:"Gap",slider_def_unit:"px",slider_min:0,without_text:!0})).setValue(O),q(n,"gap",O),n.on("change input",function(e){O=n.getValue(),H&&(s.setValue(O),L=O),q(n,"gap",O)&&ee("change"===e.type)}),n.appendTo(u),c=new PgToggleButtonMaker,(i=new PgInputField("gap-eq",{type:"select",name:"Gap eq",show_empty:!0,toggle_buttons:!0,without_text:!0,options:[{key:"true",name:"Equal gaps",html:c.makeIcon("same",{title:"Make gaps the same."})}]})).setValue(H?"true":null),i.on("change",function(e){var t;(H="true"===i.getValue())&&(t=O||L,n.setValue(t),s.setValue(t),O=L=t),ee(!0)}),i.appendTo(u),(s=new PgInputField("gap-row",ge(Y)?{type:"select",name:"Gap row",without_text:!0,options:Pe(!0),can_add_items:!0,show_empty:!0}:{type:"slider",name:"Gap row",slider_def_unit:"px",slider_min:0,without_text:!0})).setValue(H?O:L),q(s,"gap",L),s.on("change input",function(e){L=s.getValue(),H&&(n.setValue(L),O=L),q(s,"gap",L)&&ee("change"===e.type)}),s.appendTo(u),(t=new PgInputField("auto_col",{type:"slider",name:"Auto Columns",slider_def_unit:"px",slider_min:0,without_text:!1,options:e})).setValue(M),q(t,"grid-auto-columns",M),t.on("change input",function(e){M=t.getValue(),q(t,"grid-auto-columns",M)&&ee("change"==e.type)}),t.appendTo(F),(o=new PgInputField("auto_row",{type:"slider",name:"Auto Rows",slider_def_unit:"px",slider_min:0,without_text:!1,options:e})).setValue(I),q(o,"grid-auto-rows",I),o.on("change input",function(e){I=o.getValue(),q(o,"grid-auto-rows",I)&&ee("change"==e.type)}),o.appendTo(F),I||M||(t.$field.hide(),o.$field.hide(),(a=$('<p style="text-align:right;margin-bottom:0;"><a href="#" class="help-link show-more">Auto columns and rows...</a></p>').appendTo(F)).on("click","a",function(e){e.preventDefault(),t.$field.show(),o.$field.show(),a.hide()}))),U){R.removeClass("no-grid");var x=null,S=(K("corner").html(`<div><span>Columns</span><span>Rows</span></div>`),0),C=(A.forEach(function(e){var t=e.size,n=K("col");0!=S&&!1||$(`<i class="add-col add-col-first icon icon-plus" data-idx="${S}">`).appendTo(n),r(t,n,A,S),$(`<i class="del-col icon icon-bin" data-idx="${S}">`).appendTo(n),$(`<i class="add-col icon icon-plus" data-idx="${S+1}">`).appendTo(n),S++}),re(),0);G.forEach(function(e){for(var t=e.size,n=K("row"),o=(0!=C&&!1||$(`<i class="add-row add-row-first icon icon-plus" data-idx="${C}">`).appendTo(n),r(t,n,G,C),$(`<i class="del-row icon icon-bin" data-idx="${C}">`).appendTo(n),$(`<i class="add-row icon icon-plus" data-idx="${C+1}">`).appendTo(n),!0),i=0;i<A.length;i++)!function(n,i){var r=K("cell",x),e=D[n][i],s=(r.attr("data-area",e),r.attr("data-col",i),r.attr("data-row",n),e&&r.addClass("has-area"),new PgInputField("size",{type:o?"text":"html",name:"W",without_text:!0,placeholder:o?"area name":"",fill_list_on_open:!0,options:function(){ne();var t=[];return B.forEach(function(e){e.length&&t.push({key:e,name:e})}),t}}));s.setValue(e),s.on("change",function(e){var t=s.getValue();D[n][i]=t,r.attr("data-area",t),t?r.addClass("has-area"):r.removeClass("has-area"),t in W?r.css({"background-color":W[t]}):(re(),V.find(".pg-dm-grid-view-grid-cell").each(function(e,t){var n=$(t),i=n.attr("data-area");n.css({"background-color":W[i]})})),ee("change"==e.type)}),s.appendTo(r),r.css({"background-color":W[e]})}(C,i);C++}),V.css({"grid-template-columns":`minmax(120px, 1fr) repeat(${A.length}, minmax(80px, 1fr))`,"grid-template-rows":`50px repeat(${G.length}, minmax(70px, 70px))`}),J(),J()}else{var b,k=null;if("dm"==N.mode){for(var P=0,p=0;p<z.length;p++)if(N.dmSizeDef.size==z[p].size){P=p;break}for(p=P-1;0<=P;P--)if(0<=d.indexOf(z[P].size)){k=z[P];break}if(!k)for(p=P+1;P<z.length;P++)if(0<=d.indexOf(z[p].size)){k=z[p];break}}c="dm"==N.mode?(b=`<p>CSS Grid for device size ${N.dmSizeDef.name_short} is not defined. Would you like to define it?</p>`,`Create grid for `+N.dmSizeDef.name_short):(b=`<p>CSS Grid is not defined for the selected CSS rule. Would you like to define it?</p>`,`Create CSS Grid`),$(b).appendTo(F),R.addClass("no-grid");$(`<button class="btn pg-button create-grid">${c}</button>`).appendTo(F).on("click",function(e){var i,r,t;e.preventDefault(),k?(i=k.slug,r=N.dmSizeDef.slug,t=$.extend({},ae),$.each(t,function(e,t){var n=ie(e,i);n&&(t=E.getInlineStylePropertyValue(n),n=ie(e,r),t)&&E.setInlineStylePropertyValue(n,t)}),ue.showQuickMessage("Grid copied from "+k.name_short+"."),N.showGrid(),ee(!0)):(j({size:se}),j({size:se}),j({size:se}),Q({size:oe}),Z(),ee(!0),N.showGrid())}),$('<p style="margin-top:40px;"><a href="'+Se+'" class="external help-link">Learn about CSS Grid...</a></p>').appendTo(F)}}},J=function(){if(V.is(":visible")){V.css("min-height","0");function e(e,t){var n=V.find(`.pg-dm-grid-view-grid-col-line[data-idx="${t-1}"]`),i=(0===n.length&&(n=K("col-line",V),i=`<hr><span>${t}</span>`,e.name&&(i+=`<linename>${e.name}</linename>`,n.addClass("has-name")),n.html(i),n.attr("data-idx",t-1),addTooltip(n,"Click to edit the track name.")),n.attr("style",`left:${c}px;min-width:${a-86}px;`),c+=l[t]+r,n.width());d<i&&(d=i)}for(var t=window.getComputedStyle(V.get(0)),r=b(t.gridColumnGap),s=b(t.gridRowGap),o=parseFloat(t.width.replace("px","")),a=parseFloat(t.height.replace("px","")),l=t.gridTemplateColumns.split(" ").map(function(e){return parseFloat(e.replace("px",""))}),u=t.gridTemplateRows.split(" ").map(function(e){return parseFloat(e.replace("px",""))}),d=0,c=l[0]+r/2,n=1;n<l.length;n++)e(A[n-1],n);e(h,l.length),V.css("min-height",d+86+"px");function i(e,t){var n,i=V.find(`.pg-dm-grid-view-grid-row-line[data-idx="${t-1}"]`);0===i.length&&(i=K("row-line",V),n=`<hr><span>${t}</span>`,e.name&&(n+=`<linename>${e.name}</linename>`,i.addClass("has-name")),i.attr("data-idx",t-1),i.html(n),addTooltip(i,"Click to edit the track name.")),i.attr("style",`left:${g}px;top:${p}px;min-width:${o-g}px;`),p+=u[t]+s}for(var g=l[0]+r+2,p=u[0]+s/2,n=1;n<u.length;n++)i(G[n-1],n);i(m,u.length)}},ee=(i.onResize=function(){U&&v&&(J(),J())},V.on("click",".add-col",function(e){var t=$(this),t=parseInt(t.attr("data-idx")),n={size:(t<A.length?A[t]:A[t-1]).size};t==A.length&&(n.name=h.name,h.name=null),j(n,t),Z(),ee(!0)}),V.on("click",".del-col",function(e){var t,n=$(this),n=parseInt(n.attr("data-idx"));t=n,A.splice(t,1),D.forEach(function(e){e.splice(t,1)}),Z(),ee(!0)}),V.on("click",".add-row",function(e){var t=$(this),t=parseInt(t.attr("data-idx")),n={size:(t<G.length?G[t]:G[t-1]).size};t==G.length&&(n.name=m.name,m.name=null),Q(n,t),Z(),ee(!0)}),V.on("click",".del-row",function(e){var t,n=$(this),n=parseInt(n.attr("data-idx"));t=n,G.splice(t,1),D.splice(t,1),Z(),ee(!0)}),V.on("click",".pg-dm-grid-view-grid-col-line",function(e){var t=$(this);s(A,t,h)}),V.on("click",".pg-dm-grid-view-grid-row-line",function(e){var t=$(this);s(G,t,m)}),V.on("mouseover",".pg-dm-grid-view-grid-cell",function(){var e=$(this),t=e.attr("data-col"),e=e.attr("data-row");N.onHighlightCell&&N.onHighlightCell(t,e)}),V.on("mouseout",".pg-dm-grid-view-grid-cell",function(){N.onHighlightCell&&N.onHighlightCell()}),function(e){var t;le()&&(t=function(){var n=[],e=N.getCSS();$.each(e,function(e,t){t=(t="none"===t?null:t)&&t.replace(/"/g,"'"),n.push({prop:e,val:t})}),ge(Y)&&!g()&&n.push({prop:"display",val:"grid"});for(var t=0;t<n.length;t++)"css"===N.mode?ye(E,Y,n[t].prop,n[t].val,t!==n.length-1,N):u(n[t].prop,n[t].val)},Y=fe(Y),e?(t(),xe(E,Y,"Set CSS grid",null,{source:N}),l.run("refreshCssPanel",function(){var e=null;Y&&(e=pgcssh.getStylesheetForNode(Y)),ue.activeCSSView.refreshCurrentDisplay(e)},1e3)):t(),N.onChange)&&N.onChange()}),ae={"grid-template-columns":null,"grid-template-rows":null,"grid-template-areas":null,"grid-auto-columns":null,"grid-auto-rows":null,gap:null,"column-gap":null,"row-gap":null,display:null},le=function(){var e=E;return(E=E&&(E.replacedWith||getPgNodeByPgId(E.getId())))&&E!==e&&(X&&X.destroy(),X=new PgActiveRules(E)),!!E||(ue.showQuickError("The target element doesn't exist any more. Please close the CSS Grid editor."),!1)},v=!1,X=new PgActiveRules(E),f=[],g=function(){y();for(var e=f.indexOf(Y);e<=0;e++)if(Y.class_style===f[e].class_style&&f[e].hasGrid(!0))return!0;return!1};this.showGrid=function(g){var e;le()&&(v=!1,e=function(){de()&&(f=ce(E)),A=[],G=[],D=[],L=O=I=M=null,p=$.extend({},ae),v=!0;var e,t,n,i,r,s,o,a,l=X.getActiveNodes();if(Y=null,"css"===this.mode){var u=!1;if(g)if("style_attribute"===g)Y=null,u=!0;else if(0<=X.getShownNodes().indexOf(g)&&(Y=g,u=!0),!u&&f.length&&ge(g))for(var d=0;d<f.length;d++)if(g.isSame(f[d])){Y=f[d],u=!0;break}if(!u){if(!(Y=x(E.getPage(),f)))for(d=0;d<f.length;d++)if(f[d].hasGrid()){Y=f[d];break}Y||(e=l,Y=he(E,l=["grid-template-rows","grid-template-columns","grid","grid-template","grid-template-areas","grid-auto-columns","grid-auto-rows"])?null:me(e,l,!1)),!Y&&f.length&&(Y=f[0])}}ge(Y)&&ve(E,[],Y.prefix),"css"===this.mode?(t={gap:"grid-gap","column-gap":"grid-column-gap","row-gap":"grid-row-gap"},$.each(p,function(n,e){var i;ge(Y)?_e[n]&&(i=!1,Y.getClasses(!0).forEach(function(e){var t;i||(null===(t=_e[n].custom_to_css?_e[n].custom_to_css(e):null)&&e.startsWith(_e[n].prefix)&&(t=e.replace(_e[n].prefix,""),t=_e[n].class_to_css_value[t]||ke(t)),null!==t&&(p[n]=t,i=!0))})):Y?(p[n]=w(Y,n),!p[n]&&t[n]&&(p[n]=w(Y,t[n]))):(p[n]=E.getInlineStylePropertyValue(n),!p[n]&&t[n]&&(p[n]=E.getInlineStylePropertyValue(t[n])))})):$.each(p,function(e,t){var n;p[e]=(e=e,n=pgDmStore.getSkillByKey("grid"),pgDmStore.getSkillParam(E,n,e))}),l=p["grid-template-columns"],n=p["grid-template-rows"],i=p["grid-template-areas"],r=p["grid-auto-columns"]||null,s=p["grid-auto-rows"]||null,o=p["gap"]||p["column-gap"],p["column-gap"],a=p["row-gap"],_=null,_="inline-grid"!==p["display"]?"grid":"inline-grid",n=n||"",h={size:"",name:null},m={size:"",name:null},M=r,I=s,O=o,L=a,H=!!p["gap"]||O===L;var d=0,c=(pe(l=l||"").forEach(function(e){e.size;e.last?h=e:j(e,d++)}),d=0,pe(n).forEach(function(e){e.size;e.last?m=e:Q(e,d++)}),0==A.length&&G.length?j({size:"none"}):0==G.length&&A.length&&Q({size:"none"}),0);(i||"").split(/["']/).forEach(function(e){var t;(e=$.trim(e)).length&&(t=0,e.split(/\s+/).forEach(function(e){"."==e&&(e=""),c<G.length&&t<A.length&&(D[c][t]=e),t++}),c++)}),Z()},X.clearCallbackList(),X.updateMatchedRules(!0,function(){e.call(N)}))},this.getCSS=function(){function e(e){var t=e.size;return t=e.name?"["+e.name+"] "+t:t}function t(e,t){for(var n=!0,i=0;i<e.length;i++)if(e[i].name||e[i].size!==e[0].size){n=!1;break}return t=n&&ge(Y)&&"1fr"===e[0].size?`repeat(${e.length}, ${e[0].size})`:t}var n=A.map(e).join(" "),i=be(D,!0),r=(1<A.length&&!h.name&&!i&&(n=t(A,n)),G.map(e).join(" ")),s=(1<G.length&&!m.name&&!i&&(r=t(G,r)),_),o=O,a=H?o:L,s=("none"!==n&&"none"!==r||(i&&ue.showQuickError(`Named grid areas are ignored because ${"none"===n?"columns":"rows"} are set to none.`),i=null),(n="none"===n?null:n)&&h.name&&(n+=` [${h.name}]`),(r="none"===r?null:r)&&m.name&&(r+=` [${m.name}]`),0!==A.length&&0!==G.length||(a=o=i=r=n=s=null),{display:s,"grid-template-columns":n,"grid-template-rows":r,"grid-template-areas":i,"grid-auto-columns":M,"grid-auto-rows":I,gap:null,"column-gap":null,"row-gap":null});return o===a?s.gap=o:(s["column-gap"]=o,s["row-gap"]=a),s},this.showGrid(),ue.addEventHandler("on_page_view_resized",t),ue.addEventHandler("on_active_page_view_changed",t),ue.addEventHandler("on_css_node_deleted",n),ue.addEventHandler("on_css_node_updated",n),ue.addEventHandler("on_css_node_added",n),ue.addEventHandler("on_page_changes_done",o),ue.addEventHandler("on_undo_redo",a),i.onDestroy=function(){we&&Ee(),ue.removeEventHandler("on_page_view_resized",t),ue.removeEventHandler("on_active_page_view_changed",t),ue.removeEventHandler("on_css_node_deleted",n),ue.removeEventHandler("on_css_node_updated",n),ue.removeEventHandler("on_css_node_added",n),ue.removeEventHandler("on_page_changes_done",o),ue.removeEventHandler("on_undo_redo",a),l.destroy()}}function i(e){return"string"==typeof e&&e.match(/^[^0-9\-\_][a-zA-Z\_\-0-9]*$/)}var de=function(){return ue.getSelectedPage().findFrameworkOfType("tailwind")},y=function(){var e={screens:[]};return ue.dispatchEvent("on_get_pseudo_states_for_pseudo_control",ue.getSelectedPage(),[],e),e.screens},ce=function(n){var i=[],e=y();return e.forEach(function(e){i.push(new r(null,"all"==e?"":e+`:`,n))}),ue.classStyles.getStylesForPgel(n).forEach(function(t){e.forEach(function(e){i.push(new r(t,"all"==e?"":e+`:`,n))})}),i},ge=function(e){return e instanceof r},x=function(e,t,n,i){for(var r=y(),s=getDeviceDefForPageView(e.activeView),s=s?s.name.toString().toLowerCase():"all",o=r.indexOf(s),a=t.length-1;0<=a;a--){if(r.indexOf(t[a].prefix?t[a].prefix.substring(0,t[a].prefix.length-1):"all")<=o&&(n?t[a].isGridItem():t[a].hasGrid()))return t[a];if(i)return null}return null},Se="https://pinegrow.com/docs/css-grid/",F=(ue.addEventHandler("on_set_inline_style",function(e,t){t.css+=`
    .pinegrow-ui-helper-css-grid {
        position:absolute;
        left:0;
        top:0;
        right:0;
        bottom:0;
        pointer-events: none !important;
        display: none !important;
        grid-column: unset !important;
        grid-row: unset !important;
        grid-area: unset !important;
        background: transparent !important;
    }
    .crsa-show-css-grid .pinegrow-ui-helper-css-grid {
        display:block !important;
    }
    .pinegrow-ui-helper-relative {
        position: relative !important;
        }
        .pinegrow-ui-helper-css-grid-cell {
            position: absolute !important;
            pointer-events: none !important;
            outline:1px dashed var(--pg-grid-outline) !important; 
            outline-offset: 0 !important;
            z-index: 101 !important;
            filter: drop-shadow(0px 0px 0px rgba(255, 255, 255, 0.5)) !important;
            background: transparent !important;
        }
        
        .pinegrow-ui-helper-css-grid-hl > pgdiv > .pinegrow-ui-helper-css-grid-cell {
            background-color: #009fff1c;
        }
        .pinegrow-grid-cell-during-resize {
            z-index: 100 !important;
            width: 100% !important;
            height: 100% !important;
            box-sizing: border-box !important;
        }
        .pinegrow-grid-during-resize > pgdiv > .pinegrow-ui-helper-css-grid-cell {
            min-height: 20px !important;
            min-width: 20px !important;
        }
        .pinegrow-ui-helper-css-grid-cell-highlight {
            background-color: #009fff1c !important;
        }
`}),new PgPageViewHelper("CSS grid","css-grid-helper","crsa-show-css-grid",$("<div></div>"),`html { --pg-grid-outline: #COLOR#;}`,"1",null,!0,"gray")),s=[],o=null,g=new PgDelayedTasks,n=(ue.addEventHandler("on_page_changes_done",function(e,t){C()}),ue.addEventHandler("on_css_applied_to_pages",function(e){C()}),ue.addEventHandler("on_selected_elements_changed",function(e){C()}),ue.addEventHandler("on_page_view_resized",function(){C()}),!1),b=(ue.addEventHandler("on_tailwind_compiled",function(){g.run("updateCSSGridControls",C,500),n&&(n=!1,ue.selectedElements.reselect())}),ue.addEventHandler("on_get_menu_commands",function(e,t,n,i){n.push({icon:"icon-grid",tooltip:"Edit CSS grid "+pgShowKbdCombo("CMD+G"),action:function(){E(t)}})}),ue.addEventHandler("on_build_actions_menu",function(e,t,n,i){t.push({label:"Edit CSS Grid...",kbd:"CMD G",action:function(){E(n)}})}),function(e){return"string"==typeof(e=e||0)&&(e=e.replace("px","")),isNaN(e)?0:parseFloat(e)}),k=null,P=[],f=S.gridGetMenuPointsWithCallback=function(e,c,g,p,h){var t,m,f,_,w,v,y,n,x=[];(g.pageView.isActive()||h)&&(F.getCurrentValue()||h)&&0!==g.$el.length&&"HTML"!==g.$el.get(0).tagName&&0!==g.$el.parent().length&&(y=new R(g.$el),t=new R(g.$el.parent()),m=new a(g.$el,y),k=c.getData("cssGridActiveRule"),!y.isGrid()||t.isGrid()&&m.isCell()?(n=g.$el.parent()).length&&1==n.get(0).nodeType&&(y=t,m.grid_info=y,m.update(),y.isGrid()&&m.isCell()?(f=k,h||(k=null),w=!1,"css"==S.mode&&(new CrsaProfile,(v=new PgActiveRules(g.pgel)).getMatchedRules(function(e){P=e;var r,t,n,i,s,o=["grid-area","grid-column-start","grid-column-end","grid-row-start","grid-row-end","grid-row","grid-column"],a=(ge(f)&&(_=f,w=!0),!w&&f&&("style_attribute"==f?(_=null,w=!0):0<=P.indexOf(f)&&(_=f,w=!0)),(w=!w&&de()&&(l=ce(g.pgel),_=T(g.pgel,g.pgel.getPage(),l))?!0:w)||he(g.pgel,o)&&(_=null,w=!0),w||(_=me(v.getActiveNodes(),o,!1))||(de()?_=l[0]:ue.selectedElements.isSelectedElement(g.pgel)&&(o=ue.getSelectedRule())&&"Style attribute"===(_=o).selector&&(_=null)),m.getAreaName()),l=(m.colRowPosition=m.getCellColRowPosition(),!1);if(a&&"auto"!==a?(r="area",d=' <areaname style="position: relative;top: -2px;">'+a+"</areaname>"):m.isAutoPlaced()?(r="auto",d=""):(r="fixed",d="",l=!0),h||((t=new z("right",g,"column-end",y,m)).active_css_rule=_,t.onDragStarted=C,x.push(t),(n=new z("left",g,"column-start",y,m)).active_css_rule=_,n.onDragStarted=C,x.push(n),(i=new z("top",g,"row-start",y,m)).active_css_rule=_,i.onDragStarted=C,x.push(i),(s=new z("bottom",g,"row-end",y,m)).active_css_rule=_,s.onDragStarted=C,x.push(s)),a||1){function u(){var e=y.getAvailableAreas(),n=[{label:"Edit parent grid...",kbd:"CMD G",action:function(){E(c.parent)}},{label:"Edit item grid...",action:function(){E(c)}}];if((e.length||1)&&(n.unshift({type:"header",label:"Grid"}),n.unshift({type:"divider"})),n.unshift({label:"Auto positioned",check:"auto"==r,action:function(){_=fe(_),"auto"!=r?(N(c,_,null),xe(c,_,"Auto position")):(N(c,_,m.getGridAreaShorthand(m.autoToFixedPlace())),xe(c,_,"Cols &amp; rows position")),ue.selectedElements.reselect()}}),n.unshift({type:"header",label:"Grid item"}),!1&&ge(_)||ge(_)&&!e.length||(n.unshift({type:"divider"}),ge(_)||n.unshift({label:"Set named area...",action:function(){ue.showPrompt(`<p>Enter the name of the new CSS grid area:</p>`,"Create &amp; set new CSS grid area",null,"areaname",null,function(i){var r,s;_=fe(_),(i=$.trim(i)).length&&i.match(/^[a-z][a-z0-9\_\-]*$/i)?(r=c.parent,(s=new PgActiveRules(r)).getMatchedRules(function(){var e=s.getActiveNodes(),t=null,n=["grid-template-areas","grid-template-columns","grid-template-rows","grid-auto-columns","grid-auto-rows"],e=(he(r,n)||(t=me(e,n)),m.getCellColRowPosition(!0));y.createNamedArea(r,t,i,e["grid-column-start"],e["grid-row-start"],e["grid-column-end"],e["grid-row-end"])?(ye(c,_,"grid-area",i),xe(c,_,"Set named area to "+i),ue.selectedElements.reselect()):ue.showQuickError("Sorry, couldn't create the new named area.")})):ue.showQuickError("Invalid area name.")})}}),a&&0&&n.unshift({label:"Update area "+a,action:function(){var n,i=c.parent,r=new PgActiveRules(i);r.getMatchedRules(function(){var e=r.getActiveNodes(),t=["grid-template-areas","grid-template-columns","grid-template-rows","grid-auto-columns","grid-auto-rows"],e=(he(i,t)||(n=me(e,t)),m.getCellColRowPosition(!0));y.createNamedArea(i,n,a,e["grid-column-start"],e["grid-row-start"],e["grid-column-end"],e["grid-row-end"])||ue.showQuickError("Sorry, couldn't create the new grid area.")})}}),e.forEach(function(e){n.unshift({label:e,action:function(){_=fe(_),ge(_)&&(ye(c,_,"grid-column-start",null,!0),ye(c,_,"grid-column-end",null,!0),ye(c,_,"grid-row-start",null,!0),ye(c,_,"grid-row-end",null,!0)),ye(c,_,"grid-area",e),xe(c,_,"Set named area to "+e),ue.selectedElements.reselect()},check:a==e})}),n.unshift({type:"header",label:"Set named area:"})),P){n.unshift({type:"divider"});for(var i,t=P.length-1;0<=t;t--)!function(e){n.unshift({label:pgcssh.getRuleDisplayName(e),check:e===_,action:function(){k=e,c.setData("cssGridActiveRule",e),ue.selectedElements.reselect()}})}(P[t]);n.unshift({label:"Style attribute",check:null===_,action:function(){k="style_attribute",c.setData("cssGridActiveRule",k),ue.selectedElements.reselect()}}),de()&&(e=ce(c))&&(i=0,e.forEach(function(e){var t=e.toOption(!0);n.splice(i++,0,{label:t.html,check:ge(_)&&_.isSame(e),action:function(){k=e,c.setData("cssGridActiveRule",k),ue.selectedElements.reselect()}})})),n.unshift({type:"header",label:"CSS Rule for changes:"})}return n}var o='<i class="icon icon-template"></i>'+d,d=("css"===S.mode&&(_?ge(_)?o+="<rulename>"+_.getShortName()+"</rulename>":o+="<rulename>"+pgcssh.getRuleDisplayName(_)+"</rulename>":o+="<rulename>Style attribute</rulename>"),new PgElementPageViewMenuPointButton(g,o));d.tooltip="Click for CSS grid item options.",x.push(d);if(h)return void p(u());d.onClick=function(){var e=u();new CrsaContextMenu(e,this.$element).showForElement(this.$element,this.$element.closest(".page"))},t.setIsNotSet(!l),n.setIsNotSet(!l),i.setIsNotSet(!l),s.setIsNotSet(!l),t.area_name_point=d,n.area_name_point=d,i.area_name_point=d,s.area_name_point=d}p(x)}))):h&&p([{label:"Edit grid...",action:function(){E(c)}}])):(n=new PgElementPageViewMenuPointButton(g,'<i class="icon icon-grid"></i>'),x.push(n),h?p([{label:"Edit grid...",action:function(){E(c)}}]):n.onClick=function(){E(c)}))},E=(ue.addEventHandler("on_get_menu_points_with_callback",function(e,t,n,i){f(e,t,n,i,!1)}),ue.addEventHandler("on_inserted_with_dragdrop",function(e,n){var i,t;n.gridPosition&&(i=`${n.gridPosition.row+1} / ${n.gridPosition.col+1} / ${n.gridPosition.row+2} / `+(n.gridPosition.col+2),t=function(e){var t;"css"==S.mode&&(de()?(t=(t=(t=e.getData("cssGridActiveRule"))&&!ge(t)?null:t)||T(e,e.getPage())||ce(e)[0],ye(e,t,"grid-column-start",n.gridPosition.col+1,!0),ye(e,t,"grid-column-end",n.gridPosition.col+2,!0),ye(e,t,"grid-row-start",n.gridPosition.row+1,!0),ye(e,t,"grid-row-end",n.gridPosition.row+2,!1)):(N(e,t=null,i),xe(e,t,"Set position in grid")))},n.inserted_elements.forEachElement(function(e){t(e)}),n.moved_elements.forEachElement(function(e){t(e)}))}),function(i,e){var t=new A(o=i,e||$("body"));C(),t.gridView.onChange=function(){C()},t.gridView.onDeviceSizeChanged=function(e,t){C()},t.gridView.onHighlightCell=function(e,t){var n=i.get$DOMElement();n&&((n=n.find("> .pinegrow-ui-helper-css-grid")).find("> .pinegrow-ui-helper-css-grid-cell-highlight").removeClass("pinegrow-ui-helper-css-grid-cell-highlight"),void 0!==e)&&void 0!==t&&n.find('[data-col-row="'+e+"-"+t+'"]').addClass("pinegrow-ui-helper-css-grid-cell-highlight")},t.win.onDestroy=function(){o=null,C()}}),Ce=(ue.showCSSGridControl=E,ue.addEventHandler("on_key_pressed",function(e,t,n){var i,r;"g"==n.key&&n.ctrl&&!n.edit&&(n.done=!0,i=ue.selectedElements.getLastSelected())&&(r=i.get$DOMElement(),!new R(r).isGrid()&&(r=i.parent.get$DOMElement(),new R(r).isGrid())?E(i.parent):E(i))}),function(e){return e&&e.currentStandardSizeDef?e.currentStandardSizeDef:null}),pe=function(e){function n(n,e){n.name=e.replace(/[\[\]]/g,""),n.names=n.name.split(/\s+/).map(function(e){var t={name:e,name_parsed:e.replace(/(\-start|\-end)$/g,""),start:null};return e.endsWith("-start")?t.start=!0:e.endsWith("-end")&&(t.start=!1),t}),n.getName=function(e){for(var t=0;t<n.names.length;t++)if(n.names[t].start===e)return n.names[t].name_parsed;return null}}var t,i=[],r=null;return splitCssValue(e,!1,/[\(\[]/,/[\)\]]/,!0).forEach(function(e){var t;e.startsWith("[")?r=e:(t={size:e},r&&(n(t,r),r=null),i.push(t))}),r&&(n(t={size:"",last:!0},r),i.push(t)),i},be=function(e,t){var n=!1,i="";return e.forEach(function(e){i.length&&(i+=" "),i=(i+=`"`)+e.map(function(e){return"."!=(e=0==$.trim(e).length?".":e)&&(n=!0),e}).join(" ")+`"`}),!n&&t?null:i},he=function(e,t){for(var n=0;n<t.length;n++)if(e.getInlineStylePropertyValue(t[n]))return!0;return!1},me=function(e,t,n){if(e=e||ue.pgActiveRules.getActiveNodes()){var i=null;if(n){i=ue.getSelectedRule();if(i&&0<=e.nodes_to_show.indexOf(i))if(!pgcssh.getStylesheetForNode(i).elementStyle)return i}if(e.nodes_to_show)for(var r=0;r<e.nodes_to_show.length;r++)for(var s=0;s<e.nodes_to_show[r].node.nodes.length;s++){var o=e.nodes_to_show[r].node.nodes[s];if("decl"==o.type&&0<=t.indexOf(o.prop))return i=e.nodes_to_show[r].node}}return null},$e=function(e,t){for(var n=0;n<e.nodes.length;n++){var i=e.nodes[n];if("decl"===i.type&&i.prop===t)return i.value}},fe=function(e){var t,n;return e=e&&!ge(e)&&(n=pgcssh.getStylesheetForNode(e))&&pgcssh.getRootNodeFor(e)!==n.getRootNode()&&(t=pgcssh.getNodeIndices(e),n=pgcssh.getNodeByIndices(n.getRootNode(),t))?n:e},_=new PgActiveClassesForPgel_State,ke=function(e){return e=_.getSubelementSelector(e).replace(/^\[(.*)\]$/,"$1")},Pe=function(e){var t,n=ue.findFrameworkByKey("tw");return n?(n=n.twGetSpacingPointsWithoutFractions(),e?(t=[],n.forEach(function(e){t.push({key:e,name:e})}),t):n):[]},_e={},w=[],v=(ue.addEventHandler("on_project_loaded",function(){d()}),ue.addEventHandler("on_page_frameworks_changed",function(){d()}),function(e){return w}),we=null,V=function(e,t){return we&&we.page!==e.getPage()&&Ee(),we||((we=new PgFastDOMClassPreviewForPgel(e,"")).list=[],we.class_map={},we.all_classes=[]),we},Ee=function(){we&&(we.destroy(),we=null)},ve=function(e,t,n){n=n||"";var i=V(e);v().concat(t||[]).forEach(function(e){e=n+e,we.class_map[e]||(we.all_classes.push({key:e}),we.class_map[e]=!0)}),i.triggerPreviewEvent("dummy-class",we.all_classes)},h=[],ye=function(e,t,n,i,r,s){var o,a,l,u,d,c,g={gap:"grid-gap","column-gap":"grid-column-gap","row-gap":"grid-row-gap"};ge(t)?_e[n]&&((o=(o=_e[n].custom_to_class?_e[n].custom_to_class(i):null)||null===i?o:_e[n].values[i]||_e[n].class.replace("#VAL",p(i)))||1)&&(a=new PgApi,l=[],u=_e[n].class.replace("#VAL",""),d=o?[t.prefix+o]:[],t.getClasses(!0).forEach(function(e){(u.endsWith("-")&&e.startsWith(u)||_e[n].replace_re&&e.match(_e[n].replace_re))&&(e=t.prefix+e,d.indexOf(e)<0)&&l.push(e)}),!d.length&&!l.length&&r||(o&&h.indexOf(o)<0&&h.push(o),a.addClass(e,d,{source:s,action:"Set CSS grid"},l,t.class_style||"inline",r),r)||(ve(t.pgel,h,t.prefix),h=[])):t?(c=pgcssh.getStylesheetForNode(t),g[n]&&$e(t,g[n])&&c.ruleValueChanged(t,g[n],null,null,!1,"cssgridcontrol",!1,null,null,null,null,!0),c.ruleValueChanged(t,n,i,function(){c.inline},!1,"cssgridcontrol",!1,null,null,null,null,r)):(g[n]&&e.setInlineStylePropertyValue(g[n],null),e.setInlineStylePropertyValue(n,i))},N=function(e,t,n){ye(e,t,"grid-column",null,!0),ye(e,t,"grid-row",null,!0),ye(e,t,"grid-area",n,!0),ye(e,t,"grid-column-start",null,!0),ye(e,t,"grid-column-end",null,!0),ye(e,t,"grid-row-start",null,!0),ye(e,t,"grid-row-end",null,!1)},xe=function(e,t,n,i,r){var s;ge(t)||(t?(s=pgcssh.getStylesheetForNode(t),ue.dispatchEvent("on_css_node_updated",null,{node:t,stylesheet:s,edited_by:i,undoRuleName:n})):(ue.changeManager.didChange(e,n,r),ue.dispatchEvent("on_css_attribute_style_changed",e.getPage(),e)))},A=function(e,t){var n=this.gridView=new c(e),i=this.win=new PgQuickWindow("CSS Grid for "+e.getName({short:!0}),n,"quickCSSGridControl",600,600,null,!0);i.noRightEdge(),i.onFloatingChanged=function(){n.showGrid()},i.showFor$El(t||e.get$DOMElement(),!0),i.addIconToHeader("icon-271","Learn more about CSS grid.",function(){ue.openExternalUrl(Se)})},R=function(e,t){var n,i=e.get(0);if(this.$el=e,this.el=i,this.s=null,1==i.nodeType&&(n=this.s=window.getComputedStyle(i)),t){for(var r,s=e,o=n;!this.isGrid(o)&&s.length;)(s=s.parent()).length&&1==(r=s.get(0)).nodeType&&(o=window.getComputedStyle(r));s.length&&(n=this.s=o,this.$el=e=s,this.el=e.get(0))}this.update(),this.position=n.position},a=(R.prototype.update=function(){this.s&&(this.cols=pe(this.s.gridTemplateColumns).map(function(e){return e.value=parseFloat(e.size.replace("px","")),e}),this.num_of_cols=this.cols.length,0<this.num_of_cols&&this.cols[this.num_of_cols-1].last&&this.num_of_cols--,this.rows=pe(this.s.gridTemplateRows).map(function(e){return e.value=parseFloat(e.size.replace("px","")),e}),this.num_of_rows=this.rows.length,0<this.num_of_rows&&this.rows[this.num_of_rows-1].last&&this.num_of_rows--,this.gap_col=b(this.s.gridColumnGap),this.gap_row=b(this.s.gridRowGap),this.rect=this.el.getBoundingClientRect())},R.prototype.createNamedArea=function(e,t,n,i,r,s,o){i=parseInt(i),r=parseInt(r),s=parseInt(s),o=parseInt(o);var a=null;if(!(l=(a=t?$e(t,"grid-template-areas"):e.getInlineStylePropertyValue("grid-template-areas"))?m(a):l))for(var l=[],u=0;u<this.num_of_rows;u++){for(var d=[],c=0;c<this.num_of_cols;c++)d.push(".");l.push(d)}for(u=0;u<l.length;u++)for(c=0;c<l[u].length;c++)l[u][c]==n&&(l[u][c]=".");var a=l.length,g=0<a?l[0].length:0;if(0==a||0==g)return!1;if(i<1||g<i||s-1<1||g<s-1||r<1||a<r||o-1<1||a<o-1||s-1<i||o-1<r)return!1;for(var p=r;p<=o-1;p++)for(var h=i;h<=s-1;h++)l[p-1][h-1]=n;t=fe(t);g=be(l);return ye(e,t,"grid-template-areas",g),xe(e,t,"Create grid area"),!0},R.prototype.getNumber=function(e){return parseFloat(e.replace("px",""))},R.prototype.isGrid=function(e){return(e=e||this.s)&&("grid"==e.display||"inline-grid"==e.display)},R.prototype.makeFixedSizeInDOM=function(){function e(e,t){return pe(e).map(function(e){return(val=n.getNumber(e.size))<t&&(val=t),(val=e.name?"["+e.name+"] "+val:val)+"px"}).join(" ")}var n=this;pgSaveOriginalStyle(this.$el),this.$el.css({"grid-template-columns":e(this.s.gridTemplateColumns,0),"grid-template-rows":e(this.s.gridTemplateRows,40)})},R.prototype.restoreOriginalSizeInDOM=function(){pgRestoreOriginalStyle(this.$el)},R.prototype.getCellRect=function(e,t){var n={left:this.getXForColStart(e),right:this.getXForColEnd(e),top:this.getYForRowStart(t),bottom:this.getYForRowEnd(t)};return n.width=n.right-n.left,n.height=n.bottom-n.top,n.name=t+1+` / ${e+1} / ${t+2} / `+(e+2),n},R.prototype.getAvailableAreas=function(){var e=[],t={},n=m(this.s.gridTemplateAreas);if(n)for(var i=0;i<n.length;i++)for(var r=0;r<n[i].length;r++)""==n[i][r]||"."==n[i][r]||t[n[i][r]]||(t[n[i][r]]=!0,e.push(n[i][r]));return e},R.prototype.getAreaPosition=function(e){var t=m(this.s.gridTemplateAreas);if(t){for(var n,i={"grid-column-start":null,"grid-column-end":null,"grid-row-start":null,"grid-row-end":null},r=0;r<t.length;r++)for(n=0;n<t[r].length;n++)t[r][n]==e&&(null===i["grid-row-start"]&&(i["grid-row-start"]=r+1),null===i["grid-column-start"]&&(i["grid-column-start"]=n+1),i["grid-column-end"]=n+2,i["grid-row-end"]=r+2);return i}return null},R.prototype.getColForX=function(e,t,n){return this.getTrackForX(e,t,n)},R.prototype.getTrackForX=function(e,t,n){return this.getTrackForValue("col",e,t,n)},R.prototype.getXForColStart=function(e){for(var t=this.getNumber(this.s.paddingLeft),n=0;n<this.num_of_cols;n++){if(n==e)return t;t=(t+=this.cols[n].value)+this.gap_col}return t},R.prototype.getXForColEnd=function(e){for(var t=this.getNumber(this.s.paddingLeft),n=0;n<this.num_of_cols;n++){if(t+=this.cols[n].value,n==e)return t;t+=this.gap_col}return t},R.prototype.getRowForY=function(e,t,n){return this.getTrackForY(e,t,n)},R.prototype.getRowForYOld=function(e,t,n){null==t&&(t=this.num_of_rows);for(var i=this.getNumber(this.s.paddingTop),r=n?-1:1,s=0;s<this.num_of_rows;s++){if(i<=e&&i+this.rows[s].value+r>=e)return s;if(i+this.rows[s].value<=e&&e<i+this.rows[s].value+this.gap_row)return s;i+=this.gap_row+this.rows[s].value}return t},R.prototype.getColForXOld=function(e,t,n){null==t&&(t=this.num_of_cols);for(var i=this.getNumber(this.s.paddingLeft),r=n?-1:1,s=0;s<this.num_of_cols;s++){if(i<=e&&i+this.cols[s].value+r>=e)return s;if(i+this.cols[s].value<=e&&e<i+this.cols[s].value+this.gap_col)return s;i+=this.gap_col+this.cols[s].value}return t},R.prototype.getTrackForValue=function(e,t,n,i){var r,s,o,a="row"===e?(r=this.num_of_rows,s=this.rows,o=this.gap_row,this.getNumber(this.s.paddingTop)+this.getNumber(this.s.borderTopWidth)):(r=this.num_of_cols,s=this.cols,o=this.gap_col,this.getNumber(this.s.paddingLeft)+this.getNumber(this.s.borderLeftWidth));null==n&&(n=r);for(var l,u=null,d=0;d<r+1;d++){l=void 0,l=a,l=i?l-t:t-l,l=Math.abs(l)<1?0:l;if(null!==u&&0<=u&&(u<l||l<0))return d-1;u=l,d<s.length&&(a+=o+s[d].value)}return n},R.prototype.getTrackForY=function(e,t,n){return this.getTrackForValue("row",e,t,n)},R.prototype.getYForRowStart=function(e){for(var t=this.getNumber(this.s.paddingTop),n=0;n<this.num_of_rows;n++){if(n==e)return t;t=(t+=this.rows[n].value)+this.gap_row}return t},R.prototype.getYForRowEnd=function(e){for(var t=this.getNumber(this.s.paddingTop),n=0;n<this.num_of_rows;n++){if(t+=this.rows[n].value,n==e)return t;t+=this.gap_row}return t},R.prototype.placeAllAutoCellsInDOM=function(r){var s=this;this.$el.children().each(function(e,t){var n=$(t),i=new a(n,s);!i.isCell()||!i.isAutoPlaced()||r&&r===t||(pgSaveOriginalStyle(n),i=i.autoToFixedPlace(),n.css(i))})},R.prototype.restorePlacedCellsInDOM=function(){this.$el.children().each(function(e,t){var n=$(t);pgRestoreOriginalStyle(n)})},window.PgCSSGridInfo=R,function(e,t){var n=e.get(0);this.s=null,1==(this.el=n).nodeType&&(this.s=window.getComputedStyle(n)),this.grid_info=t,this.update()}),l=(a.prototype.update=function(){this.grid_info&&(this.rect=this.el.getBoundingClientRect(),this.x=this.rect.left-this.grid_info.rect.left,this.end_x=this.x+this.rect.width,this.y=this.rect.top-this.grid_info.rect.top,this.end_y=this.y+this.rect.height)},a.prototype.getGridCSSValue=function(e){return this.s["grid"+e]},a.prototype.isCell=function(){return this.s&&["absolute","fixed"].indexOf(this.s.position)<0&&"none"!==this.s.display},a.prototype.isAutoPlaced=function(){return!("auto / auto / auto / auto"!==this.s.gridArea&&"auto"!==this.s.gridArea||"auto"!==this.s.gridColumnStart&&"auto"!==this.s.gridColumnEnd&&"auto"!==this.s.gridRowStart&&"auto"!==this.s.gridRowEnd)},a.prototype.getAreaName=function(){var e;return!this.s.gridColumnStart.match(/^[^0-9\-\_][a-zA-Z\_\-0-9]*$/)||this.s.gridColumnStart!==this.s.gridColumnEnd||this.s.gridColumnStart!==this.s.gridRowStart||this.s.gridColumnStart!==this.s.gridRowEnd||"auto"===this.s.gridColumnStart||(e=function(e,t){for(var n=0;n<t.length;n++)if(t[n].names)for(var i=0;i<t[n].names.length;i++)if(t[n].names[i].name_parsed===e&&null!==t[n].names[i].start)return!0;return!1})(this.s.gridColumnStart,this.grid_info.cols)&&e(this.s.gridColumnStart,this.grid_info.rows)?null:this.s.gridColumnStart},a.prototype.autoToFixedPlace=function(){var e=l(this.s.gridColumnStart)?this.s.gridColumnStart:this.grid_info.getColForX(this.x)+1,t=l(this.s.gridColumnEnd)?this.s.gridColumnEnd:this.grid_info.getColForX(this.end_x,null,!0)+1,n=l(this.s.gridRowStart)?this.s.gridRowStart:this.grid_info.getRowForY(this.y)+1,i=l(this.s.gridRowEnd)?this.s.gridRowEnd:this.grid_info.getRowForY(this.end_y,null,!0)+1;return{"grid-column-start":e.toString(),"grid-column-end":t.toString(),"grid-row-start":n.toString(),"grid-row-end":i.toString()}},function(e){return"number"==typeof e||"string"==typeof e&&e.match(/^[0-9]+$/)}),G=(a.prototype.getCellColRowPosition=function(e){var t,n=this.getAreaName();if(n&&(t=this.grid_info.getAreaPosition(n)))return t;return e||this.isAutoPlaced()?this.autoToFixedPlace():(t={},(i(this.s.gridColumnStart)||l(this.s.gridColumnStart))&&(t["grid-column-start"]=this.s.gridColumnStart),"grid-column-start"in t||(t["grid-column-start"]=this.grid_info.getColForX(this.x)+1),(i(this.s.gridColumnEnd)||l(this.s.gridColumnEnd))&&(t["grid-column-end"]=this.s.gridColumnEnd),"grid-column-end"in t||(t["grid-column-end"]=this.grid_info.getColForX(this.end_x,null,!0)+1),(i(this.s.gridRowStart)||l(this.s.gridRowStart))&&(t["grid-row-start"]=this.s.gridRowStart),"grid-row-start"in t||(t["grid-row-start"]=this.grid_info.getRowForY(this.y)+1),(i(this.s.gridRowEnd)||l(this.s.gridRowEnd))&&(t["grid-row-end"]=this.s.gridRowEnd),"grid-row-end"in t||(t["grid-row-end"]=this.grid_info.getRowForY(this.end_y,null,!0)+1),t)},a.prototype.getColName=function(e,t){var n;return void 0===t&&(t=!1),!i(e)&&0<=(n=parseInt(e)-1)&&n<this.grid_info.cols.length&&this.grid_info.cols[n].name&&this.grid_info.cols[n].getName(t)||e},a.prototype.getRowName=function(e,t){var n;return void 0===t&&(t=!1),!i(e)&&0<=(n=parseInt(e)-1)&&n<this.grid_info.rows.length&&this.grid_info.rows[n].name&&this.grid_info.rows[n].getName(t)||e},a.prototype.getGridAreaShorthand=function(e){var t=this.getColsRowsPosition(e);return t.rs&&t.rs===t.cs&&t.cs===t.re&&t.re===t.ce?t.rs:`${t.rs} / ${t.cs} / ${t.re} / `+t.ce},a.prototype.getColsRowsPosition=function(e){var t=this.getRowName(e["grid-row-start"],!0),n=this.getColName(e["grid-column-start"],!0),i=this.getRowName(e["grid-row-end"]);return{cs:n,rs:t,ce:this.getColName(e["grid-column-end"]),re:i}},window.PgCSSGridCellInfo=a,function(){var y=null,x=null,t=(this.show=function(e){function t(e,t,n){return`<pgdiv class="pinegrow-ui-helper pinegrow-ui-helper-${e}" style="${t||""}" ${n||""}>`}for(var n=new R(x=e),i=n.cols,r=n.rows,s=n.gap_col,o=n.gap_row,a=n.getNumber(n.s.paddingLeft),l=n.getNumber(n.s.paddingTop),u=t("css-grid"),d=0,c=0,g=0,p=0,h=0;h<r.length&&!r[h].last;h++)c+=o+r[h].value,p+=r[h].value;for(var m=0;m<i.length&&!i[m].last;m++)d+=s+i[m].value,g+=i[m].value;var f=n.rect.width-a-n.getNumber(n.s.paddingRight),_=n.rect.height-l-n.getNumber(n.s.paddingBottom),w=n.getNumber(n.s.paddingLeft);switch(n.s.justifyContent){case"center":w=Math.max(0,w+(f-d)/2);break;case"end":case"right":case"flex-end":w=Math.max(0,w+(f-d));break;case"space-between":d<f&&1<n.num_of_cols&&(s=(f-g)/(n.num_of_cols-1));break;case"space-around":d<f&&0<n.num_of_cols&&(w+=(s=(f-g)/n.num_of_cols)/2);break;case"space-evenly":d<f&&0<n.num_of_cols&&(w+=s=(f-g)/(n.num_of_cols+1))}var v=l;switch(n.s.alignContent){case"center":v=Math.max(0,v+(_-c)/2);break;case"end":case"flex-end":v=Math.max(0,v+(_-c));break;case"space-between":c<_&&1<n.num_of_rows&&(o=(_-p)/(n.num_of_rows-1));break;case"space-around":c<_&&0<n.num_of_rows&&(v+=(o=(_-p)/n.num_of_rows)/2);break;case"space-evenly":c<_&&0<n.num_of_rows&&(v+=o=(_-p)/(n.num_of_rows+1))}for(l=v,h=0;h<r.length&&!r[h].last;h++){for(a=w,m=0;m<i.length&&!i[m].last;m++)u+=t("css-grid-cell",`top:${l}px;left:${a}px;width:${i[m].value}px;height:${r[h].value}px;`,`data-col-row="${m}-${h}"`)+"</pgdiv>",a+=s+i[m].value;l+=o+r[h].value}u+="</pgdiv>",y=$(u),"static"==n.position&&e.addClass("pinegrow-ui-helper-relative"),e.append(y)},this.update=function(){y&&y.remove(),this.show(x)},!1);this.setHighlight=function(e){t!=e&&(e?y.addClass("pinegrow-ui-helper-css-grid-hl"):y.removeClass("pinegrow-ui-helper-css-grid-hl"),t=e)},this.destroy=function(){y&&y.remove()}}),z=(window.PgCSSGridOverlayControl=G,function(e,t,n,i,r){PgElementPageViewMenuPoint.call(this,e,t);var s=this;this.mode=S.mode,this.placement=e,this.type=n,this.menu=t,this.tooltip="",this.active_css_rule=null,this.$grid=t.$el.parent(),this.info=i||new R(this.$grid),this.cell_info=r||new a(t.$el,this.info),this.onPageViewsUpdated=function(e,t){s.info.update_id&&s.info.update_id==t||(s.info.update(),s.info.update_id=t),s.cell_info.update_id&&s.cell_info.update_id==t||(s.cell_info.update(),s.cell_info.update_id=t)},ue.addEventHandler("on_page_views_updated",this.onPageViewsUpdated),this.update()});extendObject(z,PgElementPageViewMenuPoint),z.prototype.setIsNotSet=function(e){PgElementPageViewMenuPoint.prototype.setIsNotSet.call(this,e),this.tooltip=e?"Positioned automatically or with a named area. Move to position with columns &amp; rows.":null},z.prototype.update=function(){switch(this.type){case"column-start":"auto"==this.cell_info.getGridCSSValue("ColumnStart")?(this.setText("A"),this.setIsNotSet(!0)):this.setText(this.cell_info.colRowPosition["grid-"+this.type]);break;case"column-end":"auto"==this.cell_info.getGridCSSValue("ColumnEnd")?(this.setText("A"),this.setIsNotSet(!0)):this.setText(this.cell_info.colRowPosition["grid-"+this.type]);break;case"row-start":"auto"==this.cell_info.getGridCSSValue("RowStart")?(this.setText("A"),this.setIsNotSet(!0)):this.setText(this.cell_info.colRowPosition["grid-"+this.type]);break;case"row-end":"auto"==this.cell_info.getGridCSSValue("RowEnd")?(this.setText("A"),this.setIsNotSet(!0)):this.setText(this.cell_info.colRowPosition["grid-"+this.type])}},z.prototype.add=function(e,t){PgElementPageViewMenuPoint.prototype.add.call(this,e,t),this.update()},z.prototype.onReposition=function(){this.in_drag||this.update()},z.prototype.onDragStart=function(e,t){this.original_z=this.menu.$el.css("z-index"),this.info.makeFixedSizeInDOM(),this.info.update(),this.cell_info.update(),pgSaveOriginalStyle(this.menu.$el),this.info.placeAllAutoCellsInDOM(this.menu.$el.get(0)),this.menu.$el.addClass("pinegrow-grid-cell-during-resize"),this.info.$el.addClass("pinegrow-grid-during-resize"),this.mode,this.current_value=null,this.onDragStarted&&this.onDragStarted.call(this),ge(this.active_css_rule)&&ve(this.menu.pgel,null,this.active_css_rule.prefix)},z.prototype.setChangeForTWClass=function(e){this.current_value=this.cell_info.getColsRowsPosition(this.cell_info.colRowPosition);var t=this.cell_info.getGridAreaShorthand(this.cell_info.colRowPosition);this.type.startsWith("column")||1?ye(this.menu.pgel,this.active_css_rule,"grid-column",null,!0):(this.type.startsWith("row")||1)&&ye(this.menu.pgel,this.active_css_rule,"grid-row",null,!0),t&&(t.indexOf("/")<0||!t.match(/^[0-9\/auto ]*$/))?(ye(this.menu.pgel,this.active_css_rule,"grid-area",t,!0),ye(this.menu.pgel,this.active_css_rule,"grid-column-start",null,!0),ye(this.menu.pgel,this.active_css_rule,"grid-column-end",null,!0),ye(this.menu.pgel,this.active_css_rule,"grid-row-start",null,!0),ye(this.menu.pgel,this.active_css_rule,"grid-row-end",null,e||!1),e&&ve(this.menu.pgel,[`[grid-area:${p(t,!0)}]`],this.active_css_rule.prefix)):(ye(this.menu.pgel,this.active_css_rule,"grid-area",null,!0),ye(this.menu.pgel,this.active_css_rule,"grid-column-start",this.current_value.cs,!0),ye(this.menu.pgel,this.active_css_rule,"grid-column-end",this.current_value.ce,!0),ye(this.menu.pgel,this.active_css_rule,"grid-row-start",this.current_value.rs,!0),ye(this.menu.pgel,this.active_css_rule,"grid-row-end",this.current_value.re,e||!1))},z.prototype.onDrag=function(e,t){var n,i,r,s,o=e/this.menu.pageView.zoom,a=t/this.menu.pageView.zoom;switch(0,ue.keyState.shift&&pgIsDev()&&(ue.keyState.shift=!1),this.type){case"column-start":var l=this.info.getColForX(this.cell_info.x+o,0);this.cell_info.colRowPosition["grid-"+this.type]=Math.min(l+1,this.info.num_of_cols);break;case"column-end":this.cell_info.colRowPosition["grid-"+this.type]=Math.min(this.info.getColForX(this.cell_info.end_x+o,null,!0)+1,this.info.num_of_cols+1);break;case"row-start":l=this.info.getRowForY(this.cell_info.y+a,0)+1;this.cell_info.colRowPosition["grid-"+this.type]=Math.min(l,this.info.num_of_rows);break;case"row-end":this.cell_info.colRowPosition["grid-"+this.type]=Math.min(this.info.getRowForY(this.cell_info.end_y+a,null,!0)+1,this.info.num_of_rows+1)}return"css"===this.mode?(this.active_css_rule=fe(this.active_css_rule),ge(this.active_css_rule)?this.setChangeForTWClass(!0):(s=this.current_value=this.cell_info.getGridAreaShorthand(this.cell_info.colRowPosition),N(this.menu.pgel,this.active_css_rule,s))):(n=this.menu.pgel,i="grid-area",r=s,s=pgDmStore.getSkillByKey("grid.item"),pgDmStore.setSkillParam(n,s,i,r)),this.update(),this.setIsNotSet(!1),this.area_name_point&&(this.area_name_point.destroy(),this.area_name_point=null),this.menu.reposition(),{x:e,y:t}},z.prototype.onClick=function(){},z.prototype.onDragStop=function(e,t){ue.removeEventHandler("on_page_views_updated",this.onPageViewsUpdated),("css"==this.mode?pgForgetOriginalStyle:pgRestoreOriginalStyle)(this.menu.$el),this.menu.$el.removeClass("pinegrow-grid-cell-during-resize"),this.info.$el.removeClass("pinegrow-grid-during-resize"),this.setLabel(),this.info.restoreOriginalSizeInDOM(),this.info.restorePlacedCellsInDOM(),"css"==this.mode?this.current_value&&(this.active_css_rule=fe(this.active_css_rule),ge(this.active_css_rule)?(n=!0,this.setChangeForTWClass()):N(this.menu.pgel,this.active_css_rule,this.current_value),xe(this.menu.pgel,this.active_css_rule,"Set position in grid")):ue.changeManager.didChange(this.menu.pgel,"Change position in grid"),ue.selectedElements.reselect()}}),Ne=function(){var o=$("<div/>");this.test=function(e,t){if("string"!=typeof t||""===t)return!0;var n=!0;try{if(t.match(/[\$\@]/)||(o.css(e,t),n=""!==o.css(e),o.css(e,"")),n){for(var i=0,r=0;r<t.length;r++){var s=t.charAt(r);"("===s?i++:")"===s&&i--}0!==i&&(n=!1)}}catch(e){}return n}})});
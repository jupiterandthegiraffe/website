window.pg_app="WPPLUGIN";var app_key="settings-"+"app",pgf=(0 in window.localStorage,{});switch(window.pg_app){case"PG":window.pgf={project_db:!1,components:!0,use_selectors:!1,open_url:!0,force_project:!1,save_html:!0,save_css:!0,product:"PG",app_id:"PINEGROW",app_class:"pinegrow",product_name:"Pinegrow Web Editor",product_name_short:"Pinegrow Web Editor",product_url:"https://pinegrow.com",buy_url:"https://pinegrow.com/#buy",docs:{support_url:"https://pinegrow.com/support",help_url:"https://pinegrow.com/docs",shortcuts_url:"help://shortcuts",intro_video_url:"https://pinegrow.com/docs/getting-started/pinegrow-walkthrough-video/",intro_video_label:"Pinegrow Web Editor Walkthrough - Video",video_tutorials_url:"https://www.youtube.com/channel/UCo2RGSbsI9GIxVvJPXanUuw/playlists",quick_intro_url:"help://intro",quick_intro_label:"Quick introduction to Pinegrow Web Editor",remote_url_help:"https://pinegrow.com/docs/master-pinegrow/edit-remote-websites-and-web-applications/",dyn_elements_help:"https://pinegrow.com/docs/master-pinegrow/working-with-dynamic-html-elements/"},whatsnew:{image:"images/whatsnew/pg6.jpg",left:`      

<p><span style="margin-top:15px;display: inline-block;
                text-transform: uppercase;
        font-size: 13px;
        color: #1787b3;
        margin-bottom:0;">AI Assistant</span></p>
<ul>
    <li>Smart insert with visual check</li>
    <li>Content sources</li>
    <li>Edit Component & Class Styles</li>
    <li>Auto create reusable components</li>
    <li>Project brief helper</li>
</ul>
<p><span style="display: inline-block;
                text-transform: uppercase;
        font-size: 13px;
        color: #1787b3;
        margin-bottom:0;">WordPress</span></p>
<ul>
    <li>Auto create WordPress blocks with AI</li>
    <li>Export Block themes</li>
    <li>Tailwind CSS helpers for WordPress styling</li>
</ul>
<p><span style="display: inline-block;
                text-transform: uppercase;
        font-size: 13px;
        color: #1787b3;
        margin-bottom:0;">General</span></p>
<ul>
    <li>Performance improvements</li>
</ul>
`,right:`<p class="lead"></p>`,url:"https://pinegrow.com/release_notes/pinegrow-web-editor-8-2/"},logo:"",layout_prefix:"",edit_page_code:!0,edit_css:!0,edit_server_side_scripts:!0,editor_sync:!0,edit_html:!0,edit_apps:!1,select_elements:!0,multi_win:!0,hide_panels:!0,multi_page_views:!0,version_url:"version.json",version:"8.3",default_port:4e4,use_server:!0,use_backups:!0,stats_settings:!0,smart_blocks:!1,clipboard:!0,settings:!0,auto_focus:!1,class_styles:!0,root_urls:!0,auto_text_edit_done:!1,simple_element_menu:!0,use_page_wrappers:!0,html_snippets:!0,insert_in_top_menu:!0,empty_ph_attribute:"data-empty-placeholder",buy:{header:`Hi, there! Want to build your professional web projects visually?<br>Use Pinegrow to create smarter, faster and easier than ever before.`},trial_activated_html:"<p>Your trial was activated. All features, including PRO, Interactions, WordPress builder and Tailwind editor, are enabled.</p><p>Please note that the commercial use of work that includes Pinegrow Interactions and is created in trial mode is not allowed.</p><p>And get in touch if you need a longer trial period.</p>",welcome_message:"Welcome to Pinegrow Web Editor!",start_tab_learn:"Learn",start_tab_create:"Create",start_tab_learn_tooltip:"Learn how to use Pinegrow to build WordPress themes and blocks.",start_tab_create_tooltip:"Create WordPress themes, blocks and static HTML websites.",lesson_name:"tutorial lesson",your_projects_label:"Your projects",no_projects_message:"You don't have any recent projects."};break;case"KIDS":window.pgf={kids:!0,home_history_state:"/",srcset_mode:!0,html_snippets:!1,insert_in_top_menu:!0,project_in_top_menu:!0,repeater:!1,use_focus:!1,project_db:!1,components:!1,use_selectors:!1,open_url:!0,force_project:!1,save_html:!0,save_css:!0,product:"KIDS",app_id:"KIDS",app_class:"pinegrow kids",product_name:"HTML Planet for Kids",product_name_short:"HTML Planet for Kids",product_url:"https://htmlplanetforkids.com",buy_url:"https://htmlplanetforkids.com/#buy",sentry_dsn:"",docs:{support_url:"https://pinegrow.com/support",help_url:null,shortcuts_url:null,intro_video_url:"https://pinegrow.com/docs/getting-started/pinegrow-walkthrough-video/",intro_video_label:"Pinegrow Web Editor Walkthrough - Video",video_tutorials_url:"https://www.youtube.com/channel/UCo2RGSbsI9GIxVvJPXanUuw/playlists",quick_intro_url:"help://intro",quick_intro_label:"Quick introduction to Pinegrow Web Editor",remote_url_help:"https://pinegrow.com/docs/master-pinegrow/edit-remote-websites-and-web-applications/",dyn_elements_help:"https://pinegrow.com/docs/master-pinegrow/working-with-dynamic-html-elements/"},whatsnew:{image:"images/whatsnew/pg5.1.jpg",right:`<p class="lead"></p>`,left:``,url:"https://pinegrow.com/release_notes/pinegrow-web-editor-5-95-april-1-2020/"},logo:"kids/kids.logo4.png",logo_name:"HTML Planet for Kids",layout_prefix:"",edit_page_code:!0,edit_css:!0,edit_server_side_scripts:!1,editor_sync:!1,edit_html:!0,edit_apps:!1,select_elements:!0,multi_win:!1,hide_panels:!1,multi_page_views:!1,version_url:"version_kids.json",version:"1.0",default_port:4e4,use_server:!1,use_backups:!0,load_srcdoc:!0,stats_settings:!0,smart_blocks:pgIsDev(),clipboard:!0,settings:!0,auto_focus:!1,class_styles:!1,simple_element_menu:!0,whatsnew:!1,use_project_changes:!0,empty_ph_attribute:"data-empty-placeholder",your_projects_label:"Your amazing projects",buy:{header:`Hi, there! Want to build your professional web projects visually?<br>Use Pinegrow to create smarter, faster and easier than ever before.`},trial_activated_html:"<p>Your trial was activated. All features, including PRO, Interactions and WordPress builder, are enabled.</p><p>Please note that the commercial use of work that includes Pinegrow Interactions and is created in trial mode is not allowed.</p><p>And get in touch if you need a longer trial period.</p>",paddle_id:127758,kids_with_transitions:localStorage["css-advanced"]||!1,welcome_message:"Hi#NAME, welcome to HTML Planet!",start_tab_learn:"Learn HTML &amp; CSS",start_tab_create:"Create projects",start_tab_learn_tooltip:"Learn about HTML &amp; CSS with friendly aliens from HTML Planet.",start_tab_create_tooltip:"Create fun projects, websites and web toys.",lesson_name:"Adventure",all_lessons_done:`<p>Congratulations! You completed all adventures. Now you can use your HTML &amp; CSS skills to create your own projects.</p><p>Go to the Create Projects area and create a website, school project or a fun web toy.</p>`,all_lessons_done_button:"I'm a web creator now!"};break;case"WPPLUGIN":window.pgf={kids:!1,home_history_state:pgwpdata.edit_link,html_snippets:!1,srcset_mode:!0,insert_in_top_menu:!0,project_in_top_menu:!0,repeater:!0,project_db:!0,default_emmet_setting:"true",components:!0,use_selectors:!1,open_url:!0,force_project:!1,save_html:!0,save_css:!0,product:"WPPLUGIN",app_id:"WPPLUGIN",app_class:"pinegrow online",product_name:"Pinegrow WordPress Plugin",product_name_short:"Pinegrow",product_url:"https://pinegrow.com/wordpress",buy_url:"https://pinegrow.com/wordpress#buy",sentry_dsn:"",docs:{support_url:"https://pinegrow.com/support",help_url:null,shortcuts_url:null,intro_video_url:"https://pinegrow.com/docs/getting-started/pinegrow-walkthrough-video/",intro_video_label:"Pinegrow Web Editor Walkthrough - Video",video_tutorials_url:"https://www.youtube.com/channel/UCo2RGSbsI9GIxVvJPXanUuw/playlists",quick_intro_url:"help://intro",quick_intro_label:"Quick introduction to Pinegrow Web Editor",remote_url_help:"https://pinegrow.com/docs/master-pinegrow/edit-remote-websites-and-web-applications/",dyn_elements_help:"https://pinegrow.com/docs/master-pinegrow/working-with-dynamic-html-elements/"},whatsnew:{image:"images/whatsnew/pg5.1.jpg",right:`<p class="lead"></p>`,left:``,url:"https://pinegrow.com/release_notes/pinegrow-web-editor-5-95-april-1-2020/"},logo:"",logo_name:"Pinegrow",layout_prefix:"pgwp_",edit_page_code:!0,edit_css:!0,edit_server_side_scripts:!1,editor_sync:!1,edit_html:!0,edit_apps:!1,select_elements:!0,multi_win:!1,hide_panels:!0,multi_page_views:!0,version_url:"version_online.json",version:"1.0",default_port:4e4,use_server:!1,use_backups:!0,load_srcdoc:!0,stats_settings:!0,smart_blocks:pgIsDev(),clipboard:!0,settings:!0,auto_focus:!1,class_styles:!0,simple_element_menu:!0,whatsnew:!1,use_project_changes:!0,use_page_wrappers:!0,featured_projects:"global",empty_ph_attribute:"data-empty-placeholder",use_browser_storage:!1||pgwpdata?.use_browser_storage,your_projects_label:"Your projects",use_project_featured_images:!0,allow_php_files:!0,default_theme:"light",buy:{header:`Use your desktop Pinegrow Web Editor license to work with your local projects with Pinegrow Online.`},trial_activated_html:"<p>Your trial was activated. All features, including PRO, Interactions and WordPress builder, are enabled.</p><p>Please note that the commercial use of work that includes Pinegrow Interactions and is created in trial mode is not allowed.</p><p>And get in touch if you need a longer trial period.</p>",welcome_message:"Get quickly started with Pinegrow",settings_on_backend:!0,brand_dropdown_menu:!0,start_tab_learn:"Learn",start_tab_create:"Create",start_tab_learn_tooltip:"Learn how to use Pinegrow to build WordPress themes and blocks.",start_tab_create_tooltip:"Create WordPress themes, blocks and static HTML websites.",lesson_name:"tutorial lesson",no_projects_message:"You don't have any projects yet.",import_project_warning:`Only import projects from trusted sources. Uploading a project and opening it in the Pinegrow editor has the same security risk as installing a theme or a plugin on your site.`,wp_allow_export:!0,always_store_keys_in_local_storage:!1,use_filesystem_api:!1,project_destination:{server:{order:1,name:"WordPress Database",description:`Project will be saved in a WordPress database. You will be able to access it from anywhere.`}}},"online"===pgwpdata?.mode&&(pgf.product_name="Pinegrow Online",pgf.product_name_short="Pinegrow Online",pgf.product_url="https://pinegrow.online",pgf.buy_url="https://pinegrow.online/#waitinglist_mailer_id",pgf.manage_account=!0,pgf.allow_php_files=!1,pgf.user_avatar="pick_url",pgf.user_bio=!0,pgf.has_interactive_tutorials=!0,pgf.import_project_warning=`Only import projects from trusted sources.`,pgf.wp_allow_export=!1,pgf.always_store_keys_in_local_storage=!0,pgf.block_untrusted_js=!0,pgf.product_for_license="PG",pgf.allow_pg_license=!0,pgf.app_id_for_buy="PINEGROW",pgf.product_name_short_for_buy="Pinegrow Web Editor",pgf.no_trials=!0,pgf.require_valid_pg_license=!0,pgf.use_filesystem_api=!0,pgf.project_destination={local:{order:1,name:"Local folder",description:`Project will be saved in a folder on your computer. You will be able to access it on any device from where this folder is accessible. You will not be able to share the project through Pinegrow Online and to use auto-generated page thumbnails.`},server:{order:2,name:"Pinegrow Cloud",description:`Project will be saved on Pinegrow Online server. You will be able to access it from anywhere, share it with others and use auto-generated page thumbnails.`}});break;case"MAGIC":window.pgf={project_db:!1,components:!0,use_selectors:!1,open_url:!0,force_project:!1,save_html:!0,save_css:!0,product:"MAGIC",app_id:"PINEGROW",app_class:"pinegrow",product_name:"Pinegrow Web Editor",product_name_short:"Pinegrow Web Editor",product_url:"https://pinegrow.com",buy_url:"https://pinegrow.com/#buy",docs:{support_url:"https://pinegrow.com/support",help_url:"help://docs.index",shortcuts_url:"help://shortcuts",intro_video_url:"https://pinegrow.com/docs/getting-started/pinegrow-walkthrough-video/",intro_video_label:"Pinegrow Web Editor Walkthrough - Video",video_tutorials_url:"https://www.youtube.com/channel/UCo2RGSbsI9GIxVvJPXanUuw/playlists",quick_intro_url:"help://intro",quick_intro_label:"Quick introduction to Pinegrow Web Editor"},whatsnew:{image:"images/whatsnew/pg5.1.jpg",left:'<p class="lead">Improved Style editor, Components and Master pages. Plus, a healthy dose of  bug fixes.</p>',right:`
<ul>
<li>Duplicate media queries</li>
<li>Lock all stylesheet children</li>
<li>Map urls in Master pages and Components</li>
<li>Improved empty elements placeholders</li>
<li>Bug fixes</li>
</ul>

`,url:"https://pinegrow.com/release_notes/pinegrow-web-editor-5-7-july-31-2019/"},logo:"logo_e.png",layout_prefix:"magic_",edit_page_code:!0,edit_css:!0,edit_server_side_scripts:!0,editor_sync:!0,edit_html:!0,edit_apps:!1,select_elements:!0,multi_win:!0,hide_panels:!0,multi_page_views:!0,version_url:"version.json",version:"5.7",default_port:4e4,use_server:!0,use_backups:!0,stats_settings:!0,buy:{header:`Hi, there! Want to build your professional web projects visually?<br>Use Pinegrow to create smarter, faster and easier than ever before.`},trial_activated_html:'<p>Your trial was activated. All features, including PRO and WordPress builder, are enabled.</p><p>Check the <a href="https://pinegrow.com/support" class="external">Documentation</a> to see how Pinegrow can help you with your work and <a href="https://pinegrow.com/slack-invitation" class="external">join our community on Slack</a>.</p><p>And get in touch if you need a longer trial period.</p>',clipboard:!0,settings:!0};break;case"SNAP":window.pgf={project_db:!1,components:!1,use_selectors:!1,open_url:!1,force_project:!0,save_html:!1,save_css:!1,product:"SNAP",app_id:"SNAP",app_class:"snap",product_name:"Pinegrow Snapshots",product_name_short:"Pinegrow Snapshots",product_url:"https://pinegrow.com/snapshots",buy_url:"https://pinegrow.com/snapshots/#buy",docs:{support_url:"https://pinegrow.com/support",help_url:"https://pinegrow.com/docs/pinegrow-snapshots/",shortcuts_url:null,intro_video_url:null,intro_video_label:null,video_tutorials_url:null,quick_intro_url:null,quick_intro_label:null},whatsnew:!1,empty_recent_list_notice:"Project is a folder that contains snapshots. Start by selecting a folder where you'll store snapshots for your first project. You can have as many projects as you want.",logo:"logo_s.png",layout_prefix:"_snap",edit_page_code:!1,edit_css:!1,edit_server_side_scripts:!1,editor_sync:!1,edit_html:!1,edit_apps:!0,use_webview:!0,select_elements:!1,multi_win:!1,hide_panels:!1,multi_page_views:!1,version_url:"version_snap.json",version:"1.0",use_server:!1,use_backups:!1,default_port:40030,stats_settings:!1,buy:{header:`Use Pinegrow Snapshots to take static HTML snapshots of your dynamic web applications.`},trial_activated_html:"<p>Your trial was activated.</p>",simple_file_menu:!0,clipboard:!1,settings:!1};break;case"PGTC":window.pgf={project_db:!0,components:!1,use_selectors:!0,open_url:!1,force_project:!0,save_html:!0,save_css:!1,product:"PGTC",app_id:"PGTC",app_class:"pgtc",product_name:"Pinegrow Theme Converter for WordPress",product_name_short:"Pinegrow Theme Converter",product_url:"https://pinegrow.com/theme-converter-for-wordpress",buy_url:"https://pinegrow.com/theme-converter-for-wordpress/#buy",docs:{support_url:"https://pinegrow.com/support",help_url:"https://pinegrow.com/docs/wordpress/",shortcuts_url:null,quick_intro_url:"https://pinegrow.com/docs/wordpress/convert-html-to-wordpress-theme/",quick_intro_label:"Quick introduction to creating WordPress themes"},whatsnew:{image:"images/pgtc_splash.png",left:`<p>New in Pinegrow Theme Converter:</p><ul>
<li>Create custom WordPress blocks with the new Block smart action.</li>
<li>Conditionally enqueue scripts and styles.</li>
</ul>`,right:`<ul>
</ul>`,url:"https://pinegrow.com/release_notes/pinegrow-theme-converter-1-3-march-10-2020/"},empty_recent_list_notice:"Start by opening an existing HTML project that you wish to convert into a WordPress theme.",layout_prefix:"PGTC",logo:"logo_t.png",edit_page_code:!1,edit_css:!1,auto_focus:!1,copy_actions:!0,edit_server_side_scripts:!1,editor_sync:!1,edit_html:!1,edit_apps:!1,select_elements:!0,multi_win:!1,hide_panels:!0,multi_page_views:!1,version_url:"version_pgtc.json",version:"1.3",default_port:40010,use_server:!0,use_backups:!0,stats_settings:!1,buy:{header:`Hi, there! Creating WordPress themes has never been easier.<br>Use Pinegrow Theme Converter alongside your favorite design tools.`},trial_activated_html:'<p>Your Pinegrow Theme Converter trial was activated. All features are enabled.</p><p>Check out the <a href="https://pinegrow.com/docs/wordpress/" class="external">Documentation</a> to see how Pinegrow can help you with creating WordPress themes.</p><p>And get in touch if you need a longer trial.</p>',clipboard:!0,settings:!0}}var pgf_defaults={repeater:!0,use_focus:!0,default_emmet_setting:"false",all_lessons_done:`<p>Congratulations! You completed the last lesson.</p>`,all_lessons_done_button:"I'm amazing!",enable_fullscreen:!0,has_interactive_tutorials:!0},cache_is_app=($.each(pgf_defaults,function(e,t){e in pgf||(pgf[e]=t)}),null);function isApp(){return cache_is_app=null===cache_is_app?"undefined"!=typeof process&&process.versions&&"node-webkit"in process.versions:cache_is_app}function isAppForProject(e){return!(e=e||pinegrow.getCurrentProject())||!e.loaded_from_backend}var cache_is_dev=null;function pgIsDev(){return cache_is_dev=null===cache_is_dev?isApp()?window.pgDevVersion||!1:0<=location.href.indexOf("pinegrowplugindev")||0<=location.href.indexOf("pinegrowonline"):cache_is_dev}function pgIsLive(){return window.pgLive||!1}function pgIsMagic(){return"MAGIC"==window.pg_app}function pgGetApp(){return window.pg_app}var gen_id_count=1;function updateRuleIndices(e,t,n,o){var a,r;t&&e&&e.pgStylesheet&&e.pgStylesheet.getUniqueName()==t.stylesheet.getUniqueName()&&((a={pgStylesheet:t.stylesheet,node:t.node})["nodeIndices"]=pinegrow.pgPostCSSHelper.getNodeIndices(a.node),a["level"]=pinegrow.pgPostCSSHelper.getNodeLevelFromIndices(a["nodeIndices"]),a["currLevelIndex"]=parseInt(a.nodeIndices[a.level])||0,a["currParentLevelIndex"]=parseInt(a.nodeIndices[a.level-1])||0,(r={pgStylesheet:e.pgStylesheet,nodeIndices:e.nodeIndices,node:pinegrow.pgPostCSSHelper.getNodeByIndices(e.pgStylesheet.getRootNode(),e.nodeIndices),level:pinegrow.pgPostCSSHelper.getNodeLevelFromIndices(e.nodeIndices)})["currLevelIndex"]=parseInt(r.nodeIndices[a.level])||0,r["currParentLevelIndex"]=parseInt(r.nodeIndices[a.level-1])||0,a.nodeIndices.join(",")==r.nodeIndices.join(",")?"deleted"!=o||t.will_be_added||pinegrow.selectRule(null):a["level"]<=r["level"]&&a["currLevelIndex"]<=r["currLevelIndex"]&&a["currParentLevelIndex"]==r["currParentLevelIndex"]&&(e.nodeIndices[a.level]+=n))}function removeCrsaClasses(e){var t=e.attr("class");t&&(t=t.replace(/(^|\W)crsa\-[a-z\-]*/gi,""),e.attr("class",t))}function copyCodeToClipboard(e,t,n){if(t||(e=removeCrsaClassesFromHtml(e),e=pinegrow.formatHtml(e)),isApp())require("nw.gui").Clipboard.get().set(e,"text"),crsaQuickMessage(n||"Code copied to clipboard."),pinegrow.getClipboard().add(e);else if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){pinegrow.showQuickMessage("Copied to clipboard!")},function(e){pinegrow.showQuickError("Unable to copy to clipboard.")});else{var o=document.createElement("textarea");o.value=e,o.style.top="-200px",o.style.left="0",o.style.position="fixed",o.style.width="100px",o.style.height="100px",document.body.appendChild(o),o.focus(),o.select();try{document.execCommand("copy")?pinegrow.showQuickMessage(n||"Copied to clipboard!"):pinegrow.showQuickError("Unable to copy to clipboard.")}catch(e){pinegrow.showQuickError("Unable to copy to clipboard.")}document.body.removeChild(o)}}function removeCrsaClassesFromHtml(e){var t=/\s*crsa\-[a-z\-]*/g;return e=e.replace(/class=".*"/g,function(e){return e.replace(t,"")}).replace(/(<[^>]*?)\s*class\=['"]\s*['"]/gi,"$1"),e=pgf.empty_ph_attribute?e.replace(new RegExp("\\s"+escapeRegExp(pgf.empty_ph_attribute),"g"),""):e}function getIframeBody(e){var t=e.contentDocument;return t?t.body:null}function getIframeHtml(e){var t=e.contentDocument;return t?t.html:null}function getIframeDocument(e){return e.contentDocument}function getIframeOfElement(e){if(!pgf.use_webview)if(e&&0!=e.length)for(var t=e.get(0).ownerDocument,n=pinegrow.getAllPages(),o=0;o<n.length;o++)for(var a=n[o].getPageViews(),r=0;r<a.length;r++){var i=a[r].get$Iframe();if(getIframeDocument(i.get(0))==t)return i}return null}function getPageViewOfElement(e){if(e&&0!=e.length)for(var t=e.get(0).ownerDocument,n=pinegrow.getAllPages(),o=0;o<n.length;o++)for(var a=n[o].getPageViews(),r=0;r<a.length;r++)if(getIframeDocument(a[r].get$Iframe().get(0))==t)return a[r];return null}function getPageViewOf$Iframe(e){return e&&0!=e.length?getPageViewOfIframe(e.get(0)):null}function getPageViewOfIframe(e){if(e)for(var t=pinegrow.getAllPages(),n=0;n<t.length;n++)for(var o=t[n].getPageViews(),a=0;a<o.length;a++){var r=o[a].get$Iframe();if(r&&r.get(0)===e)return o[a]}return null}function getPageViewOfWindow(e){if(e)for(var t=pinegrow.getAllPages(),n=0;n<t.length;n++)for(var o=t[n].getPageViews(),a=0;a<o.length;a++){var r=o[a].get$Iframe();if(r&&r.get(0).contentWindow===e)return o[a]}return null}function getCrsaPageOfElement(e){var t=getIframeOfElement(e);return t?getCrsaPageForIframe(t):null}function shortenString(e,t,n,o){return void 0===n&&(n="&hellip;"),!e||e.length<=t?e:o?n+e.substr(e.length-t):e.substr(0,t)+n}function getObjectFromPgElement(e){return 0 instanceof pgParserNode,e?{type:"element",data:e}:null}function getObjectFromElement(e){return getObjectFromPgElement(getElementPgNode(e))}function getObjectFromRule(e){return{type:"rule",selector:e.selector,data:e}}function getUniqueIdFast(e){return(e=e||"crsa_fast_id_")+ ++gen_id_count}function getUniqueId(e,t,n){for(var o=0,a=(void 0!==n&&(n=""+n,o=parseInt(n.replace(/[a-z]*/i,""))),(t=t||pinegrow.getSelectedPage())?t.get$Html():null),r=(e=e||"crsa_id_",n?o:gen_id_count);1;){var i=e+ ++r;if(a){if(0==a.find("#"+i).length)return n||(gen_id_count=r),i}else if(0==$("#"+i).length)return n||(gen_id_count=r),i}}function getClosestCrsaElement(e){for(var t=getElementPgNode(e);e&&0<e.length&&null===t;)e=e.parent(),t=getElementPgNode(e);return t?e:$()}function getType(e,t,n,o,a){void 0===t&&(t=!1);var r=null;if(!e&&a)$.each(o.getComponentTypes(),function(e,t){var n=!1;return!!t.not_main_type||(t.selector_tag?n=a.tagName===t.selector_tag:"function"!=typeof t.selector&&t.selector&&(n=a.isSelector(t.selector)),!n)||(r=t,!1)});else{if(!t){if(r=e.data("crsa-def"))return r;if(!1===r)return null}if(n)return null;if(a=a||getElementPgNode(e),!(o=o||getCrsaPageForIframe(getIframeOfElement(e))))return null;(r=o.getMainType(e,a,!0,!1))&&e.data("crsa-def",null!==r&&r)}return r}function getElementName(e,t,n,o,a,r,i,s){var l=e.get(0);if(!e||!l)return t?t.name:"Element";if(t||(s=s||getCrsaPageOfElement(e),c=getElementPgNode(e),t=s&&c?s.getMainType(null,c):null),!t)return l.tagName+"";var c=null;if(t.display_name&&"function"==typeof t.display_name)c=t.display_name(e,t);else{if(a){var p,d="",g=!1;if("META"==l.tagName?(f=l.getAttribute("name"),p=l.getAttribute("content"),f?d=f+'="'+(p||"")+'"':l.attributes.length&&(d=l.attributes[0].nodeName+'="'+l.attributes[0].nodeValue+'"'),g=!0):"LINK"==l.tagName?(d=pinegrow.getOriginalUrl(l.getAttribute("href")||""),g=!0):"SCRIPT"==l.tagName&&((f=l.getAttribute("src"))?(d=pinegrow.getOriginalUrl(f),g=!0):d=l.innerText||""),!g)for(var u=0;u<l.childNodes.length;u++)if(3==l.childNodes[u].nodeType&&(d+=$.trim(l.childNodes[u].textContent)).length){d=d.substring(0,30);break}d.length&&(d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}c=t.name,t.get_name&&(c=t.get_name(e,t)),"HTML"==l.tagName&&s?c=s.name:(p=l.nodeName.toLowerCase(),r||"tag"==t.display_name?c=p:r&&c.toLowerCase()!=p&&(c+=" ("+p+")"));var f=l.getAttribute("data-pg-name"),g=(f&&(c=f),l.getAttribute("id"));if(g&&(c+=n?'<span class="name-id">'+"#"+escapeHtmlCode(g)+"</span>":"#"+escapeHtmlCode(g)),o){var h=0,m=null,w="",_=pgGetElementClasses(l);if(0<_.length){for(var v=0;v<_.length;v++){h++;var b=escapeHtmlCode(_[v]);1===h&&(m=b),w+="."+b}0<h&&(c+=n?'<span class="name-text"'+(1<h?' title="'+w+'"':"")+">"+"."+m+(1<h?"...":"")+"</span>":"."+m+(1<h?"...":""))}}i&&(c=c+" | "+(n?'<span class="name-at">'+i+"</span>":i)),d&&(c=c+" | "+(n?'<span class="name-text">'+d+"</span>":d))}return c}function isInDOMTree(e){return!!findUltimateAncestor(e).body}function findUltimateAncestor(e){for(var t=e;t.parentNode;)t=t.parentNode;return t}function crsaChooseFile(o,e,a,t,n){var r=$('<input style="display:none;" type="file"/>').appendTo($("body")),i=(a&&r.attr("multiple",""),!1);t||(t=pinegrow.getWorkingDir(),i=!0),t&&(e&&"string"!=typeof e&&(e="index.html"),r.attr("nwworkingdir",t)),n&&r.attr("nwdirectory",""),e?r.attr("nwsaveas",e):r.removeAttr("nwsaveas"),r.on("change",function(e){var t=$(this).val(),n=a?t:crsaMakeUrlFromFile(t);t&&0<t.length&&(!a&&i&&pinegrow.setWorkingDir(require("path").dirname(t)),o(n,t)),r.remove()}),r.trigger("click")}function crsaGetObjectParentUrl(e,t){if(e){var n,o;if(e instanceof pgParserNode)return(o=e.getPage())?o.mappedRemote?(t&&(t.mappedBaseUrl=crsaMakeUrlFromFile(pinegrow.getMappedRemoteBaseDirForUrl(o.url))),crsaMakeUrlFromFile(o.localFile)):o.url:null;if("rule"==e.type)return(n=pgStylesheetHelper.getStylesheetFromNode(e.data)).mappedRemote?(t&&(t.mappedBaseUrl=crsaMakeUrlFromFile(pinegrow.getMappedRemoteBaseDirForUrl(n.url))),crsaMakeUrlFromFile(n.localFile)):n.url;if("stylesheet"==e.type)return e.data.url;if(e.pgStylesheet)return e.pgStylesheet.elementStyle?pinegrow.getSelectedPage().url:e.pgStylesheet.inline?(o=e.pgStylesheet.inlineSheetPgel.getPage()).url:e.pgStylesheet.mappedRemote?(t&&(t.mappedBaseUrl=crsaMakeUrlFromFile(pinegrow.getMappedRemoteBaseDirForUrl(e.pgStylesheet.url))),crsaMakeUrlFromFile(e.pgStylesheet.localFile)):e.pgStylesheet.url}return null}function crsaGetVersion(){return(!isApp()&&pgwpdata.version?pgwpdata:pgf).version}function crsaCheckForNewVersion(t,n){var e=`https://pinegrow.com/${pgf.version_url}?z=`+(new Date).getTime();$.ajax({url:e,data:null,dataType:"json"}).done(function(e){n&&n(e),e.version&&parseFloat(e.version)>parseFloat(crsaGetVersion())?t(e):t(null)}).fail(function(){t(null)})}function crsaGetVersionName(){var e=crsaGetVersion();return isApp()?(isApp()&&crsaIsBig()&&(e+=" - "+pinegrow.getProductName()),pg_is_beta&&(e+=" "+pg_is_beta),e):``+e+(pgwpdata?.beta?" BETA":"")}function crsaIsBig(){return isApp()?0:1}function crsaIsEmailActivated(){if(isApp()&&crsaIsBig())return!0}window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame,function(fe){fe.fn.crsa=function(e){return he[e]?he[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void fe.error("Method "+e+" does not exist on jQuery.crsa"):he.init.apply(this,arguments)};var T,Z,I,A,e=null,W=null,x=null,ve=!1,be=null,M=null,J=!1,D=null,O=null,F=null,L=null,t=null,y=!1,X=(new Date).getTime(),ye=(window.pg_is_beta=!1,window.pg_use_ops=!0,window.is_mac=!1,window.is_windows=!1,window.is_windows_64=!1,window.is_linux=!1,window.is_mac_browser=!1,isApp()?(0<=navigator.platform.indexOf("Win")&&(is_windows=!0,isApp())&&process&&(is_windows_64="x64"===process.arch),0<=navigator.platform.indexOf("Mac")&&(is_mac=!0),0<=navigator.platform.indexOf("Linux")&&(is_linux=!0)):(is_mac=!0,is_mac_browser=0<=navigator.platform.indexOf("Mac")),"__EMPTY__"),ee=!0,r=null,N=!1,c=null,$=fe("body"),j=[],H=null,te=null,g=null,R=null,U=null,p=0,d=0,he={init:function(e){isApp()?(i=require("nw.gui"),process.on("uncaughtException",function(e){var t;e instanceof PgEditException?(t=pinegrow.showAlert(e.msg,e.reason),e.on_display&&e.on_display(t)):(console.log("node exception "+e),"undefined"!=typeof Sentry&&Sentry.captureException(e))}),i.App.dataPath,fe.each(i.App.argv,function(e,t){0<=t.indexOf("--pg-home-dir")&&(t.replace("--pg-home-dir=",""),console.log("Nice, I'm a Mac App!"))})):(console.log("Running as web app..."),document.addEventListener("dragstart",Ce,!0)),T=fe.extend({},fe.fn.crsa.defaults,e),R=T.custom_logic||new PgCustomLogic,T.templates&&fe.each(T.templates,function(e,t){var n=new CrsaProject;n.fromSimpleTemplate(t),j.push(n)}),fe("body").on("mouseover",".tooltip",function(e){fe(this).remove()}),pgf.multi_win||fe("body").addClass("disable-mw"),re(),updateProductInfoIn$Element(fe("body")),window.buttonToolbarTopCenter=new PgButtonToolbar,buttonToolbarTopCenter.$element.addClass("commands-toolbar"),buttonToolbarTopCenter.hide(),buttonToolbarTopCenter.customReposition=function(){buttonToolbarTopCenter.$element.css({width:"auto"});var e=buttonToolbarTopCenter.$element.outerWidth();buttonToolbarTopCenter.$element.css({width:e,left:"50%",marginLeft:-(e/2)})};var t=new PgButtonToolbar,n=(pgf.kids||(t.addSection("help"),t.addSection("trial")),pgf.kids,t.$element.addClass("right-toolbar"),new PgButtonToolbarItem("<span>Check license</span>","Check the validity of your license and if needed, renew it to continue using new version of Pinegrow.")),n=(isApp()&&t.addItem("trial",n),n.onClick=function(){Ae(function(e,t){})},pgf.docs.help_url&&(n=new PgButtonToolbarItem("icon-271","Help"),t.addItem("help",n),n.onClick=function(){pgf.docs.help_url.startsWith("help:")?pinegrow.showDocsTopic():pinegrow.openExternalUrl(pgf.docs.help_url)}),fe("#crsa-topbar").append(buttonToolbarTopCenter.$element).append(t.$element),$trial=fe("#crsa-topbar .trial"),isApp()&&$trial.hide(),window.pinegrow=new Pinegrow,window.pgStylesheetHelper=PgStylesheetHelper(),pinegrow.getSetting("proxy-config",null));if(n&&((i=require("nw.gui")).App.setProxyConfig(n),pinegrow.showQuickMessage("Using proxy server for network access as configured in Settings.")),pinegrow.autoFormatHtml="1"==pinegrow.getSetting("format-html","1"),pinegrow.autoFormatCss=pinegrow.getSetting("format-css","default"),pgf.auto_text_edit_done="1"==pinegrow.getSetting("auto-text-edit-done","1"),pinegrow.getActivatedProducts=function(){var e=crsaStorage.getValue("activatedProduct"),t=crsaStorage.getValue("addons")||"",n=[];return e&&("PGTC"===e?(n.push("PGTC"),n.push("PRO"),n.push("WP")):"SNAP"===e?(n.push("PGTC"),n.push("PRO")):(n.push("PG"),0==e.indexOf("PGWP")&&(n.push("WP"),n.push("PRO")),0<=e.indexOf("PRO")&&n.push("PRO"),(0<=e.indexOf("_IA")||0<=t.indexOf("_PGIA"))&&n.push("IA"),(0<=e.indexOf("_TW")||0<=t.indexOf("_TW"))&&n.push("TW"),(0<=e.indexOf("_WC")||0<=t.indexOf("_WC"))&&n.push("WC"))),n},pinegrow.hasActivatedProduct=function(e){return!isApp()&&!pinegrow.currentUser.isPGUser()||0<=this.getActivatedProducts().indexOf(e)},pinegrow.getProductName=function(e){var t="Unknown";switch((e=e||crsaStorage.getValue("activatedProduct")).replace("_IA","").replace("_TW","").replace("_WC","")){case"PG_PERSONAL":t="Standard Personal";break;case"PG_COMPANY":t="Standard Company";break;case"PG_STUDENT":t="Standard Student";break;case"PGPRO_PERSONAL":t="PRO Personal";break;case"PGPRO_COMPANY":t="PRO Company";break;case"PGPRO_STUDENT":t="PRO Student";break;case"PGWP_PERSONAL":t="Standard WordPress Personal";break;case"PGWP_COMPANY":t="Standard WordPress Company";break;case"PGWP_STUDENT":t="Standard WordPress Student";break;case"PGWPPRO_PERSONAL":t="PRO WordPress Personal";break;case"PGWPPRO_COMPANY":t="PRO WordPress Company";break;case"PGWPPRO_STUDENT":t="PRO WordPress Student";break;case"PGPRO_CMSUSER":t="PRO CMS Client";break;case"SNAP":t="Snapshots";break;case"PGTC":t="Theme Converter"}return pinegrow.hasActivatedProduct("IA")&&(t+=" + Interactions"),pinegrow.hasActivatedProduct("TW")&&(t+=" + Tailwind"),pinegrow.hasActivatedProduct("WC")&&(t+=" + WooCommerce"),t},pinegrow.isProductTrialActive=function(e,t,n,o){var a,r,i;return!(pinegrow.hasActivatedProduct(e)||(a=7*24*3600*1e3,r=e+"_"+crsaGetVersion()+"_trial_start_date",(i=crsaStorage.getValue(r))||(i=(new Date).getTime(),crsaStorage.setValue(r,i),o)||pinegrow.showAlert(t,e+" trial started"),(new Date).getTime()+0*(a+1)-i>a&&(i=r+"_exp_notice_shown",crsaStorage.getValue(i)||(crsaStorage.setValue(i,!0),pinegrow.showAlert(n,e+" trial ended","Close","Upgrade",null,function(){e&&pinegrow.showBuyProductScreen(e)})),1)))},pinegrow.showProductUpgradeMessage=function(e,t,n){if(pinegrow.hasActivatedProduct(e))return!1;pinegrow.showAlert(n,t+" is not available in your edition of Pinegrow","Close","Upgrade",null,function(){e&&pinegrow.showBuyProductScreen(e)})},pinegrow.isTrial=function(){return!crsaIsBig()},pinegrow.isProTrialActive=function(){return pinegrow.isTrial()},pinegrow.isPRO=function(){return pinegrow.hasActivatedProduct("PRO")||!isApp()},pinegrow.isContributorMode()&&(fe("#crsa-left-plane > .nav-tabs li:nth-child(3)").hide(),fe("#tab4").hide(),fe("#crsa-left-plane > .nav-tabs li:nth-child(4)").hide(),fe("#tab5").hide(),fe("#crsa-left-plane > .nav-tabs li:nth-child(5)").hide(),fe("#tab2").hide()),pinegrow.pro_info_url="https://pinegrow.com/docs/pinegrow-pro/",pinegrow.pro_upgrade_url="https://pinegrow.com/upgrade-to-wp.html",(W=new CrsaCodeEdit).setFontSize(pinegrow.getSetting("code-size","12px"),pinegrow.getSetting("code-font","")),pinegrow.codeEditor=W,window.pgLibraryLastUsed=new PgLibraryLastUsed,pinegrow.repeater=new PgRepeater,pinegrow.panelManager=new PgPanelManager,pinegrow.selectedElements=new PgSelectedElements,pinegrow.changeManager=new PgChangeManager,pinegrow.undoManager=new PgUndoManager,pinegrow.actionsToPgelMap=new PgActionsToPgelMap,pinegrow.keyState=new PgKeyState(is_mac?"mac":is_windows?"win":"linux"),pinegrow.mousePosition=new PgMousePosition,pinegrow.inlineEditManager=new PgInlineEditorManager,pinegrow.helpersToolbarItem=new PgButtonToolbarItemWithDropdown("icon-Pin13",pgf.kids?"Switch the selected element menu on and off.":"Toggle visual helpers "+pgShowKbdCombo("CMD+T")+'<br>Use Right-click or <i class="icon icon-down"></i> to configure.',null,!0),pinegrow.helpersToolbarItem.toolbarItem.onClick=function(){var e=!pinegrow.getShowDisplayHelpers();pinegrow.setShowDisplayHelpers(e,!0)},pinegrow.setShowDisplayHelpers(!0),pinegrow.lastActivePage=new PgLastActivePage,pinegrow.pageLibManager=new PgPageLibManager,pinegrow.thumbnailMaker=new PgThumbnailMaker,pinegrow.focusRect=new PgFocusRect,pinegrow.paintToolManager=new PgPaintToolManager,pinegrow.floatingToolsManager=new PgFloatingToolsManager,pinegrow.focusRect=new PgFocusRect,U=new pgRecentFiles,pinegrow.recentFiles=U,pinegrow.startScreenManager=new PgStartScreenManager,pgf.use_server||pinegrow.recentFiles.update(),pinegrow.recentClasses=new PgRecentClasses,pinegrow.setWorkspaceTheme(pinegrow.getWorkspaceTheme()),pinegrow.focusBar=new PgFocusBar,pinegrow.buttonToolbarTopCenter=buttonToolbarTopCenter,pinegrow.devTools=new PgChromeDevTools,pinegrow.backend=new PgBackend(isApp()?new PgBackendProviderLocal:null),pinegrow.currentUser=new PgCurrentUser,isApp()||(pinegrow.browserPreview=new PgBrowserPreview),pinegrow.fontLibrary=new PgFontTypeLibrary,"undefined"!=typeof PgBrowserSync&&(pinegrow.browserSync=new PgBrowserSync),"undefined"!=typeof PgTutorialsManager&&(pinegrow.tutorialsManager=new PgTutorialsManager),pinegrow.classNamedStates=new PgClassNamedCustomStates,pinegrow.useSmartInsert="1"===pinegrow.getSetting("ai-smart-insert","0"),isApp())try{A=new CrsaHttpServer(function(e,t,n){console.log("Internal server status: "+e),"OK"!=e?pinegrow.showAlert("<p>Ups... we have a problem! <b>Pinegrow was unable to start its internal webserver</b>. The server is <b>required</b> for Pinegrow to function correctly.</p><p>This is just a small technical issue. Let's fix it so that you can enjoy Pinegrow! Details about the problem:</p><p><b>"+e+"</b> "+(t||"")+'</p><p>Check Settings for internal web server and network proxy.</p><p>If this doesn\'t help please check the <a class="external" href="https://pinegrow.com/misc/troubleshooting">troubleshooting docs</a> or <a class="external" href="https://pinegrow.com/#contact">contact support</a>.</p>',"Pinegrow can't function without its internal webserver"):(pinegrow.apiServer=new PgApiServer(n.port+1),pinegrow.dispatchEvent("on_api_server_created",pinegrow.apiServer))}),pinegrow.httpServer=A,console.log("Internal http server running on "+A.url)}catch(e){console.log("Could not start internal http server: "+e)}fe("body").trigger("pinegrow-register-addons"),pinegrow.actionsManager=new PgActionsManager,fe("body").trigger("pinegrow-ready",pinegrow),pinegrow.tutorialsManager&&pinegrow.tutorialsManager.registerTutorials(),pinegrow.ready=!0,pinegrow.actionsManager.init(),testGoldenLayout(),pgf.kids&&fe(".lm_tab[draggable],.lm_handle[draggable]").removeAttr("draggable"),fe("body").trigger("pinegrow-layout-ready",pinegrow);var o,a,r,i,s,l,c,p,d,g,u,f,h,m,w,_,v,b,y,P,k,C,S,E=fe("#layout-container"),t=(E.on("transitionend",function(e){e.target===E.get(0)&&fe(window).trigger("resize")}),pinegrow.connectors=new PgConnectors,isApp()&&pinegrow.loadAllFrameworksFromFile(),crsaAddKbd(fe(".menu-file-open-file"),"CMD O"),crsaAddKbd(fe(".menu-file-save"),"CMD S"),crsaAddKbd(fe(".menu-file-save-as"),"SHIFT CMD S"),crsaAddKbd(fe("#crsa-undo"),"CMD Z"),crsaAddKbd(fe("#crsa-redo"),"SHIFT CMD Z"),is_windows||crsaAddKbd(fe(".menu-file-save-all"),"ALT CMD S"),crsaAddKbd(fe(".menu-file-close"),"CMD SHIFT W"),crsaAddKbd(fe(".menu-find-replace"),"CMD F"),isApp()?(fe(".menu-project-divider").remove(),fe(".menu-file-save-project").remove(),fe(".menu-file-load-project").remove(),fe(".menu-file-download").remove(),crsaIsBig()&&!pinegrow.isContributorMode()||(fe(".menu-dev-tools").remove(),fe(".menu-file-manage-ss").remove()),crsaIsBig()||"PG"!==pgf.product||(n=new PgTrialUpgradeBox,t.addItem("info",n.button)),pgf.edit_html||(fe(".menu-file-template").remove(),fe(".menu-file-load-project-lib").remove(),fe(".menu-file-save-html").remove(),fe(".menu-file-save-as").remove(),fe(".menu-file-manage-ss").remove(),fe(".menu-support-api").remove(),fe(".menu-atom").remove()),pgf.force_project&&(fe(".menu-file-open-file").remove(),fe(".menu-file-close-all").remove()),pgf.open_url||fe(".menu-file-open-url").remove(),(pinegrow.isContributorMode()?fe(".remove-in-cm"):(o=null,fe(".remove-in-not-cm"))).remove(),pgIsLive()&&((a=new PgButtonToolbarItem(`<span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-broadcast" viewBox="0 0 16 16">
  <path d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 1 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.313.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM10 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"/>
</svg></span>`,"You are using Pinegrow Live. Click for update log.")).$element.addClass("live-button"),t.addItem("info",a),a.onClick=function(){a.has_live_update?new CrsaContextMenu([{label:"See what's new",action:function(){pinegrow.openExternalUrl("https://pinegrow.com/download/pinegrow-live/pinegrow-live-update-log/")}},{label:"Restart Pinegrow",action:function(){pinegrow.restartPinegrow()}},{label:"Open Live dashboard",action:function(){pinegrow.liveBuild.showLog()}}],a.$element).showForElement(a.$element,null,8):pinegrow.liveBuild.showLog()}),(r=function(){crsaCheckForNewVersion(function(e){var t,n=fe(".version-info");e?(n.html("").show(),n.append("<h4>An update is available</h4>"),n.append("<p>"+e.desc+"</p>"),n.append('<p><a class="" href="'+e.url+'">Learn more &amp; download</a></p>'),n.find("a").on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)}),n=fe("#crsa-topbar .trial li"),t=fe('<a href="https://pinegrow.com" data-toggle="tooltip" data-placement="bottom" title="'+e.desc+'" target="_blank">Update is available for download</a>'),n.html(""),n.append(t),n.parent().show(),addTooltip(t),t.on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)})):n.hide()},function(e){var t;o&&o.setData(e.news||null),pinegrow.liveBuild&&(t=parseFloat(e.live_version||0),pinegrow.liveBuild.getLiveVersion()<t)&&(a.setActive(!0),a.has_live_update||pinegrow.showAlert(`<p>The latest Pinegrow Live update is available. Restart Pinegrow to update.</p>`,"Pinegrow Live update is available","Learn more","Close",function(){pinegrow.openExternalUrl("https://pinegrow.com/download/pinegrow-live/pinegrow-live-update-log/")}),a.has_live_update=!0,a.setTooltip("Pinegrow Live update is available. Restart Pinegrow to update. Click for details."))})})(),setInterval(function(){r()},1e3*60*60),"darwin"==process.platform&&((n=new(i=require("nw.gui")).Menu({type:"menubar"})).createMacBuiltin("Pinegrow"),(t=new i.MenuItem({label:"Zoom"})).click=function(){i.Window.get().maximize()},n.items[2].submenu.insert(t,1),n.items[1].submenu.removeAt(0),n.items[1].submenu.removeAt(0),n.items[1].submenu.removeAt(0),i.Window.get().menu=n),i=require("nw.gui"),fe(".main-menu > .dropdown").on("show.bs.dropdown",function(){pgCloseContextMenus()}),fe("#main-navbar").on("mouseenter",".main-menu > li > a.dropdown-toggle,.main-menu > li > a.aadropdown-toggle",function(e){fe(".main-menu li.open").length&&!this.parentNode.classList.contains("open")&&fe(this).trigger("click")}),new PgDropdownMenu(fe(".menu-page")).onGetActions=pgGetActionsForPageMenu,m=new PgWindowMenu,new pgWindowManager(i.Window.get(),"main",function(e){e.maximize()}),(s=i.Window.get()).setMaxListeners&&s.setMaxListeners(0),"PG"!==pgf.product?s.title=pgf.product_name:s.title=pgf.product_name+(pinegrow.hasActivatedProduct("WP")?" - WP":""),setUIZoom(pinegrow.getSetting("ui-zoom","0")),l=function(){return parseInt(((new Date).getTime()-X)/1e3)},c=function(e){pinegrow.stats.event("app.close",l(),!0);function t(){pinegrow.showQuickMessage("Shutting down... See you soon!"),pinegrow.appIsShuttingDown=!0,setTimeout(function(){pinegrow.getAllPages().forEach(function(e){e.allowReload=!0}),pinegrow.closeAllPages(null,!0,!0),setTimeout(function(){pinegrow.httpServer.destroy(function(){pinegrow.stats.send(function(){pgGetAppWindows().forEach(function(e){e.close(!0)})})})},500)},100)}crsaIsBig()?t():(crsaTrialSendUseCount(!0),setTimeout(t,100))},s.on("close",function(e,t,n){document.activeElement&&"IFRAME"==document.activeElement.nodeName&&pinegrow.keyState.cmdCtrl||(crsaHasChanges()?showAlert("One or more pages or component libraries (see File -> Manage libraries and plugins) have unsaved changes. Are you sure you want to quit the app?","Unsaved changes","Don't quit","Quit",null,function(){c()}):c())}),fe(".menu-file-quit").on("click",function(e){e.preventDefault(),s.close()})):(fe(".menu-file-save").remove(),fe(".menu-file-save-html").remove(),fe(".menu-file-save-as").remove(),fe(".menu-file-save-all").remove(),fe(".menu-file-cache").remove(),fe(".menu-save-divider").remove(),fe(".menu-file-new-window").remove(),fe(".menu-dev-tools").remove(),window.onbeforeunload=function(e){return crsaHasChanges()?"Some of the pages and stylesheets are changed. Changes will be lost if you leave this page.":null}),M=this.find(".canvas"),I=new pgPageTabs(M),pinegrow.pageTabs=I,pinegrow.stylesheets=new window.PgAllStylesheets,pinegrow.pgPostCSSHelper=window.pgcssh=window.PgPostCSSHelper(),pinegrow.pgCSSFormatting=window.pgcssf=new PgStylesheetFormatting,pinegrow.pgActiveRules=new PgActiveRules,pinegrow.pgGoogleFontManager=new PgGoogleFontManager,pinegrow.pgGoogleFontManager.init(),Z=fe("#crsa-rule-edit"),0);navigator.userAgent.match(/Safari|Firefox|Chrome|Chromium/i)&&(t=2),0==(t=navigator.userAgent.match(/Mobile/i)?0:t)&&pinegrow.showAlert(`<p>${pgf.product_name} works in browsers such as Chrome, Firefox and Safari, on desktop computers and laptops.</p><p>Using it on mobile devices and tablets, or in other browsers is not recommended at the moment.</p><p>Sorry about this, we are working on supporting tablet devices.</p>`,"Unsupported browser or device",null,"OK"),1&&(pinegrow.sourceParser,is_windows?fe("body").addClass("win"):is_mac&&fe("body").addClass("osx"),isApp()&&fe("body").addClass("app"),fe("body").addClass(pgf.app_class),"#wp-frame"===window.location.hash?(fe("body").addClass("in-wp-iframe"),window.pgIsEmbeded=function(){return!0}):window.pgIsEmbeded=function(){return!1},fe("body").crsastorage(),fe("div.canvas").crsapages(),M.crsacss(),ie(),fe.each(T.pages,function(e,t){he.openPage(t.src)}),0==T.pages.length&&isApp()&&!crsaIsBig()?setTimeout(function(){crsaIsEmailActivated()&&parseFloat(crsaStorage.getValue("trialVersion")),crsaIsEmailActivated()?crsaCheckTrial(function(e,t){t&&pinegrow.showAlert(t),showIntroScreen()}):setTimeout(function(){showIntroScreen()},1e3)},10):Te(),p=function(e){function n(){var e=crsaMakeFileFromUrl(o[a]),t=crsaMakeUrlFromFile(e);"dir"===crsaIsFileOrDir(e)?pinegrow.getCurrentProject()?pinegrow.showQuickError("Close the current project first."):pinegrow.openProject(e):(pinegrow.openOrShowPage(t,function(){++a<o.length&&n()}),U.add(t))}var o=e,a=0;0<o.length&&n()},isApp()&&(window.ondragover=function(e){return e.preventDefault(),!1},window.ondrop=function(e){return e.preventDefault(),!1},(n=fe("body").get(0)).ondragover=function(){return!1},n.ondragend=function(){return!1},n.ondrop=function(e){e.preventDefault();var t=[];if(e.dataTransfer.files){for(var n=0;n<e.dataTransfer.files.length;++n)t.push(e.dataTransfer.files[n].path);p(t)}return!1},i.App.on("open",function(e){console.log("command line: "+e),setTimeout(function(){p([e])},200)}),d=[],fe.each(i.App.argv,function(e,t){0!=t.indexOf("--")&&d.push(t)}),d.length&&setTimeout(function(){p(d)},200),window.mixpanel=!1,t=parseInt(localStorage.app_run||"0")+1,localStorage.app_run=t,pinegrow.stats.event("app.start",null,!0)),fe(".dropdown").on("shown.bs.dropdown",function(e){var t=fe(e.target).find("> ul");t.css("height","auto"),t.height()+t.offset().top>fe(window).height()&&t.css("height",fe(window).height()-t.offset().top-10)}),pinegrow.selectAndOpenFile=function(){crsaChooseFile(function(e,t){p(t.split(";"))},null,!0)},fe(".menu-file-open-file").on("click",function(e){e.preventDefault(),gaSendPageView("FileOpen"),isApp()?(pinegrow.selectAndOpenFile(),pinegrow.stats.using("app.openfile")):le('<div class="alert alert-info">Use <b>File - New page</b> to add a page to your project. Or download Pinegrow desktop app to open your local files.</div>',"to open your files")}),fe(".menu-file-open-url").on("click",function(e){e.preventDefault(),gaSendPageView("FileOpenUrl"),isApp()?(pinegrow.showOpenUrlDialogAndOpenPage(),pinegrow.stats.using("app.openurl")):le('<div class="alert alert-info">Use <b>File - New page</b> to add a page to your project. Or download Pinegrow desktop app to open files from the Internet.</div>',"to open remote files")}),fe(".menu-find-replace").on("click",function(e){e.preventDefault(),pinegrow.openFindAndReplace()}),g=pinegrow.newProjectFromTemplate=function(){var o,e;j&&((H=new CrsaProjectBrowser).title="Create a new page or project",H.intro="<p>Choose what framework you wish to use, then select a template:</p>",H.setProjects(j),H.selectedProject=te,(o=pinegrow.getCurrentProject())&&(e=o.getSettingsForNewFileDialog(),H.setProjects(e.projects)),H.onFileSelected=function(t,n){var e;o&&o.master_page?o.createFromMasterPage(o.getUrl(),t,n):(e=crsaIsAbsoluteUrl(t.url)?t.url:crsaGetBaseForUrl(window.location.href)+"/"+t.url,he.openPage(e,null,function(e){e.crsaProjectTemplate=n,e.pageIsRemoteTemplate=crsaIsRemoteUrl(t.url)||n.framework.page_is_remote_template||!1,te=n,e.source_framework=n.framework},null,null,{on_source_parsed:function(e){t.remove_components&&e.sourceNode.withoutEvents(function(){e.sourceNode.removeAttrIfStartsWith("data-pgc",!0)}),t.remove_local_links&&e.sourceNode.withoutEvents(function(){e.sourceNode.goThroughAllUrls(function(e,t){return"href"===t&&e.endsWith(".html")&&!crsaIsAbsoluteUrl(e)?"#":e})})}}))},H.show())},fe(".menu-file-template").on("click",function(e){e.preventDefault(),gaSendPageView("FileOpenTemplate"),isApp(),g(),pinegrow.stats.using("app.newfile")}),window.canOpenProject=function(){return!(!pinegrow.isProTrialActive()&&!pinegrow.isPRO()&&(pinegrow.showAlert('<p>Projects, master pages and components are available in <b>Pinegrow PRO edition</b>.</p><p>The PRO edition is great for efficiently editing multi-page websites. <a href="'+pinegrow.pro_info_url+'" class="external">Learn more »</a></p>',"Projects are a part of Pinegrow PRO edition","Close","Upgrade",null,function(){var e=require("nw.gui"),t=pinegrow.pro_upgrade_url;e.Shell.openExternal(t)}),1))},fe(".menu-file-open-project").on("click",function(e){e.preventDefault(),pinegrow.openProjectBySelectingFolder()}),pinegrow.openProjectInNewWindow=function(e){localStorage.openProjectOnLoad=e,i.Window.open(window.location.href,{},function(e){})},fe(".menu-file-open-project-win").on("click",function(e){e.preventDefault(),canOpenProject()&&crsaChooseFile(function(e,t){pinegrow.openProjectInNewWindow(t)},!1,!1,null,!0),pinegrow.stats.using("app.openprojectnewwin")}),fe(".menu-file-load-project-lib").on("click",function(e){e.preventDefault(),pinegrow.selectAndLoadLibrary(function(e,t){}),pinegrow.stats.using("app.loadprojectlib")}),u=function(){"1"==pinegrow.getSetting("backup","1")&&showNotice("<p>When you save a file Pinegrow saves a <b>backup copy of the original file</b> into the _pgbackup folder, located in the same location as the saved file. A current timestamp is appended to the backup file name.</p><p>This feature is useful when you are still experimenting with Pinegrow and want to make sure that you don't accidentally corrupt your source files in case Pinegrow can't handle them correctly (like templates, PHP, JSP...). But this can create a lot of backup files.</p><p>You can <b>disable backups</b> in <b>Support -&gt; Settings</b>.</p>","About file backups","save-backup")},f=function(e){var t,n;U.add(e.url),!pinegrow.isPRO()&&!pinegrow.isProTrialActive()||pinegrow.getCurrentProject()||(n=require("path"),t=n.dirname(e.localFile),n=n.basename(t),pinegrow.showAlert("<p>Would you like to open folder <b>"+n+"</b> as a project?</p>","Open project?","No","Yes",null,function(){pinegrow.openProject(t,e)}))},fe(".menu-file-save").on("click",function(e){e.preventDefault();var t,n,o=pinegrow.lastActivePage.getPage();o&&o.onlyCode?o.save():o&&(isApp()?Y(t=o)&&(W&&W.refreshBeforeSaveIfNeeded(),n=null==(t=t.live_update&&t.save_parent?t.live_update:t).localFile,t.save(function(e){e||n&&f(t)},!0,!0),u()):le('<div class="alert alert-info">Use <b>File - Download your project</b> to download a Zip file with your project.</div>',"to save files"))}),fe(".menu-file-save-as").on("click",function(e){var t,n;e.preventDefault(),x&&Y(t=x)&&(W&&W.refreshBeforeSaveIfNeeded(),n=null==t.localFile,t.save(function(e){e||(U.add(t.url),I.updateDisplay(),n&&f(t))},!0,!0,!0),u())}),fe(".menu-file-save-html").on("click",function(e){var t;e.preventDefault(),x&&Y(t=x)&&(W&&W.refreshBeforeSaveIfNeeded(),(t=t.live_update&&t.save_parent?t.live_update:t).save(function(e){e||console.log("File HTML saved!")},!0,!1),u())}),pinegrow.saveAll=function(){W&&W.refreshBeforeSaveIfNeeded(),fe.fn.crsapages("saveAll")},fe(".menu-file-save-all").on("click",function(e){e.preventDefault(),x&&Y()&&(pinegrow.saveAll(),e.preventDefault(),u())}),pinegrow.closeAllPages=function(o,t,e){function a(n){var e=fe.fn.crsapages("getAllPages").slice();0!=e.length||t?fe.each(e,function(e,t){if(n&&t.hasChanges())return!0;t.force_close=!0,t.view&&t.view.closeTab()}):pinegrow.showQuickMessage("There are no open pages to close.")}var n;crsaHasChanges()&&!e?(n=showAlert("One or more pages have unsaved changes. Do you want to save changes before closing?","Unsaved changes","Cancel","Save all &amp; Close",function(){o&&o(!1)},function(){for(var e=fe.fn.crsapages("getAllPages"),t=!0,n=0;n<e.length;n++)if(e[n].hasChanges()&&!canSavePage(e[n],1e3)){t=!1;break}t&&(fe.fn.crsapages("saveAll",!0),a(!0),u(),o)&&o(!0)}),fe('<a href="#" class="btn pull-left">Don\'t save</a>').appendTo(n.find(".modal-footer")).on("click",function(e){e.preventDefault(),a(),n.modal("hide"),o&&o(!0)})):(a(),o&&o(!0))},fe(".menu-file-close-all").on("click",function(e){e.preventDefault(),pinegrow.closeAllPages()}),fe(".menu-file-close-project").on("click",function(e){e.preventDefault();var t=x?!0:!1;pinegrow.closeCurrentProject(t)}),fe(".menu-file-download").on("click",function(e){e.preventDefault(),x&&(gaSendPageView("FileDownload"),isApp()&&!crsaIsBig()&&ee?se():fe.fn.crsapages("downloadAllPages"))}),fe(".menu-file-save-project").on("click",function(e){var t;e.preventDefault(),x&&(gaSendPageView("FileSaveProject"),(t=new CrsaBrowserStorage).hasSavedProject()||(isApp()?showAlert("<p>Your current project was saved. You can open it later with <b>File - Load project</b>.</p><p><b>Only one project can be saved in this way.</b> Use File - Open and File - Save to open and save any file you want.</p>"):showAlert('<p>Your current project was saved to browser storage. You can open it later with <b>File - Load project</b>.</p><p><b>Only one project can be saved in this way.</b> <a href="https://pinegrow.com#buy" target="_blank"><b>Get the Pinegrow desktop app</b></a> to open and save any file you want.</p>')),t.saveProject()?crsaQuickMessage("Project was saved."):showAlert("There is nothing to save. First add some pages to the project (<b>File - New page</b>).","Nothing to save"))}),fe(".menu-file-load-project").on("click",function(e){e.preventDefault(),gaSendPageView("FileLoadProject");var t=new CrsaBrowserStorage;t.hasSavedProject()?t.restoreProject()||showAlert("Ups... something went wrong.","Couldn't load project"):showAlert("No saved project found. Choose <b>File - Remember project</b> to save a project first.","Couldn't load project")}),fe(".menu-file-close").on("click",function(e){e.preventDefault(),x?x.askClose():pinegrow.showQuickMessage("There are no open pages to close.")}),fe(".menu-dev-tools").on("click",function(e){isApp()&&(require("nw.gui").Window.get().showDevTools(),e.preventDefault(),pinegrow.stats.using("app.devtools"))}),fe(".menu-file-cache").on("click",function(e){pinegrow.cache_breaker++;require("nw.gui").App.clearCache();for(var t=fe.fn.crsapages("getAllPages"),n=0;n<t.length;n++)t[n].clearAssetsCache();delete localStorage.pg_layout_state,e.preventDefault()}),fe(".menu-file-manage-ss").on("click",function(e){fe.fn.crsacss("showStylesheetsManager",null),e.preventDefault()}),fe(".menu-file-manage-fm").on("click",function(e){fe.fn.crsacss("showFrameworkManager",pinegrow.getSelectedPage()),e.preventDefault()}),fe(".menu-file-new-window").on("click",function(e){e.preventDefault(),isApp()&&(require("nw.gui").Window.open(window.location.href,{},function(e){}),pinegrow.stats.using("app.newwin"))}),fe(".menu-support-about").on("click",function(e){var t;t=`<p><a target="_blank" class="link" href="${pgf.product_url}">${pgf.product_name_short}</a> &copy; Pinegrow Pte. Ltd.</p> <p>Designed &amp; developed by the Pinegrow Team.</p>`,t=makeModalDialog("About "+pgf.product_name_short+" - "+crsaGetVersionName(),"Close",null,t),isApp()&&t.find("a.link").on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)}),e.preventDefault()}),fe(".menu-support-settings").on("click",function(e){pinegrow.getComponent("settings",function(N){var e=N.html,e=showAlert(e,"Pinegrow Settings","Cancel","Save",function(e){setUIZoom($),pgAppWindowApplyCodeFontSize(),h("tabSize",pinegrow.getSetting("html-indent-size","4")),h("theme",pinegrow.getSetting("code-theme-cm",pinegrow.defaults.codeTheme))},function(e){var t=!1;pinegrow.setSetting("flexui",n.is(":checked")?"1":"0"),pinegrow.setSetting("backup",a.is(":checked")?"1":"0"),pinegrow.setSetting("backup-revisions",r.val()),pinegrow.setSetting("show-placeholders",i.is(":checked")?"1":"0"),pinegrow.setSetting("javascript-enabled",s.is(":checked")?"1":"0"),pinegrow.setSetting("use-less",l.is(":checked")?"1":"0"),pinegrow.setSetting("auto-reloading",c.is(":checked")?"1":"0"),pinegrow.setSetting("keep-collapsed",p.is(":checked")?"1":"0"),pinegrow.setSetting("disable-formating",d.is(":checked")?"1":"0"),pinegrow.setSetting("format-css",u.val()),pinegrow.setSetting("disable-stats",f.is(":checked")?"1":"0"),pinegrow.setSetting("file-types",v.val()),pinegrow.getSetting("ignore-folders")!=x.val()&&(t=!0),pinegrow.setSetting("ignore-folders",x.val()),pinegrow.setSetting("user-vars",M.val()),pinegrow.setSetting("compilable-remove-empty-rules",D.is(":checked")?"1":"0"),pinegrow.setSetting("compilable-use-autoprefixer",O.is(":checked")?"1":"0"),pinegrow.setSetting("compilable-autoprefixer-browsers",F.val()),pinegrow.setSetting("format-html",g.is(":checked")?"1":"0"),pinegrow.autoFormatHtml=g.is(":checked"),pinegrow.setSetting("format-css",u.val()),pinegrow.autoFormatCss=u.val(),pinegrow.setSetting("ui-zoom",S.val()),pinegrow.setSetting("webserver-port",E.val()),pinegrow.setSetting("webserver-host",T.val()),pinegrow.setSetting("proxy-config",I.val()),pinegrow.setSetting("code-theme-cm",m.val()),pinegrow.setSetting("code-editor",w.val()),pinegrow.setSetting("code-autocomplete",_.is(":checked")?"1":"0"),pinegrow.setSetting("code-size",P.val()),pinegrow.setSetting("code-font",k.val()),pgAppWindowApplyCodeFontSize(),pinegrow.setSetting("html-indent-size",b.val()),pinegrow.setSetting("html-indent-tabs",y.is(":checked")?"1":"0"),pinegrow.setSetting("editor-emmet",C.is(":checked")?"true":"false"),h(),pinegrow.setSetting("bootstrap-col-num",A.val()),pinegrow.setSetting("contributor-mode",L.is(":checked")?"true":"false"),pinegrow.setSetting("disable-quick-messages",j.is(":checked")?"1":"0"),pinegrow.dispatchEvent("on_settings_updated"),t&&pinegrow.refreshCurrentProjectDelayed(!0)}),n=(crsaHandleExternalLinks(e),pgf.edit_html||e.find(".pgf_edit_html").remove(),pgf.edit_css||e.find(".pgf_edit_css").remove(),pgf.stats_settings||e.find(".pgf_stats").remove(),e.find(".flexui")),o=pinegrow.getSetting("flexui","0"),a=("1"==o&&n.attr("checked","checked"),e.find(".backup")),r=("1"==(o=pinegrow.getSetting("backup","1"))&&a.attr("checked","checked"),e.find(".backup-revisions")),i=(r.val(pinegrow.getSetting("backup-revisions","20")),e.find(".show-placeholders")),s=("1"==(o=pinegrow.getSetting("show-placeholders","1"))&&i.attr("checked","checked"),e.find(".javascript-enabled")),l=("1"==(o=pinegrow.getSetting("javascript-enabled","1"))&&s.attr("checked","checked"),e.find(".use-less")),c=("1"==(o=pinegrow.getSetting("use-less","1"))&&l.attr("checked","checked"),e.find(".auto-reloading")),p=("1"==(o=pinegrow.getSetting("auto-reloading","1"))&&c.attr("checked","checked"),e.find(".keep-collapsed")),d=("1"==(o=pinegrow.getSetting("keep-collapsed","0"))&&p.attr("checked","checked"),e.find(".disable-formating")),g=("1"==(o=pinegrow.getSetting("disable-formating","0"))&&d.attr("checked","checked"),e.find(".format-html")),u=("1"==(o=pinegrow.getSetting("format-html","1"))&&g.attr("checked","checked"),e.find(".format-css")),f=(o=pinegrow.getSetting("format-css",pinegrow.defaults.formatCss),u.val(o),e.find(".disable-stats")),h=("1"==(o=pinegrow.getSetting("disable-stats","0"))&&f.attr("checked","checked"),f.on("change",function(){crsaIsBig()?(f.is(":checked")?pinegrow.stats.event("stats.off"):pinegrow.stats.event("stats.on"),pinegrow.alert("Save settings and restart Pinegrow to activate the change.")):(pinegrow.showAlert("Collecting usage data can't be disabled during trial mode.","Can't do that in trial"),f.removeAttr("checked","checked"))}),function(e,o){var t=pinegrow.populateCodeMirrorOptions({});pinegrow.code_editors.forEachEditor(n=>{"theme"===e?monaco.editor.setTheme(o):(e?n.updateOptions({opt:o}):fe.each(t,function(e,t){n.updateOptions({opt:o})}),n.render(!0))})}),m=e.find(".code-theme"),w=(o=pinegrow.getSetting("code-theme-cm",pinegrow.defaults.codeTheme),m.val(o),m.on("change",function(e){h("theme",m.val()),monacoInstance.editorTheme=m.val()}),e.find(".code-editor")),_=(o=pinegrow.getSetting("code-editor",""),w.val(o),e.find(".code-autocomplete")),t=("1"==(o=pinegrow.getSetting("code-autocomplete","1"))&&_.attr("checked","checked"),_.on("change",()=>{var e=_.attr("checked","checked")[0].checked;pinegrow.setSetting("code-autocomplete",e?"1":"0"),h("quickSuggestions",e),monacoInstance.autoSuggestion=e}),e.find(".html-indent-guide")),v=("1"==(o=pinegrow.getSetting("html-indent-guide","0"))&&t.attr("checked","checked"),t.on("change",()=>{var e=t.attr("checked","checked")[0].checked;pinegrow.setSetting("html-indent-guide",e?"1":"0"),h("renderIndentGuides",e),monacoInstance.renderIndentGuide=e,pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),e.find(".file-types")),b=(o=pinegrow.getSetting("file-types",""),v.val(o),e.find(".html-indent-size")),y=(o=pinegrow.getSetting("html-indent-size","4"),b.val(o),b.on("change",function(e){h("tabSize",parseInt(b.val())),monacoInstance.editorIndentSize=parseInt(b.val())}),e.find(".html-indent-tabs")),P=("1"==(o=pinegrow.getSetting("html-indent-tabs","0"))&&y.attr("checked","checked"),y.on("change",function(e){h("tabIndex",parseInt(y.val())),monacoInstance.editorIndentTab=parseInt(y.val())}),e.find(".code-size")),k=(o=pinegrow.getSetting("code-size","13px"),P.val(o),P.on("input",function(){W.setFontSize(P.val(),k.val()),h("fontSize",parseInt(P.val())),monacoInstance.editorFontSize=P.val()}),e.find(".code-font")),C=(o=pinegrow.getSetting("code-font",""),k.val(o),k.on("input",function(){h("fontFamily",k.val()),monacoInstance.editorFont=k.val()}),k.on("change",()=>{"JetBrainsMono"==k.val()&&pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),e.find(".code-editor-emmet")),S=("true"==(o=null==pinegrow.getSetting("editor-emmet")?"false":pinegrow.getSetting("editor-emmet"))&&C.attr("checked","checked"),C.on("change",function(e){var t=C[0].checked;pinegrow.setSetting("editor-emmet",o?"true":"false"),monacoInstance.emmetIsEnabled=!!o,monacoInstance.ToggleEmmet(t)}),e.find(".ui-zoom")),$=(o=pinegrow.getSetting("ui-zoom","0"),S.val(o),o),E=(S.on("change",function(e){setUIZoom(S.val())}),e.find(".webserver-port")),T=(o=pinegrow.getSetting("webserver-port",``+pgf.default_port),E.val(o),e.find(".webserver-host")),I=(o=pinegrow.getSetting("webserver-host","127.0.0.1"),T.val(o),e.find(".proxy-config")),A=(o=pinegrow.getSetting("proxy-config",""),I.val(o),e.find(".bootstrap-col-num")),x=(o=pinegrow.getSetting("bootstrap-col-num","12"),A.val(o),e.find(".ignore-folders")),M=(o=pinegrow.getSetting("ignore-folders","node_modules"),x.val(o),e.find(".user-vars")),D=(o=pinegrow.getSetting("user-vars",""),M.val(o),e.find(".compilable-remove-empty-rules")),O=("1"==(o=pinegrow.getSetting("compilable-remove-empty-rules","1"))&&D.attr("checked","checked"),e.find(".compilable-use-autoprefixer")),F=("1"==(o=pinegrow.getSetting("compilable-use-autoprefixer","1"))&&O.attr("checked","checked"),e.find(".compilable-autoprefixer-browsers")),L=(o=pinegrow.getSetting("compilable-autoprefixer-browsers",pinegrow.defaults.autoprefixer,!1),F.val(o),e.find(".contributor-mode")),j=("true"==(o=pinegrow.getSetting("contributor-mode","false"))&&L.attr("checked","checked"),e.find(".disable-messages"));"1"==(o=pinegrow.getSetting("disable-quick-messages","0"))&&j.attr("checked","checked"),A.on("change",function(e){pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),E.on("change",function(e){pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),T.on("change",function(e){pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),e.find(".restart").on("change",function(e){pinegrow.alert("Save settings and restart Pinegrow to activate the change.")}),c.on("change",function(e){c.is(":checked")&&pinegrow.alert("Save settings and restart Pinegrow to activate the change.")})}),e.preventDefault()}),fe(".menu-support-buy").on("click",function(e){showIntroScreen(),e.preventDefault()}),fe(".menu-support-contact").on("click",function(e){var t;t=makeModalDialog("Contact us","Close",null,'<p>Contact us at <a href="mailto:support@pinegrow.com" class="external">support@pinegrow.com</a>.</p>        <p>When reporting a bug please include screenshots and sample files/code that will help us to investigate the problem.</p>        <p>And check out <a class="link" target="_blank" href="https://pinegrow.com/support">Support section</a> of our website.</p>'),isApp()&&t.find("a.link").on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)}),e.preventDefault()}),fe(".menu-support-api").on("click",function(e){var t=pinegrow.getApiUrl();pinegrow.showAlert("<p>Url for accessing Pinegrow API remotely is: <code>"+t+"</code>.</p><p>Replace localhost with computer name or IP address to access the url from another computer.</p>","Pinegrow API url"),e.preventDefault()}),fe(".menu-support-new").on("click",function(e){Te(!0),e.preventDefault()}),fe(".menu-support-tour").on("click",function(e){crsaPlayTour(),e.preventDefault()}),fe(".menu-support-docs, .menu-support-portal, .menu-documentation, .menu-tips, .menu-video-tutorials, .menu-atom").on("click",function(e){var t,n;isApp()&&(t=require("nw.gui"),n=fe(e.delegateTarget).attr("href"),t.Shell.openExternal(n),e.preventDefault())}),fe(".menu-support-tutorial").on("click",function(e){e.preventDefault(),pinegrow.openOrShowPage(crsaGetBaseForUrl(window.location.href)+"/"+"templates/learn/tutorial.html")}),pinegrow.zoomControl=new PgZoomControl,(pgf.kids||pgf.insert_in_top_menu)&&buttonToolbarTopCenter.addSection("insert"),pinegrow.zoomControl.addToToolbar(buttonToolbarTopCenter),pgf.kids||pgf.insert_in_top_menu?(n=new PgButtonToolbarItem('<span><i class="icon icon-plus"></i><span style="position: relative;top: -4px;">Insert</span></span>',"Insert a new HTML element or component to the page. Use "+pgShowKbd("+")+" key to show / hide."),buttonToolbarTopCenter.addItem("insert",n),n.$element.addClass("menu-open-library"),buttonToolbarTopCenter.addSection("undo"),t=new PgButtonToolbarItem("icon-undo","Undo"),buttonToolbarTopCenter.addItem("undo",t),t.onClick=function(){pinegrow.undoManager.undo()},n=new PgButtonToolbarItem("icon-redo","Redo"),buttonToolbarTopCenter.addItem("undo",n),n.onClick=function(){pinegrow.undoManager.redo()}):(buttonToolbarTopCenter.addSection("helpers"),buttonToolbarTopCenter.addItem("helpers",pinegrow.helpersToolbarItem.toolbarItem)),buttonToolbarTopCenter.addSection("commands"),(pgf.kids||pgf.insert_in_top_menu)&&buttonToolbarTopCenter.addItem("commands",pinegrow.helpersToolbarItem.toolbarItem),t=new PgButtonToolbarItem("icon-text_edit","Inline text editing mode."),0&&pgf.edit_html&&isApp()&&buttonToolbarTopCenter.addItem("commands",t),t.onClick=function(){var e=!this.getActive();this.setActive(e),pinegrow.inlineEditManager.setTextMode(e,this)},pinegrow.inlineEditManager.textButton=t,(h=new PgButtonToolbarItem("icon-touch","Test clicks. Let the page handle mouse clicks. Use "+pgShowKbdCombo("ALT")+" + click to do a single test click, or to select an element when the Test clicks are active.")).$element.addClass("test-clicks-control"),pgf.kids||buttonToolbarTopCenter.addItem("commands",h),h.onClick=function(){N=!this.getActive(),this.setActive(N),N?(z(null),K(null),crsaQuickMessage("Use "+pgShowKbd("ALT")+" + CLICK to select an element when test clicks are enabled.",3e3)):pinegrow.showQuickMessage("Use "+pgShowKbd("ALT")+" + CLICK to do a test click when test clicks are disabled.",3e3)},pinegrow.addEventHandler("on_key_state_changed",function(e,t){var n=t.alt?!N:N;h.setActive(n)}),n=new PgButtonToolbarItem("icon-KODA","Show the code editor. "+pgShowKbdCombo("CMD+E")),!pinegrow.isContributorMode()&&pgf.edit_html&&buttonToolbarTopCenter.addItem("commands",n),n.onClick=function(e){var t;!isApp()&&pgf.open_all_files_in_code?pinegrow.hideEditCode()||pinegrow.editCodeOfAllOpenPagesAndStylesheets():pinegrow.hideEditCode()||(t=pinegrow.getSelectedPage())&&pinegrow.editCode(t,!0)},pinegrow.editCodeButton=n,t=new PgButtonToolbarItem("icon-JS","Enable Javascript on pages while open in Pinegrow. Turn off for better performance and to see how your page works without Javascript."),!pgf.kids&&isApp()&&buttonToolbarTopCenter.addItem("commands",t),t.onClick=function(e){pinegrow.setJavascriptEnabled(!this.getActive())},pinegrow.jsEnabledButton=t,pinegrow.setJavascriptEnabled(),buttonToolbarTopCenter.addSection("commands2"),n=new PgButtonToolbarItem("icon-refresh","Refresh current page view. "+pgShowKbdCombo("CMD+R")),buttonToolbarTopCenter.addItem("commands2",n),n.onClick=function(){x?x.refresh():pinegrow.showQuickMessage("Nothing to refresh. Open a page first.")},isApp()?(b=(_=new PgButtonToolbarItemWithDropdown("icon-27","Preview page in browser "+pgShowKbdCombo("CMD+B")+'<br>Use Right-click or <i class="icon icon-down"></i> to configure.',null,!0)).toolbarItem,_.toolbarItem.onClick=function(){x?x.openInBrowser():pinegrow.showQuickMessage("Nothing to preview in browser. Open a page first.")},_.onGetActions=function(){var e=[];return pinegrow.dispatchEvent("on_preview_dropdown_actions",null,e),e}):(_=b=new PgButtonToolbarItem(`<a class="preview-link" href="javascript:void(0);" target="_blank" rel="opener" style="text-decoration:none;"><i class="icon icon-27"></i></a>`,"Preview page in browser. "+pgShowKbdCombo("CMD+B"))).dontHandleClicks=!0,pgf.edit_html&&buttonToolbarTopCenter.addItem("commands2",b),0&&pgf.edit_html&&isApp()&&(t=new PgButtonToolbarItem("icon-add","Add new view of the active page."),buttonToolbarTopCenter.addItem("commands2",t),t.onClick=function(){x?x.view.addPageView(480):pinegrow.showQuickMessage("Open a page first.")}),pgf.edit_html&&pgf.repeater&&0&&pinegrow.repeater.addToToolbar(buttonToolbarTopCenter),pgf.edit_html&&!pgf.kids&&buttonToolbarTopCenter.addSection("commands3"),pinegrow.hidePanelsButton=new PgButtonToolbarItem("icon-hide","Hide panels. Press "+pgShowKbdCombo("TAB")+" to toggle."),0&&pgf.edit_html&&isApp()&&buttonToolbarTopCenter.addItem("commands3",pinegrow.hidePanelsButton),pinegrow.hidePanelsButton.onClick=function(){var e=this.getActive();pgToggleFloatingPanels(e)},pgf.kids||isApp()||(m=new PgWindowMenu,n=new PgButtonToolbarItem("icon-window","Workspace settings"),buttonToolbarTopCenter.addItem("commands3",n),n.onClick=function(){m.menuView.show(this.$element)}),w=new PgButtonToolbarItem("icon-focus",`Focus on a particular area of the page.<br>Press ${pgShowKbdCombo("SHIFT+CMD+F")} to focus on the selected element.`),pgf.edit_html&&pgf.use_focus&&isApp()&&buttonToolbarTopCenter.addItem("commands3",w),w.onClick=function(){pinegrow.focusBar.showMenu(w.$element)},pinegrow.focusBar.focusButton=w,_=new PgButtonToolbarItem("icon-search",`Find and replace `+pgShowKbdCombo("CMD+F")),pgf.edit_html&&buttonToolbarTopCenter.addItem("commands3",_),_.onClick=function(e){pinegrow.openFindAndReplace(e)},v=new PgButtonToolbarItemWithDropdown("icon-wand",'Smart insert - Use AI Assistant to adjust inserted elements.<br>Use Right-click or <i class="icon icon-down"></i> to configure.',null,!0),pgf.edit_html&&buttonToolbarTopCenter.addItem("commands3",v.toolbarItem),v.toolbarItem.$element.addClass("pg-smart-insert-toggle"),v.toolbarItem.setActive(pinegrow.useSmartInsert),v.toolbarItem.onClick=function(){pinegrow.useSmartInsert=!pinegrow.useSmartInsert,pinegrow.useSmartInsert&&!pinegrow?.pineCone.isEnabled()?(pinegrow.showQuickError("AI Assistant is not enabled. Please enable it to use Smart insert."),pinegrow.useSmartInsert=!1):(this.setActive(pinegrow.useSmartInsert),pinegrow.setSetting("ai-smart-insert",pinegrow.useSmartInsert?"1":"0"),pinegrow.showMode("Smart insert - Use AI Assistant to transform inserted elements",pinegrow.useSmartInsert))},v.onGetActions=function(){var e=[];return pinegrow.pineCone.isEnabled()?(e.push({type:"header",label:"Knowledge sources"}),e.push({label:"Use knowledge sources",check:pinegrow.pineCone.getSmartInsertSetting("content-sources"),helptext:"Include knowledge sources with every Smart Insert AI command.",action:function(){var e=!pinegrow.pineCone.getSmartInsertSetting("content-sources");pinegrow.pineCone.setSmartInsertSetting("content-sources",e),pinegrow.showMode("Use knowledge sources",e)}}),e.push({label:"Manage knowledge sources...",helptext:"Add or remove knowledge sources.",action:function(){pinegrow.pineCone.contentSources.showSources()}}),e.push({type:"divider"}),e.push({type:"header",label:"Context"}),e.push({label:"Whole document",check:"page"===pinegrow.pineCone.getSmartInsertSetting("context"),helptext:"Pass the whole document to Smart Insert AI commands. Best results, but uses more input tokens.",action:function(){pinegrow.pineCone.setSmartInsertSetting("context","page"),pinegrow.showMode("Send whole document",!0)}}),e.push({label:"Only the surrounding area",check:"page"!==pinegrow.pineCone.getSmartInsertSetting("context"),helptext:"Pass only the surrounding area of the inserted element to Smart Insert AI commands. Can lead to repeated information because the command is not aware of what is already on the page. But, it uses less input tokens.",action:function(){pinegrow.pineCone.setSmartInsertSetting("context","area"),pinegrow.showMode("Send only the surrounding area",!0)}})):e.push({label:"Enable AI Assistant...",action:function(){pinegrow.showUIPanel("ai")}}),e},pinegrow.addEventHandler("on_setting_changed",function(e,t,n){"ai-smart-insert"===t&&v.toolbarItem.setActive("1"===n)}),pinegrow.dispatchEvent("on_toolbar_created",null,buttonToolbarTopCenter),pgf.insert_in_top_menu&&(window.showTopMenuInsertLibrary=function(e){var t=fe(".menu-open-library"),n=pinegrow.getQuickLibWindow();e&&n&&n.win.visible?n.hide():(t.addClass("lib-open"),pinegrow.showQuickInsert(null,t,"down",!0))},fe(".menu-open-library").on("click",function(e){e.preventDefault(),showTopMenuInsertLibrary(!0)}),pinegrow.addEventHandler("on_quick_lib_window_hidden",function(e,t){t===pinegrow.getQuickLibWindow()&&fe(".menu-open-library").removeClass("lib-open")}),fe(".menu-current-project,.menu-project-menu").on("click",function(e){var t=fe(this);e.preventDefault(),new PgQuickNiceProjectView(t);return!1}),pgf.brand_dropdown_menu)&&fe(".navbar-brand").on("click",function(e){var t=fe(this),n=(e.preventDefault(),[{label:"Visit the Pinegrow website",dont_handle_click:!0,link_url:pgf.use_browser_storage?"https://pinegrow.com":pgf.product_url}]);return new CrsaContextMenu(n,t).showForElement(t,null,0),!1}),"PGTC"===pgf.product?(b=374,fe("#crsa-topbar .pg-button-toolbar.commands-toolbar").css({width:b,marginLeft:-(b/2)})):"SNAP"===pgf.product&&fe(".commands-toolbar").hide(),buttonToolbarTopCenter.customReposition(),fe("#crsa-rules"),y=function(e,r,i){r=r.replace(".","");var t=pinegrow.getCollection(e);t.forEachElement(function(e,t,n){var o=e.getName(),a=new pgParserSourceProblem(e);i?e.hasClass(r)&&e.canRemoveClass(r):a.add("element",o,"change"),a.ok()?i?canMakeChange(e,"remove_class",r)&&(willMakeChange(x,o+" | Remove class "+r),e.removeClass(r)):canMakeChange(e,"add_class",r)&&(willMakeChange(x,o+" | Add class "+r),e.addClass(r)):showAlert(a.toString(),"Can't edit this element")}),crsaQuickMessage("Class <b>"+r+"</b> "+(i?"removed from":"assigned to")+" <b>"+t.getName()+"</b>."),pinegrow.selectedElements.reselect(t),i?pinegrow.changeManager.didChange(t,"Remove class "+r):pinegrow.changeManager.didChange(t,"Add class "+r)},$.on("crsa-cm-class-add",function(e,t){y(null,t)}),$.on("crsa-cm-class-remove",function(e,t){y(null,t,!0)}),$.on("crsa-cm-edit",function(e,t){var n=getObjectFromRule(t);he.showProperties(n,Z)}),Q(),fe(window).on("resize",function(e){e.target===window&&Q()}),localStorage.openProjectOnLoad&&(pinegrow.openProject(localStorage.openProjectOnLoad),delete localStorage.openProjectOnLoad),addTooltip(fe('#crsa-left-plane [data-pg-tab="Lib"]'),"Add Elements to page "+crsaGetKbdDisplay("CMD 1",!1)),addTooltip(fe('#crsa-left-plane [data-pg-tab="Prop"]'),"Edit Element properties "+crsaGetKbdDisplay("CMD 2",!1)),addTooltip(fe('#crsa-left-plane [data-pg-tab="Css"]'),"CSS Editor &amp; Variables "+crsaGetKbdDisplay("CMD 3",!1)),addTooltip(fe('#crsa-left-plane [data-pg-tab="Act"]'),"Element Actions "+crsaGetKbdDisplay("CMD 4",!1)),addTooltip(fe('#crsa-left-plane [data-pg-tab="Wp"]'),"WordPress Actions "+crsaGetKbdDisplay("CMD 5",!1)),addTooltip(fe('#crsa-left-plane [data-pg-tab="Prj"]'),"Project "+crsaGetKbdDisplay("CMD 6",!1)),ae(R.openTab),(P=fe("#crsa-left-plane")).hide(),k="fa-minus",C="fa-plus",S=P.find("i.hider").on("click",function(e){P.width();P.hasClass("closed")?(P.removeClass("closed"),P.find(".nav-tabs").show(),P.animate({width:"300px"},150,function(){S.addClass(k).removeClass(C),Q()}),P.find(".tab-content").show().animate({opacity:1},150,function(){})):(P.addClass("closed"),P.find(".nav-tabs").hide(),P.animate({width:"30px"},150,function(){S.removeClass(k).addClass(C),Q()}),P.find(".tab-content").animate({opacity:0},150,function(){fe(this).hide()})),e.preventDefault()}),addTooltip(S,"Hide / show the panel"),fe(window).on("scroll",function(e){0!=$.scrollTop()&&$.scrollTop(0)}),fe("#crsa-fullscreen").on("click",function(e){e.preventDefault(),$.get(0).webkitRequestFullScreen()}),fe("#crsa-undo").on("click",function(e){x&&pinegrow.undoManager.undo(),e.preventDefault()}),addTooltip(fe("#crsa-undo"),"Undo"),fe("#crsa-redo").on("click",function(e){x&&pinegrow.undoManager.redo(),e.preventDefault()}),addTooltip(fe("#crsa-redo"),"Redo"),fe("#crsa-clipboard").on("click",function(e){e.preventDefault();new PgQuickClipboard}),fe(".menu-show-history").on("click",function(e){e.preventDefault(),pinegrow.showUIPanel("history",!1,!1,!0)}),pinegrow.addEventHandler("on_clipboard_copy",function(){}),pinegrow.addEventHandler("on_clipboard_cut",function(){}),addTooltip(fe("#crsa-clipboard"),"Show clipboard"),$.on("crsa-page-closed",function(e,t){pinegrow.inlineEditManager.stop(t),x==t&&B(null),I.removePage(t),null==x&&setTimeout(function(){var e;x||0<(e=fe.fn.crsapages("getAllPages")).length&&B(e[0])},100)}),$.on("crsa-page-rename",function(e,t){showPrompt("Page url","Edit page name/url",t.url,"/page.html",null,function(e){t.rename(e),t.setPageChanged(!0),I.updateDisplay(),isApp()&&showAlert('Use "File -> Save as" to actually store it under the new name.',"Notice")})}),$.on("crsa-page-saved-as",function(e,t){I.updateDisplay(),B(t,!0)}),M.on("click",function(e){e.target==M.get(0)&&(z(null),e.preventDefault())}),fe(document).on("keydown",function(e){return he.processKeydownEvent(e)}),fe(document).on("keyup",function(e){return he.processKeyupEvent(e)}),crsaIsBig())&&isApp()&&Ae(function(e,t){}),pinegrow.addEventHandler("on_css_source_changed",function(e,t){if(L){var n=t?t.list||[]:null;if(n&&0<n.length)for(var o=0;o<n.length;o++){var a=n[o];L.pgStylesheet.getUniqueId()==a.getUniqueId()&&fe.fn.crsa("selectRule",null)}else fe.fn.crsa("selectRule",null)}},10),pinegrow.addEventHandler("on_css_node_added",function(e,t){updateRuleIndices(L,t,1,"added")}),pinegrow.addEventHandler("on_css_before_node_deleted",function(e,t){updateRuleIndices(L,t,-1,"deleted")}),pinegrow.addEventHandler("on_stylesheet_unloaded",function(e,t){L&&L.pgStylesheet&&L.pgStylesheet.getUniqueId()==t.getUniqueId()&&fe.fn.crsa("selectRule",null)});return pinegrow.addEventHandler("on_page_loaded",function(){pinegrow.devTools.updateIframes()}),pinegrow.addEventHandler("on_page_closed",function(e){e.onlyCode||pinegrow.devTools.updateIframes()}),"undefined"!=typeof showIntroScreen&&(pinegrow.showIntroScreen=showIntroScreen),this},getMatchedCSSRules:function(e,o){var t;e?(t=pinegrow.devTools.getSelectedChromeIframe(e.getPage()))?pinegrow.devTools.getMatchedCSSRuleForChromeNode(t,e,function(e,t,n){o&&o(e,t,n)}):o&&o([],[],[]):o&&o([],[])},addTemplateProject:function(e,t){null==t?j.push(e):j.splice(t,0,e)},getPageTabs:function(){return I},clickOnMenu:function(e){setTimeout(function(){e.trigger("click")},20)},processKeydownEvent:function(e){var t=fe(e.target),n=t.is("input,textarea,select")&&!t.is("#crsa-dummy-field"),o=n&&0<t.closest(".CodeMirror").length,a=0<t.closest('[contenteditable="true"]').length,a=(o=o||a||crsaIsInEdit())||n,r=is_mac?e.metaKey:e.ctrlKey;if(e.pgCtrlKey=r,is_windows&&e.ctrlKey&&e.altKey&&(r=!1),pinegrow.keyState.keyChanged(e),e.key){var i,s,l=e.key.toLowerCase();if(pinegrow.keyState.double_key&&!o&&!n&&"Shift"===pinegrow.keyState.double_key)return pinegrow.floatingToolsManager.showAtMousePosition(),!1;if(!o&&!n&&pinegrow.repeater.keyPressed(e))return!1;if(!(8!=e.which&&46!=e.which||n||o)&&pgf.edit_html)return p={done:!1,action:"DeleteElementWithKey"},pinegrow.dispatchEvent("on_before_key_action",null,p),p.done||_(),!1;if(27===e.which){if(pgCloseContextMenus())return!1;if(t.attr("data-will-handle-esc"))return;var c={stop:!1};if(pinegrow.dispatchEvent("on_esc_pressed",null,c),c.stop)return!1;if(pinegrow.paintToolManager.getTool())return pinegrow.paintToolManager.clear(),!1;if(pinegrow.getDragMenu())pinegrow.getDragMenu().destroy();else if(pgQuickWindowManager.hasClosableWindows())pgQuickWindowManager.closeLast();else{if(crsaIsInEdit())return crsaEndEditModeIfActive(),!1;if(!n)return pinegrow.selectedElements.clear(),!1;t.get(0).blur()}}else if("Tab"===e.key&&pgf.hide_panels){if(!o&&!n&&0===fe(".modal:visible").length&&!pinegrow.startScreenManager.isVisible())return pgToggleFloatingPanels(),K(null),!1}else{if("t"===l&&r)return pinegrow.setShowDisplayHelpers(!pinegrow.getShowDisplayHelpers()),e.preventDefault(),!1;if("f"===l&&r&&!o)e.preventDefault(),e.shiftKey&&pgf.use_focus?(i=pinegrow.getSelectedPage(),pinegrow.getIsolatedElement(i)?pinegrow.isolateElement(null):(s=pinegrow.selectedElements.getLastSelected())&&pinegrow.isolateElement(s)):pinegrow.openFindAndReplace();else{if(68==e.which&&(!n&&!o||r)&&pgf.edit_html)return v(null,e.altKey),e.preventDefault(),!1;if(83==e.which&&r&&(pgf.save_html||pgf.save_css))return isApp()?e.altKey?he.clickOnMenu(fe("#crsa-topbar .menu-file-save-all")):e.shiftKey?he.clickOnMenu(fe("#crsa-topbar .menu-file-save-as")):he.clickOnMenu(fe("#crsa-topbar .menu-file-save")):pinegrow.backend.saveCurrentProject(),e.preventDefault(),!1;if(79==e.which&&r)return he.clickOnMenu(fe("#crsa-topbar .menu-file-open-file")),!1;if(82==e.which&&r)return x&&x.refresh(),!1;if(66==e.which&&r)return x&&x.openInBrowser(),!1;if(69==e.which&&r&&pgf.edit_html)return x&&setTimeout(function(){pinegrow.editCode(x)},10),!1;if("w"===l&&r&&e.shiftKey)return(i=pinegrow.getSelectedPage())?i.askClose():pinegrow.showQuickError("There are no open pages."),!1;if(("L"==e.key||"l"==e.key)&&r&&pgf.edit_html)return new PgQuickAssignClass,!1;if((67!=e.which||e.shiftKey||n||o||r)&&(72!=e.which||!r||e.shiftKey||is_mac&&!e.altKey)){if(82!=e.which||n||o||r||!pgf.edit_css){if("p"!=l||n||o||r||!pgf.edit_html||pgf.kids){if(90==e.which&&r)return n&&fe("#crsa-dummy-field").focus(),e.shiftKey?pinegrow.undoManager.redo():pinegrow.undoManager.undo(),!1;if(r&&e.key.match(/^[1-9]$/))return c=parseInt(e.key),(i=pinegrow.getSelectedPage())&&i.view.setActiveViewSizeWithKeyboard(c),!1;if("-"===l&&r)return pinegrow.zoomControl.zoomOut(),!1;if(("+"===l||"="===l||187===e.which)&&r)return pinegrow.zoomControl.zoomIn(),!1;if("0"===l&&r)return pinegrow.zoomControl.zoomReset(),!1;if("arrowdown"!==l||a)if("arrowup"!==l||a)if("arrowleft"!==l||a)if("arrowright"!==l||a){var p={done:!1,input:n,edit:o,ctrl:r,key:l};if(pinegrow.callGlobalFrameworkHandler("on_key_pressed",e,p),p.done)return!1;if(r&&"w"==e.key)return!1}else e.shiftKey?pinegrow.selectedElements.selectNextWithShift():pinegrow.selectedElements.selectNext();else e.shiftKey?pinegrow.selectedElements.selectPreviousWithShift():pinegrow.selectedElements.selectPrevious();else pinegrow.selectedElements.selectParent();else pinegrow.selectedElements.selectFirstChild()}else if(s=pinegrow.selectedElements.getLastSelected())return PgQuickProperties(null,s,s.get$DOMElement()),!1}else if(!pgf.kids)return pinegrow.showCreateCssRule(),!1}else if(!pgf.kids)return pinegrow.editElementCode(pinegrow.selectedElements.getLastSelected()),!1}}return!0}},processKeyupEvent:function(e){pinegrow.keyState.keyChanged(e);var t={key:e.key};return pinegrow.callGlobalFrameworkHandler("on_key_up",e,t),!0},getEditor:function(){return e},reloadPage:function(e,t){e.clearAssetsCache(),z(null),K(null),e.parsedStatus=null,e.setPageChanged(!1),e.refresh()},refreshSelectElement:function(){pinegrow.selectedElements.reselect()},openPage:function(e,a,r,t,i,s,l,n){for(var o,c,p,d=0==fe(".page").length,d=!0,g=(s=s||{},n&&(s.webapp=!0),0),u=null;1;){o=e,p=void 0;u=0==(c=g)?o:((p=o.split(".")).splice(p.length-1,0,[c]),p.join("."));if(!pinegrow.getCrsaPageByUrl(u))break;g++}u!=e&&(s.original_new_url=e,e=u),M.crsapages("addPage",e,function(n,o){var e,t;r&&r(o),(new Date).getTime(),(new Date).getTime(),d&&!s.skip_page_select&&(d=!1,B(o)),fe("body").trigger("crsa-page-added",n.get(0)),(t=pinegrow.getCurrentProject())&&(e=t.getBackgroundPageForUrl(o.url))&&(e.codeEditor&&e.codeEditor.closeTab(),o.setPageChanged(!0,!0),t.removeBackgroundPageForUrl(o.url)),o.detectAndAddFrameworks(function(){fe.fn.crsacss("loadLessStyles",n.get(0),function(){function t(){function e(){f(o),o.autoSize(),l&&l(o),fe("body").trigger("crsa-page-loaded",n.get(0))}i&&i(o),o.frameworks_added<2?o.detectAndAddFrameworks(e,2):e()}var a=require("path");fe.each(o.getPageStylesheets().stylesheets,function(e,t){var n,o=t.localFile;o&&(n=a.basename(o).replace(a.extname(o),".scss"),n=a.join(a.dirname(o),n),crsaIsFileExist(n))&&((n=PgSCSSStylesheet(n)).outFile=o,n.destStylesheet=t)});0==o.breakpoints.length?o.getBreakpointsFromCss(function(e){e.length&&(o.setAllBreakpoints(e),crsaQuickMessage("Got responsive breakpoints from CSS.",2e3),fe("body").trigger("crsa-breakpoints-changed")),t()}):t(),!o.javascriptEnabled&&o.hasScripts(1)&&crsaQuickMessage("Page has Javascript elements but Javascript is disabled.")},!1),a&&a(o)},1)},t,f,s)},getSourceOfPage:function(e){var t=getIframeDocument(e[0]),t=fe(t).find("> html");return 0<t.length?t[0].innerHTML:""},setSourceOfPage:function(e,t){var n=getIframeDocument(e[0]),n=fe(n).find("> html");0<n.length&&(n[0].innerHTML=t)},resizeChrome:function(){Q()},editCode:function(e,t){fe.trim(pinegrow.getSetting("code-editor",""));return W.editCode(e,null,t),this},getSelectedPage:function(){return null},getSelectedElement:function(){return console.log("old getSelectedElement called"),null},getSelectedCrsaPage:function(){return x},getSelectedRule:function(){var e,t=null;return L&&L.pgStylesheet&&L.nodeIndices&&0<L.nodeIndices.length&&(e=L.pgStylesheet.getRootNode(),t=pinegrow.pgPostCSSHelper.getNodeByIndices(e,L.nodeIndices)),t},getSelectedRuleIndices:function(){return L?L.nodeIndices:null},getSelectedRuleStylesheet:function(){return L?L.pgStylesheet:null},showIntroScreen:function(){showIntroScreen()},showElementDescription:function(e,t,n){e.html("")},addActionToElement:function(n,o,a,r){a=a||pinegrow.getCrsaPageOfPgParserNode(n),pgf.use_selectors&&!pinegrow.getUniqueSelectorOfPgel(n)&&pinegrow.assignUniqueSelectorToPgel(n,!1),o.get_element_for_action&&(n=o.get_element_for_action(n)),o.attribute&&(e=n.getData(o.attribute,o.attribute_default?"function"==typeof o.attribute_default?o.attribute_default(n,o,o.attribute,a):o.attribute_default:null),r&&o.attribute in r&&(e=r[o.attribute]),n.setAttr(o.attribute,e));var e=o.getActionParameters();return fe.each(e,function(e,t){t.name!==o.attribute&&(r&&t.name in r?n.setAttr(t.name,r[t.name]):t.default||n.getData(t.name)?n.setAttr(t.name,n.getData(t.name,"function"==typeof t.default?t.default(n,o,t.name,a):t.default)):n.removeAttribute(t.name))}),o.on_action_added&&o.on_action_added(n,a,o),a.getAllActionTypes(n).forEach(function(e){e!==o&&e.on_another_action_added&&e.on_another_action_added(n,a,o,e)}),pgf.use_selectors,a.callFrameworkHandler("on_action_added",n,o),n},addActionToElementForPreview:function(n,e,t){if(he.hasElementAction(n,e)||(e.attribute&&n.setAttr(e.attribute,e.attribute_default||null),a=e.getActionParameters(),fe.each(a,function(e,t){t.default&&n.setAttr(t.name,t.default)})),t){for(var o=[],a=(e.attribute&&o.push(e.attribute),e.getActionParameters()),r=(fe.each(a,function(e,t){o.push(t.name)}),[]),i=n.getAttrList(),s=0;s<i.length;s++)0==i[s].name.indexOf("wp-")&&o.indexOf(i[s].name)<0&&r.push(i[s].name);for(s=0;s<r.length;s++)n.removeAttr(r[s])}},removeActionFromElement:function(n,o,e){e=e||pinegrow.getCrsaPageOfPgParserNode(n),o.get_element_for_action&&(n=o.get_element_for_action(n)),o.attribute&&(n.setData(o.attribute,n.getAttr(o.attribute)),n.removeAttr(o.attribute));var t=o.getActionParameters();return fe.each(t,function(e,t){t.name!=o.attribute&&n.setData(t.name,n.getAttr(t.name)),n.removeAttr(t.name)}),o.on_action_removed&&o.on_action_removed(n,e,o),e.callFrameworkHandler("on_action_removed",n,o),n},hasElementAction:function(e,t){return t.has_action?t.has_action(e):t.attribute&&e.hasAttr(t.attribute)},setSelectedElementProperty:function(o,a){fe("#crsa-properties").find(".crsa-field").each(function(e,t){var n=fe(t);if(n.data("crsa-field")==o)return(n=n.find("> input")).val(a),n.trigger("change",!0),!1})},getValuesForElement:function(e){return getValuesForObject(getObjectFromElement(e))},getValuesForElementNew:function(e){return getValuesForObject(getObjectFromElement(e))},showProperties:function(e,t,n){},addInputField:function(N,$,l,k,C,j,W,H,R){function U(e){return"function"==typeof C?C(e):C}function n(){var e;_&&!_.destroyed||(e=_e(k,S())||[],v=e.filter(function(e){return!!e.key}),e="___dummy___",_=new PgFastDOMClassPreviewForPgel(S(),me(e,k,S()).replace(e,"")))}var e,t,B,V,o,a,r,i,G,q,K,z,Q,s,Y,Z,c,p,J,X,d,ee,te,g="div",S=(H&&(g=(f=H.split("|"))[0],1<f.length)&&f[1],k.use_type_features=k.use_type_features||[],k.skip_handle_events&&(j=k.skip_handle_events),function(){return"function"==typeof $?$():$}),u=U(S()),f="crsa-field crsa-field-"+k.type+" crsa-field-"+l.replace(/\./g,"-"),f=(k.add_class&&(f+=" "+k.add_class),{class:f}),h=(k.field_style&&(f.style=k.field_style),fe(pgE(g,f))),m=(h.data("crsa-field",l).data("crsa-field-def",k),N&&h.appendTo(k.append_to?N.parent().find(k.append_to):N),k.without_text||"button"==k.type||"displayhtml"==k.type?h.addClass("no-label"):k.name&&"hidden"!=k.type&&(g=pg$E("label",null,k.name),h.append(g),k.helptext)&&(k.helpicon||"label"===k.type?(fe(`<i class="icon icon-help helpicon"></i>`).appendTo(g),g.addClass("with-helpicon")):g.addClass("with-helplink"),k.helptext)&&(F={close_delay:3e4,delay:{show:250,hide:100},class:"helptext"},"function"==typeof k.helptext?addTooltip(g,function(){return k.helptext(S())},F):addTooltip(g,k.helptext,F)),k.icon&&(h.addClass("with-icons"),h.append(pgE("i",{class:"field-icon "+k.icon}))),k.class&&h.addClass(k.class),R&&l in R&&h.addClass("has-multiple-vals"),null),ne=null,E=null,w={type:k.type,appendNewToList:k.append_new_to_list,draggableList:k.draggable_list,onDropdownOpen:function(e){e.closest(".crsa-field").css("z-index",10)},onDropdownClose:function(e){e.closest(".crsa-field").css("z-index","")}},oe=(W&&0<W.length&&(w["JQparent"]=W),k.placeholder&&(w["placeholder"]=k.placeholder),k.system_field||!1),_=null,v=null;switch(k.type){case"select":if(oe||k.system_field||"Icon"==k.name||k.rich){m=fe("<select/>",{class:"crsa-input"}).appendTo(h),k.show_empty&&fe("<option/>").html("").appendTo(m),k.multiple&&m.attr("multiple","multiple");var b=_e(k,S());if(fe.each(b,function(e,t){fe("<option/>",{value:t.key}).html(t.name).appendTo(m)}),u[l])if(k.multiple||0==b.filter(function(e){return e.key==u[l]}).length&&fe("<option/>",{value:u[l]}).html(u[l]).appendTo(m),k.multiple)for(var ae=u[l].split(","),re=0;re<ae.length;re++)m.find("option[value='"+ae[re]+"']").prop("selected",!0);else m.val(u[l]);else k.show_empty?m.val(ye):k.default_value&&m.val(k.default_value);k.rich&&(T=fe("<div/>",{class:"crsa-select-val"}).appendTo(h),ne=new CrsaSelect(m,T,b,k.rich),T.data("crsa-select",ne),h.addClass("rich-select")),"apply_class"==k.action?m.attr("can-create-new","false"):m.attr("can-create-new","true")}else k.toggle_buttons?(b={multiple:k.multiple||!1,compact:k.compact_select||!1,compact_current_html:k.compact_current_html||null},"apply_class"===k.action&&(b.on_button_highlighted=function(e){n(),e?_.setClass(e.key,v):_.restore()},b.on_enter=function(e){},b.on_leave=function(){_&&(_.destroy(),_=null)},b.on_click=function(){_&&(_.destroy(),_=null)}),(e=new PgToggleButtons(h,b)).options=_e(k,S()),e.show_empty=k.show_empty||!1,e.default_value=k.default_value||null,u[l]&&e.setValue(u[l]),e.show(),m=e.get$input(),h.addClass("crsa-field-inline").data("pgControl",e)):((m=fe(pgE("div",{class:"crsa-input crsa-input"}))).appendTo(h),w["empty"]=!1,k.multiple&&(w["multiple"]=!0),k.splitter&&(w["splitter"]=k.splitter),t=null,k.async_options_function||k.fill_list_on_open?w.getItems=function(){return k.options(k,S())}:(t=_e(k,S()),w.getItems=function(){return t}),k.show_empty&&(w["empty"]=!0),"drag_starting_index"in k&&(w["drag_starting_index"]=k.drag_starting_index),k.can_add_items&&(w["newItem"]=!0,w["appendNewToList"]=!0),k.fill_list_on_open&&(w["fillListOnOpen"]=!0),k.textarea&&(w.textarea=!0),k.open_list_on_focus&&(w["openListOnFocus"]=!0),k.rich&&(T=fe("<div/>",{class:"crsa-select-val"}).appendTo(h),ne=new CrsaSelect(m,T,t,k.rich),h.addClass("rich-select")),"apply_class"!==k.action&&!k.preview_class||(w.on_list_item_highlighted=function(e){n(),e?_.setClass(e.key,v,k.on_preview_class?function(e,t){k.on_preview_class(e,l,t,cloneObject(u),S())}:null):_.restore()},B=w.onDropdownOpen||null,w.onDropdownOpen=function(e,t){B&&B(e),_&&(_.destroy(!0),_=null),n()},V=w.onDropdownClose||null,w.onDropdownClose=function(e){V&&V(e),_&&(_.destroy(),_=null)},w.on_drag_list_start=function(){n(),_.triggerPreviewEvent("dummy",v)},w.on_drag_list_end=function(){_&&(_.destroy(),_=null)}),E=PgAutoComplete(m,w,"select"),u[l]?E.val(u[l]):k.default_value&&E.val(k.default_value));break;case"rules":we(h,S());break;case"text":case"hidden":case"color":case"slider":case"image":case"media-query":if((M=fe(pgE("div",{class:"crsa-input crsa-input-"+k.type+(k.textarea?" crsa-input-is-textarea":"")}))).appendTo(h),"hidden"==k.type&&M.addClass("hide"),oe){(m=fe(pgE("input",{type:"hidden"==k.type?"hidden":"text",class:"crsa-input crsa-input-"+k.type}))).appendTo(h);try{u[l]&&m.val(u[l])}catch(e){}}else{var y=[];"element_attribute"!==k.action||k.options||(b=null,k.autocomplete_same_tag&&S()&&(b=S().tagName),y=pinegrow.insight.getValuesForAttribute(k.attribute,b)),w["newItem"]=!0,w["mode"]="input",w["getItems"]=function(){return y},k.open_list_on_focus&&(w["openListOnFocus"]=!0,w["noDropDownIcon"]="slider"===k.type,w["noKeys"]="slider"===k.type),k.fill_list_on_open&&(w["fillListOnOpen"]=!0),k.textarea&&(w.textarea=!0),k.options&&("function"==typeof k.options?w["getItems"]=function(){try{return k.options(k,S(),h)}catch(e){console.log("get auto complete options error: "+e)}}:y=k.options),k.no_auto_complete&&(w.no_auto_complete=!0),k.on_list_item_highlighted&&(w.on_list_item_highlighted=k.on_list_item_highlighted),E=PgAutoComplete(M,w),m=E.$input,u[l]&&m.val(u[l])}k.input_type&&m.attr("type",k.input_type);break;case"range":var P,T={type:"range",class:"crsa-input crsa-input-"+k.type},y=null;if(k.range_marks){y=[];for(var ie=("range_step"in k?k.range_step:1),se=k.range_min;se<=k.range_max;se+=ie)y.push({key:se})}(y=k.options?"function"==typeof k.options?k.options(k,S()):k.options:y)&&(b=getUniqueIdFast("datalist"),P=`<datalist id=${b}>`,y.forEach(function(e){P+=`<option value="${e.key}"`,e.label&&(P+=` label="${e.label}"`),P+=">"}),fe(P+="</datalist>").appendTo(h),T.list=b),"range_min"in k&&(T.min=k.range_min),"range_max"in k&&(T.max=k.range_max),"range_step"in k&&(T.step=k.range_step),m=fe("<input/>",T).appendTo(h),l in u&&m.val(u[l]);break;case"checkbox":m=fe("<input/>",{type:"checkbox",value:k.value,class:"crsa-input crsa-input-"+k.type}).appendTo(h),(u[l]==k.value||!u[l]&&k.default_value&&k.default_value==k.value)&&m.prop("checked","checked"),h.addClass("crsa-field-inline"),"apply_class"===k.action&&(m.on("mouseenter",function(e){m.prop("checked")||(n(),_.setClass(k.value,[]))}),m.on("mouseleave",function(e){_&&(_.destroy(m.prop("checked")),_=null)}));break;case"selector":function I(){return k.get_selector_base?k.get_selector_base(S()):S()}function A(e){var t,n;e?k.selector_multiple?(t=pinegrow.getPgelFromSelectorMultiple(I(),e,!1,x)).length&&((n=new PgCollection).setList(t),pinegrow.highlightElement(n.to$List()),pinegrow.highlightElementInTree(t[0])):(n=pinegrow.getPgelFromSelector(I(),e,null,x))&&(pinegrow.highlightElement(n.get$DOMElement()),pinegrow.highlightElementInTree(n)):(pinegrow.highlightElement(null),pinegrow.highlightElementInTree(null))}function le(e){var t,n;return e&&k.selector_assign_name&&!x&&(t=pinegrow.getPgelFromSelector(I(),e,null,!1))&&t!==I()&&!e.match(/^\[data\-pg\-name=[^\]]+\]$/)&&((n=pinegrow.getPgelFromSelector(I(),`[data-pg-name="${k.selector_assign_name}"]`,null,!1))!==t&&(n&&n.removeAttribute("data-pg-name"),t.setAttribute("data-pg-name",k.selector_assign_name)),e=`[data-pg-name="${k.selector_assign_name}"]`),e}var m=fe(`<input type="hidden"/>`).appendTo(h),x=k.selector_dom||!1,M=(m.on("change crsa-field-value-updated",function(){ce(m.val())}),fe(`<div class="crsa-field-container crsa-input pg-selector-field"></div>`).appendTo(h)),D=fe(`<div class="value-holder"></div>`).appendTo(M),ce=(fe('<i class="icon icon-267 crsa-icon-on-field" style="pointer-events:none;"></i>').appendTo(M),D.on("mouseenter",function(e){var t=m.val();A(t)}),D.on("mouseleave",function(e){A(null)}),function(e){var t=I(),n=[];e?(t&&(k.selector_multiple?n=pinegrow.getPgelFromSelectorMultiple(t,e,!1,x):(t=pinegrow.getPgelFromSelector(t,e,null,x))&&n.push(t)),t=n.length?((t=new PgCollection).setList(n),t.getName({name:n[0].getAttr("data-pg-name"),short:!1},!0)):e,D.html(t),n.length?M.removeClass("not-found"):M.addClass("not-found"),D.attr("data-title","Selector: "+("this"===e?"Current element":e)),k.no_has_value||h.addClass("has-value")):(D.html(k.placeholder||""),D.attr("data-title","Click to select element"),k.no_has_value||h.removeClass("has-value"),M.removeClass("not-found"))});D.on("click",function(e){var t=k.get_selector_options?k.get_selector_options(k,I(),function(){var e=this.key||"",e=le(e);m.val(e),m.trigger("change")},m.val()):pinegrow.getSelectorFieldOptions(I(),{multiple:k.selector_multiple||!1},function(){var e=this.key||"",e=le(e);m.val(e),m.trigger("change")},m.val()),n=(t.splice(1,0,{type:"header",label:"Select a descendant:"}),t.splice(1,0,{type:"divider"}),I().getName({short:!0})),t=(t.splice(0,0,{label:"Edit selector...",action:function(){var e=`<p>Enter a CSS selector with the following extra features:</p><ul>
<li>Use <code>this</code> to target ${n}.</li>
<li>Use plain selector, like <code>h2.title</code>, to <b>target descendants</b> of ${n}.</li>
<li>Prefix the selector with <code>$</code> to <b>target any element on the page</b>. Example: <code>$section.main h2</code>.</li>
<li><p>Prefix the selector with <code>^</code> to target the <b>closest matching element or its parent</b> of ${n}. Example: <code>^.modal</code>.<br>Add <code>| selector</code> to target descendants of that element, for example <code>^.menu | .menu-item</code>.</p></li>
</ul>
`;k.use_selector_extensions&&(e+=`<p>Append <code>-&gt;first</code>, <code>-&gt;next</code>, <code>-&gt;previous</code> and <code>-&gt;last</code> to target sibling elements.</p>`),e+=`<p><a href="https://pinegrow.com/docs/interactions/selecting-target-elements/" class="external">Learn more about using selectors.</a></p>`,pinegrow.showPrompt(e,"Edit the selector",m.val(),"",null,function(e){m.val(e),m.trigger("change")})}}),k.selector_global&&t.splice(0,0,{label:"Select on the page...",action:function(){new PgQuickSelectElement({title:"Select the target element",description:"<p>Select an element...</p>",select:!1,target:D,label:"Done",updated_message:"Target selector updated.",remove:"all",func:function(e){var t=I(),n=!0,o=(e.forEachElement(function(e){e.isDescendantOf(t)||(n=!1)}),[]),a=(e.forEachElement(function(e){o.push(e.getUniqueSelector(n?t:t.document))}),o.join(", "));n||(a=a&&"$"+a),m.val(a),m.trigger("change")}});pinegrow.showQuickMessage(`Click on target element on the page. Use ${pgShowKbd("CMD")} to select multiple.`)}}),t.splice(k.selector_global?2:1,0,{type:"divider"}),t.forEach(function(e){e.on_mouseenter=function(){A(e.key)},e.on_mouseleave=function(){A(null)}}),k.selector_info&&(t.unshift({type:"divider"}),t.unshift({type:"html",html:`<p class="pg-menu-html-desc">${k.selector_info}</p>`})),new CrsaContextMenu(t,D));return t.onBeforeMenuShown=function(){},t.onClosed=function(){A(null)},t.showForElement(D,null,2),!1}),addTooltip(D,"Click to select element",{use_title_attr:"data-title"}),l in u&&(m.val(u[l]),ce(u[l]));break;case"menu":(m=pg$E("input",{type:"hidden"})).appendTo(h),m.on("change input crsa-field-value-updated",function(){ge(m.val())});var O,M=pg$E("div",{class:"crsa-field-container crsa-input pg-selector-field"}).appendTo(h),pe=(D=pg$E("div",{class:"value-holder"}).appendTo(M)).get(0),de=(pg$E("i",{class:"icon icon-down crsa-icon-on-field",style:"pointer-events:none;"}).appendTo(M),function(e,t){for(var n=0;n<e.length;n++){if(e[n].key&&e[n].key===t)return e[n].name||e[n].label;if(e[n].submenu){var o=de(e[n].submenu,t);if(o)return o}}return null}),ge=function(e){var t;e?(O=O||("function"==typeof k.get_menu_options?k.get_menu_options(k,S()):k.get_menu_options),t=de(O,e)||e,fe(pe).html(t),h.addClass("has-value")):(fe(pe).html(k.placeholder||""),h.removeClass("has-value"))};D.on("click",function(e){var n,o,a=function(e){var t=this.key||"";m.val(t),m.trigger("change")},t=(k.get_menu_options&&(n=m.val(),O="function"==typeof k.get_menu_options?k.get_menu_options(k,S()):k.get_menu_options,(o=function(e){e.forEach(function(t){t.submenu?o(t.submenu):t.custom?t.action=function(){pinegrow.showPrompt(`<p>Enter a custom value</p>`,t.title,n,"",null,function(e){t.key=e,a.call(t),t.key=null})}:(t.action=a,t.check=t.key===n)})})(O),k.menu_no_not_set_option||(O=[{label:"Not set",check:!n,key:null,action:a},{type:"divider"}].concat(O))),new CrsaContextMenu(O,D));return t.onBeforeMenuShown=function(){},t.showForElement(D,null,2),!1}),l in u&&(m.val(u[l]),ge(u[l]));break;case"label":break;case"button":(L=fe(`<button class="pg-button">`+k.name+"</button>").appendTo(h)).on("click",function(e){e.preventDefault(),k.func(S(),fe(this),u,h,e,k)}),k.button_class&&L.addClass(k.button_class),L.on("contextmenu",function(e){var t=k.on_button_context_menu(S(),fe(this),u,h);return t.length&&new CrsaContextMenu(t,L).showForElement(L),!1}),k.helptext&&("function"==typeof k.helptext?addTooltip(L,function(){return k.helptext(S())}):addTooltip(L,k.helptext));break;case"displayhtml":var F,ue="function"==typeof k.name?k.name(S(),u):k.name,L=fe(`<div${k.wrapper_class?' class="'+k.wrapper_class+'"':""}>`+ue+"</div>").appendTo(h);k.helptext&&(F={close_delay:3e4,delay:{show:250,hide:100},class:"helptext"},"function"==typeof k.helptext?addTooltip(L,function(){return k.helptext(S())},F):addTooltip(L,k.helptext,F));break;case"displayhtmlwithlabel":k.html&&(ue="function"==typeof k.html?k.html(S()):k.html,L=fe('<div class="crsa-input">'+ue+"</div>").appendTo(h))}k.style_input&&(f="boolean"==typeof k.style_input?PgCSSFieldExtension:k.style_input,k.toggle_buttons?(o=new f(l,k,e.get$list(),e.get$input()),e.onBeforeUpdate=function(){o.$element.detach()},e.onAfterUpdate=function(){o.$element.appendTo(e.get$list())}):E&&(o=new f(l,k,E.$container,m)),h.data("css_field_ext",o)),m&&0<m.length&&m.data("input-type",k.type),k.with_clear_icon&&(a=fe('<i class="icon field-icon-infield icon-close"></i>').appendTo(m.parent()),pg$Hide(a),a.on("click",function(e){return"function"==typeof k.with_clear_icon?k.with_clear_icon():m.val("").trigger("change"),!1}),m.on("input change updateclearicon",function(){(m.val().length?pg$Show:pg$Hide)(a)})),"image"!==k.type&&!k.file_picker||(g=fe("<a/>",{href:"",class:"crsa-pick-file"}).html('<i class="icon-folder"></i>').appendTo(h.find(">div.crsa-input")),r=fe("<div />",{class:"preview-image"}).appendTo(h),fe('<i class="icon icon-bin"></i>').appendTo(r).on("click",function(e){return m.val("").trigger("change"),!1}),i=null,(G=function(){var e,t,n=m.val();pg$Hide(r),h.removeClass("with-image"),i&&(i.remove(),i=null),n&&(e=null,k.file_picker_parent_url?e="function"==typeof k.file_picker_parent_url?k.file_picker_parent_url():k.file_picker_parent_url:k.file_picker_use_project_as_parent&&pinegrow.getCurrentProject()&&(e=pinegrow.getCurrentProject().getUrl()+"/dummy.html"),null!==(e=e||crsaGetObjectParentUrl(S())||""))&&(e=isApp()?require("url").resolve(e,n):n,n.startsWith("/")&&(t=pinegrow.getCurrentProject())&&!pgf.root_urls&&(e=t.getUrl()+n),(pinegrow.getMimeType(e)||"").startsWith("image")||crsaIsRemoteUrl(e)&&"image"==k.type)&&n.indexOf(" ")<0&&(i=fe("<img />").appendTo(r),e=crsaIsRemoteUrl(e)?e:pinegrow.getProxyUrl(e),(t=pinegrow.getCurrentProject())&&(e=t.mapSourceUrlToDOMUrl(e)),i.attr("src",e),pg$Show(r),h.addClass("with-image"))})(),m.on("change pg-on-value-updated",function(e){G()}),r.on("click","img",function(e){return q(e),!1}).on("error","img",function(){i.hide()}),h.addClass("pick-file"),q=function(e){function o(e,t,n){var o=pinegrow.getCurrentProject();o&&!k.file_picker_dont_map_dom_to_source&&(e=o.mapDOMUrlToSourceUrl(e)),k.file_picker_quotes&&(e=e&&'"'+e+'"'),k.file_picker_no_url&&(e=t||crsaMakeFileFromUrl(e)),k.file_picker_on_picked&&(e=k.file_picker_on_picked(e,S(),n)),a.val(e).trigger("change")}var a=fe(e.delegateTarget).closest(".crsa-field").find("input.crsa-input,textarea.crsa-input");if(isApp()){function t(){function e(){if(k.file_picker_use_project_as_parent){var e=pinegrow.getCurrentProject();if(e)return e.getUrl()}return k.file_picker_parent_url?"function"==typeof k.file_picker_parent_url?k.file_picker_parent_url(S()):k.file_picker_parent_url:crsaGetObjectParentUrl(S(),t)}var t={mapped:!1,mappedBaseUrl:null},n=null;t.mappedBaseUrl?n=t.mappedBaseUrl:k.file_picker_use_project_as_parent&&(n=e()),PgChooseFile(function(e,t){o(e,t)},{parent_url:e(),save_as:k.file_picker_save||null,folder:k.file_picker_folder||null,no_proxy:k.file_picker_no_proxy||null,no_url:k.file_picker_no_url||null,must_be_in_base_to_be_relative:n,no_copy_to_folder:k.file_picker_no_copy_to_folder||!1})}if(k.file_picker_use_image_menu)return(i=[]).push({label:"Select file...",action:function(){t()}}),i.push({label:"Photo browser...",action:function(){var e;e=pgShowQuickImageBrowser(a),pgf.kids&&e.openCategoryDropdown(),e.imageBrowser.onImageClicked=function(e,t){o(e,null,t)}}}),"function"==typeof k.file_picker_use_image_menu&&k.file_picker_use_image_menu(i,function(e){o(e)}),new CrsaContextMenu(i,fe(e.target)).showForElement(fe(e.target),null,0),e.preventDefault(),e.stopPropagation(),!1;t()}else{var n,r,i=S();i instanceof pgParserNode?((n=i.parent?((r=i.get$DOMElement())&&pinegrow.focusRect.showForPage$El(r),pgShowQuickImageBrowser(r,!0)):pgShowQuickImageBrowser(fe(e.target),!1)).imageBrowser.onImageClicked=function(e,t){o(e,null,t)},n.imageBrowser.drag_enabled=!1):i&&i.pgStylesheet?((r=(i=pinegrow.selectedElements.getLastSelected()).get$DOMElement()).is("body")&&(r=r.parent()),pinegrow.focusRect.showForPage$El(r),(n=pgShowQuickImageBrowser(r,!0,function(e){o(e)})).imageBrowser.drag_enabled=!1):i&&(r=h,(n=pgShowQuickImageBrowser(r,!1,function(e){o(e)},k.file_picker_dont_map_dom_to_source||!1)).imageBrowser.drag_enabled=!1,n.win.$element.css("z-index",1100)),pgf.kids&&n.openCategoryDropdown()}e.preventDefault()},g.on("click",function(e){q(e)})),("slider"===k.type||-1<k.use_type_features.indexOf("slider"))&&(K=function(){for(var e=m.val(),t="",n=e.match(/(\s*![a-z]+)/),n=(n&&0<n.length&&(t=n[1],e=e.replace(t,"")),m.get(0).selectionStart),o=(n>e.length&&(n-=t.length),n),a=/[0-9a-z\.\%\-\+]/i;1<=o&&e.charAt(o-1).match(a);)o--;for(var r=n;r<e.length&&e.charAt(r).match(a);)r++;if(!(0<e.length&&r-o<=0))return{whole:e.substr(0,o)+"###VAL###"+e.substr(r),val:e=e.substr(o,r-o),pos:n,importantVal:t}},z=function(e,t){m.val(e.whole.replace("###VAL###",t)+e.importantVal),m.get(0).selectionStart=m.get(0).selectionEnd=e.pos},"slider"===k.type&&(f=h.find(".crsa-input"),Q="slider_def_unit"in k?k.slider_def_unit:"px",s="slider_step"in k?k.slider_step:1,Y="slider_min"in k?k.slider_min:-99999999,Z="slider_max"in k?k.slider_max:99999999,c=1/s,p=fe('<div class="drag-drop-numeric"><i class="icon-up"></i><i class="icon-down"></i></div>').appendTo(f),J=null,X=function(e){return(e.type.startsWith("touch")?e.targetTouches[0]:e).clientY},g=function(e){J=X(e),E&&E.closeDropdown();var n,o,a,t,r=p.siblings("input"),i=K();i&&(t=i.val||"0"+Q,n=parseFloat(t),o=Q,isNaN(n)?n=0:o=t.replace(n,"")||o,t=function(e){var t;e.type.startsWith("touch")||0!==e.buttons?(t=n+(J-X(e))/c*s,s<1&&(t=Math.floor(t*c)/c),Z<(t=t<Y?Y:t)&&(t=Z),Math.floor(t),z(i,t+o),r.trigger("input"),e.preventDefault()):(a.remove(),d=!1)},(a=fe('<div style="position:fixed;width:100%;height:100%;top:0;left:0;opacity:0;cursor:row-resize;z-index:999;">').appendTo(p.closest("body"))).get(0).addEventListener("mousemove",t,!0),a.get(0).addEventListener("touchmove",t,!0),t=function(e){a.remove(),p.siblings("input").trigger("change"),d=!1,e.preventDefault()},a.get(0).addEventListener("mouseup",t,!0),a.get(0).addEventListener("touchend",t,!0),e.preventDefault())},p.get(0).addEventListener("mousedown",g,!0),p.get(0).addEventListener("touchstart",g,!0)),d=!1,m.on("keydown",function(r){var e,t;E&&E.closeDropdown(),(38===r.which||40===r.which)&&(r.preventDefault(),e=m.val(),d=!0,ee=K())&&(e=ee.val,t="slider_def_unit"in k?k.slider_def_unit:"px",e=(e=e||"0"+t).replace(/(\-?[0\.-9]+)(px|em|rm|pt|%|)/g,function(e){var t=e.replace(/[\-0-9\.]/g,""),n=1,o=!0,a=(0<=e.indexOf(".")&&(n=.1,o=!1),(o?parseInt:parseFloat)(e));switch(r.which){case 38:r.shiftKey?a+=10*n:a+=n;break;case 40:r.shiftKey?a-=10*n:a-=n}return(o?a:a.toFixed(2).replace(".00",".0").replace(/(\.[0-9])0/,"$1"))+t}),z(ee,e))}).on("keyup",function(e){38!==e.which&&40!==e.which||(e.preventDefault(),m.trigger("input"))}).on("blur",function(e){d&&(m.trigger("change"),d=!1)})),k.type,"color"===k.type&&((te=fe('<div class="color-value-placeholder style="background-color:'+getStylePropWithoutImportant(m.val())+'""></div>').appendTo(M)).on("click",function(e){e.preventDefault();function n(e){var t,n="",o=(r.val().endsWith("!important")&&(n=" !important"),i=!0,r.get(0).selectionStart),a=r.get(0).selectionEnd;return 0<=o&&o<a?(t=(t=r.val()).substr(0,o)+e+t.substr(a,t.length-a),r.val(t+n),r.get(0).selectionEnd=o+e.length,r.get(0).selectionStart=o):r.val((t=e)+n),r.trigger("input"),i=!1,t+n}var o,t=fe(e.target).closest(".crsa-field.crsa-field-color"),r=t.find(".crsa-input.crsa-input-text"),a=fe("<input/>",{type:"text",class:"crsa-input-color-picker"}).appendTo(t),i=(r.data("color-input",a),u[l],!1),s=(r.on("input change",function(e){var t;i||(t=getStylePropWithoutImportant(r.val()),a.spectrum("set",t))}),!1),t=(a.spectrum({showAlpha:!0,clickoutFiresChange:!0,showInitial:!0,showInput:!0,allowEmpty:!0,preferredFormat:"hex",appendTo:a.closest("body"),palette:[],beforeShow:function(e){var t=fe(this).siblings(".crsa-input").find("> input");return o=t.val(),!0},move:function(e){n(colorToString(e))},show:function(e){},change:function(e){o=n(colorToString(e)),s=!0},hide:function(e){var t=fe(this).siblings(".crsa-input").find("> input");o!=t.val()?(i=!0,t.val(o),t.trigger("change"),i=!1):s&&(i=!0,t.trigger("change"),s=i=!1),setTimeout(function(){try{te.show(),a.spectrum("destroy"),a.remove()}catch(e){}},10)}}),getStylePropWithoutImportant(r.val()));a.spectrum("set",t),new PgSpectrumHelper(a,{"mouse-moved":function(e){var t=e.spectrum("get");n(colorToString(t))},"color-picked":function(e){var t=e.spectrum("get");o=n(colorToString(t)),s=!0}});return a.spectrum("show"),!1}),m.on("input change crsa-field-value-updated",function(e){var t=getStylePropWithoutImportant(m.val());te.css("background-color",t)}),k.palette&&new PgDmColorPicker(m,k.palette),k.colors)&&(f={},"apply_class"===k.action&&(f.on_color_highlighted=function(e){n(),e?_.setClass(e,v):_.restore()},f.on_show=function(){n()},f.on_value_set=function(){_.destroy(),_=null},f.on_hide=function(){_&&(_.destroy(),_=null)}),new PgColorPicker(m,k.colors,k.text_color||!1,S,f));return m&&!j&&(k.validate&&pg$Hide(pg$E("p",{class:"error-message"}).appendTo(h)),m.data("oldChangeValue",u[l]),m.on("blur",function(e){var t=fe(e.delegateTarget);"input"==t.data("lastEvent")&&t.change()}),m.on("input change",function(o,e){var t=S();if(null!=t){var a=fe(o.delegateTarget),r=(a.data("lastEvent",o.type),!a.is("input")&&E&&(fe(o.target),E.mode,a=fe(o.target)),a.closest(".crsa-field")),i=r.data("crsa-field"),s=r.data("crsa-field-def"),l=U(S()),n=l[i]||null,c="checkbox"===s.type?a.prop("checked")?s.value:null:function(e,t,n,o){t.multiple&&e&&"object"==typeof e&&(e=e.join(","));t.on_get_value_from_field&&(e=t.on_get_value_from_field(e,n,o));return e}(a.val(),s,o,l);if(s.hasOwnProperty("live_update")&&!s.live_update&&"input"===o.type)return!0;var p=t.pgStylesheet;if(t instanceof pgParserNode){var d=!0,g=t,u=s.can_make_change_action||s.action||"edit",f=g;if(s.can_make_change_element&&(f=s.can_make_change_element(g)||g),s.on_can_make_change?d=s.on_can_make_change(f,s):"element_attribute"==u&&s.attribute?canMakeChange(f,"attr",s.attribute)||(d=!1):"apply_class"==u?(n&&!canMakeChange(f,"remove_class",me(n,s))||c&&!canMakeChange(f,"add_class",me(c,s)))&&(d=!1):"element_id"==u?canMakeChange(f,"attr","id")||(d=!1):"element_html"==u?canMakeChange(f,"edit_content")||(d=!1):canMakeChange(f,u)||(d=!1),!d)return"checkbox"==s.type?n==s.value?a.prop("checked",!0):a.prop("checked",!1):a.val(n),!0}c!=ye&&""!=c||(c=null);try{"input"==o.type&&0,l[i]=he.propertyChanged(t,i,c,n,s,r,a,o.type,l);"style"!=(k.action||"style")||s["skip-adding-prop"]||(h=t.pgStylesheet,m=pinegrow.pgPostCSSHelper.getNodeByIndices(h.getRootNode(),t.indices),_=(w=pinegrow.pgPostCSSHelper.getChildrenDeclWithPropName(m,i))[w.length-1],v=!c||!_||!_.value,b="change"==o.type||v,p.ruleValueChanged(m,k.css_property||i,l[i],null,!1,"gui",b,null)),c!=l[i]&&a.val(l[i]),s.has_multiple_fields&&((y=r.closest(".pg-grid").find(".crsa-field-"+i).not(r).find("[data-autocomplete].crsa-input,input:not(.trigger-change),select")).each(function(e,t){var n=fe(t),o=n.data("pg-autocomplete");o&&o instanceof PgMultiselect?o.setVal(l[i]||"",!0):n.val(l[i]||"")}),""===l[i]||null===l[i]?y.parent().removeClass("has-value"):y.parent().addClass("has-value"));var h,m,w,_,v,b,y,P=!1;g&&("change"==o.type&&g.replacedWith&&(pinegrow.selectedElements.replace(g,g.replaceWith),P=!0,g=g.replacedWith),pinegrow.selectedElements.isSelectedElement(g)&&pinegrow.selectedElements.forEachSubsequentElement(g,function(e){var t=e,n=("function"==typeof C?C:getValuesForObject)(t);he.propertyChanged(t,i,c,n[i]||null,s,r,a,o.type,n),"change"==o.type&&e.replacedWith&&(pinegrow.selectedElements.replace(e,e.replaceWith),P=!0)}),"change"!=o.type||s.skip_did_change?s.skip_page_changed||pinegrow.dispatchEvent("on_page_is_being_changed",null,pinegrow.getCollection()):pinegrow.changeManager.didChange(pinegrow.getCollection(),"Set "+(k.name||i),{event_type:o.type})),P&&pinegrow.selectedElements.reselect(),ve&&(!be&&t instanceof pgParserNode&&(be=t),he.updateIfNeeded())}catch(e){console.error(e),showAlert(e.toString(),"Can't edit this element"),a.val(n)}}})),h},updateIfNeeded:function(){},propertyChanged:function(i,e,o,t,a,n,r,s,l){var c,p,d=i instanceof pgParserNode?i.getPage():null,g=a.action||"style";if(a.negvalue&&null==o&&(o=a.negvalue),"none"!=g&&(!n||!0!==n.data("pgDetached"))){if(a.set_value){var u=i;if(i instanceof pgParserNode){var f=i,h=new pgParserSourceProblem(f,null,!!a.ignore_lock);if(f||h.add("element",f.getName(),"change"),!h.ok())throw h;u=f}try{var m=a.set_value(u,o,l,t,s,a,n);m!=o&&(o=m,n.find("> input.crsa-input").val(o))}catch(e){console.log("set_value had an exception: ",e)}}else if("style"==g)"image"==a.type&&o.indexOf("(")<0&&(o="url("+o+")");else if("apply_class"==g){v=a.remove_classes_options?_e(a,i,"remove_classes_options"):_e(a,i);if(d&&d.sourceNode){var w,_=d.classSetter,f=i,h=new pgParserSourceProblem(f);if(f?v?fe.each(v,function(e,t){if(t.key==o)return!0;var n=me(t.key,a,i);_.hasClass(f,n)&&!_.canRemoveClass(f,n)&&h.add("class",n,"remove")}):t&&t!=o&&(w=me(t,a,i),_.hasClass(f,w))&&!_.canRemoveClass(f,w)&&h.add("class",w,"remove"):h.add("element",f.getName(),"change"),!h.ok())throw h;v?fe.each(v,function(e,t){if(t.key==o)return!0;var n=me(t.key,a,i);_.hasClass(f,n)&&_.removeClass(f,n,d.classSorter||null)}):t&&t!=o&&(w=me(t,a,i),_.hasClass(f,w))&&_.removeClass(f,w,d.classSorter||null),o&&(w=me(o,a,i),w=o.startsWith("!")?o.substring(1):"!"+o,_.hasClass(f,w)&&_.removeClass(f,w,d.classSorter||null),_.addClass(f,me(o,a,i),d.classSorter||null))}}else if("apply_class_multiple"==g){var v,_=d.classSetter,b=o?o.split(","):[];(v=_e(a,i)).forEach(function(e){var t=me(e.key,a,i);0<=b.indexOf(t)?_.addClass(i,t,d.classSorter||null):_.removeClass(i,t,d.classSorter||null)})}else if("element_id"==g){if(d&&d.sourceNode){f=i,h=new pgParserSourceProblem(f);if(f||h.add("element",i.getName(),"change"),!h.ok())throw h;f.setAttr("id",o)}}else if("element_attribute"==g){var u=pgEncodeAttribute(o),f=i,h=new pgParserSourceProblem(f);if(f||h.add("element",i.getName(),"change"),!h.ok())throw h;a.empty_attribute?o?f.setAttr(a.attribute,null):f.removeAttr(a.attribute):null===o&&!a.attribute_keep_if_empty||a.default_value&&o==a.default_value?f.removeAttr(a.attribute):f.setAttr(a.attribute,null!==u||a.attribute_keep_if_empty?u:"",!0)}else if("element_html"==g){f=i,h=new pgParserSourceProblem(f);if(f||h.add("element",f.getName(),"change"),!h.ok())throw h;f.html(null!==o?o:"")}else if("rules"==g){f=i,h=new pgParserSourceProblem(f);if(f||h.add("element",i.getName(),"change"),!h.ok())throw h;o?f.setAttr("class",o):f.removeAttr("class")}else"rule_name"==g?"rule"==(p=P(i).rule).type&&o!=t&&("class"==p.type&&p.class,i.selector=o,fe.fn.crsacss("renameRuleSelector",p,o,function(){pinegrow.selectedElements.reselect()},"gui")):"rule_media"==g?"change"==s&&(p=(c=P(i)).rule,c.pgStylesheet.ruleMediaChanged(p,o,function(e){(e||y)&&(y=!1,pinegrow.selectedElements.reselect()),e&&(y=!0)},"css")):"rule_supports"==g&&(p=(c=P(i)).rule,c.pgStylesheet.ruleSupportsAtruleChanged(p,o,function(e){"change"==s&&(e||y)&&(y=!1,pinegrow.selectedElements.reselect()),e&&(y=!0)},"css"));return a.on_changed&&a.on_changed(i,e,o,t,a,n,s,l,d),i.replacedWith?pinegrow.selectedElements.replace(i,i.replacedWith):"input"==s&&pinegrow.selectedElements.repositionMenus(),a.validate&&pinegrow.validateField(i,e,o,a,n,l),l[e]=o,("change"===s||a.show_if||a.show_if_on_input)&&n.closest(a.show_if_selector||".pg-ui-section-content").find(".crsa-field").each(function(e,t){var n,o=!1,a=fe(t),r=a.data("crsa-field-def");r&&r.show_if&&(n="function"==typeof r.show_if?r.show_if(l,i,a):crsaEvaluateShowIfString(r.show_if,l,r,i),a.is(":visible")!==n)&&(n?(pg$Show(a,"flex"),r.validate&&(n=a.data("crsa-field"),pinegrow.validateField(i,n,l[n],r,a,l),o=!0)):pg$Hide(a)),r&&r.validate_on_global_change&&!o&&(n=a.data("crsa-field"),pinegrow.validateField(i,n,l[n],r,a,l))}),"change"===s&&n.trigger("crsa-field-value-changed"),o}},showCSSRules:function(e,t,n){var o=fe("#crsa-rules-out .panel-content"),a=fe("#crsa-rules");r.setReferenceElement(e,!0),r.setShowOnlyClasses(!1,!0),void 0!==n&&r.setOnlyActive(n,!1),r.setFilter(t||null),r.filter_set_in_props_mode=!!t,r.showListPanel(!1),fe("#tab4").hasClass("active")||(0==o.find("#crsa-rules").length&&o.append(a),fe("#crsa-rules-out").data("panel").show()),r.resizeRulesList()},showTab:function(e){ae(e)},setSelectedPage:function(e){B(e)},updateStructureAndWireAllElemets:function(e,t,n){return this},setNeedsUpdate:function(e,t){return this},setNeedsUpdateDelayed:function(e){t&&(clearTimeout(t),t=null),t=setTimeout(function(){he.setNeedsUpdate(!0,e)},500)},setSelectElementOnUpdate:function(e){be=e},showPreview:function(e,t,n,o,a,r){var i=t,s=(c=c||fe("<div/>",{id:"crsa-preview",class:"preview"}).html('<div class="content clearfix"></div><div class="description"></div><div class="pre-holder"><pre></pre></div>').appendTo(fe("body"))).find(">.content"),l=c.find(">.description");(i?pgShow:(i=fe('<div style="display:none;"></div>'),pgHide))(s.get(0)),(r?(l.html(r),pgShow):(l.html(""),pgHide))(l.get(0)),i&&(s.html("").append(i),n&&c.addClass(n).data("custom-class",n),l=c.find(">div.pre-holder pre"),(a?(a=pinegrow.formatHtml(a),l.html(escapeHtmlCode(a)),pgShow):pgHide)(l.parent().get(0)),s=e.offset(),i=fe(window).height(),l=c.height(),i<(s=s.top-l/2)+l&&(s=i-l),pgShow(c.get(0)),i=e.closest(".lm_content"),l=o?"function"==typeof o?o(c.width(),i):o:getPreviewPosition(c.width(),i),c.css({left:l+"px",top:s+"px"}))},hidePreview:function(){var e;c&&(c.find(">div.content").html(""),pgHide(c.get(0)),e=c.data("custom-class"))&&c.removeClass(e).data("custom-class",null)},highlightElement:function(e,t,n){return K(e,t,n)},selectElement:function(e,t,n,o,a,r){z(e,t,n,o,a,r)},selectRule:function(e,t,n,o){n=n||{};var a=null;L&&L.pgStylesheet&&(a=pinegrow.pgPostCSSHelper.getNodeByIndices(L.pgStylesheet.getRootNode(),L.nodeIndices)),L=e?{nodeIndices:pinegrow.pgPostCSSHelper.getNodeIndices(e),pgStylesheet:pgStylesheetHelper.getStylesheetFromNode(e)}:null,fe("body").trigger("crsa-rule-selected",{rule:e,source:t,previous_rule:a,options:{skip_updating_sections:n.will_be_added,clicked_prop:o}})},isSelectedRule:function(e){var t,n;return!!L&&!(e&&e.inline_for_pgel&&L.inline_for_pgel!==e.inline_for_pgel||(t=L.nodeIndices,n=pinegrow.pgPostCSSHelper.getNodeIndices(e),t.toString()!==n.toString()))},editRuleSource:function(n){function t(e,t){t&&t.list&&t.eventType&&"editor"==t.eventType&&"external_editor"==t.editor&&0<=t.list.indexOf(o)&&(pinegrow.showQuickMessage("Stylesheet was modified in external editor."),r.close())}var o=n.pgStylesheet,a=pinegrow.pgPostCSSHelper.getNodeByIndices(o.getRootNode(),n.nodeIndices),r=(pinegrow.addEventHandler("on_css_source_changed",t),showCodeEditor("text/css","Edit CSS rule code","edit-rule-code",function(){s(e.getDoc().getValue())},function(){pinegrow.removeEventHandler("on_css_node_added",c),pinegrow.removeEventHandler("on_css_before_node_deleted",p),fe("body").trigger("crsa-stylesheets-changed",{list:[o]}),pinegrow.selectedElements.reselect()},function(){pinegrow.removeEventHandler("on_css_node_added",c),pinegrow.removeEventHandler("on_css_before_node_deleted",p);try{var e=pinegrow.pgPostCSSHelper.getNodeByIndices(o.getRootNode(),n.nodeIndices);pinegrow.pgPostCSSHelper.replaceNodeWith(e,a),o.forgetCachedSource(),o.setSourceForRules(pinegrow.pgPostCSSHelper.getRootNodeFor(e),function(){fe("body").trigger("crsa-stylesheets-changed")})}catch(e){}pinegrow.removeEventHandler("on_css_source_changed",t)})),e=r.mirror,i=null,s=function(t){i&&clearTimeout(i),i=setTimeout(function(){var e=pinegrow.pgPostCSSHelper.getNodeByIndices(o.getRootNode(),n.nodeIndices);o.updateNodeStylesheetWithSource(e,t,function(e){e&&0;var t=o.getError();i=null,t?0:o.setChanged(!0),fe("body").trigger("crsa-rule-changed-in-editor",{list:[o]})})},300)},l=o.getSourceForRules(a),l=o.filterSource(l,!0),c=(e.getDoc().setValue(l),e.getDoc().clearHistory(),function(e,t){updateRuleIndices(n,t,1,"added")}),p=function(e,t){updateRuleIndices(n,t,-1,"deleted")};pinegrow.addEventHandler("on_css_node_added",c),pinegrow.addEventHandler("on_css_before_node_deleted",p)},scrollCanvasToElement:function(e){scrollCanvasToElement(e)},willMakeChange:function(e,t){willMakeChange(e,t)},setDraggedMenu:function(e){F=e},getDragMenu:function(){return F},getActionsMenu:function(c,t,e){function n(e,t){var n=u.getPlacementFromEvent(t);n&&pinegrow.clipboard.setPlacement(n),pinegrow.clipboard.paste(this.item||null,p)}var o,a,r,i,s,l=t?null:c,p=t?pinegrow.getCollection():new PgCollection(c),d=[],g=(pgf.edit_html&&(d.push({type:"divider"}),d.push({type:"header",label:"Edit"}),d.push({label:"Classes...",kbd:"CMD L",manage_change:!0,action:function(e,t,n){new PgQuickAssignClass(l,n)}}),c.canHaveChildren()&&d.push({label:"Text",action:function(){pinegrow.inlineEditManager.edit(c.get$DOMElement(),!1)}}),d.push({label:"Code",class:"action-edit-code",kbd:is_mac?"CMD ALT H":"CMD H",manage_change:!0,action:function(){pinegrow.editElementCode(c)}}),d.push({label:"Properties",kbd:"P",manage_change:!0,action:function(){PgQuickProperties(null,c,c.get$DOMElement())}}),pgf.edit_css&&(1<p.getLength()?d.push({label:"CSS Grid",helptext:"Not available for multiple selected elements."}):d.push({label:"CSS Grid",manage_change:!0,submenu_callback:function(e){var t,n,o=pinegrow.findFrameworkByKey("pg.css.grid");o?(t=c.getPage(),n={$el:c.get$DOMElement(),pageView:t.activeView,pgel:c},o.gridGetMenuPointsWithCallback(t,c,n,e,!0)):e([])},submenu:!0})),o=pinegrow.getImageSrcForPgel(c),a=c.getInlineBackgroundImage(),(o||a)&&(r=!1,crsaIsRemoteUrl(o||a)&&(d.push({type:"divider"}),d.push({type:"header",label:"Image"}),d.push({label:"Save remote image...",manage_change:r=!0,action:async function(e){var t=new PgApi,n=await pinegrow.saveRemoteImageToProject(o||a,!0);t.setImageUrl(l,n,!!a),pinegrow.selectedElements.reselect(),pinegrow.showQuickMessage(`Image was saved.`)}})),o)&&"image/svg+xml"===pinegrow.getMimeType(o)&&(r||(d.push({type:"divider"}),d.push({type:"header",label:"Image"})),d.push({label:"Inline SVG image",manage_change:!0,action:async function(e){await(new PgApi).includeSVGImageInline(pinegrow.getCollectionForElement(c)),pinegrow.showQuickMessage(`Done.`)}})),0&&pinegrow.actionsManager&&d.push({label:"Actions",submenu:pinegrow.actionsManager.getActionsMenu(c,t,e)}),d.push({type:"divider"}),d.push({label:"Delete",class:"action-delete-element",kbd:"DEL",manage_change:!0,action:function(e){_(l)}}),d.push({label:"Duplicate"+pinegrow.repeater.showLiveRepeatCount(),class:"action-duplicate-element",manage_change:!0,kbd:"CMD D",action:function(e,t){v(l)}}),t&&1<pinegrow.selectedElements.getLength()&&d.push({label:"Duplicate as group"+pinegrow.repeater.showLiveRepeatCount(),class:"action-duplicate-element",manage_change:!0,action:function(e,t){v(l,!0)}}),r=[],["html","body","head","img","script","link","meta","br"].indexOf(c.tagName)<0&&(i=function(e){var o=t?null:e;"..."===this.change_tag?pinegrow.showPrompt("<p>Change element tag to:</p>","Change element to",null,"p",null,function(t){var n;t&&t.match(/^[a-z][a-z0-9]*$/i)?(t=(t=t||"").toLowerCase(),(new PgApi).changeTag(o,t),pinegrow.showQuickMessage("Tag name changed to "+t+"."),n=!1,pinegrow.changeToElementList.forEach(function(e){"string"==typeof e?e==t&&(n=!0):e.tag==t&&(n=!0)}),n||pinegrow.changeToElementList.unshift(t),pinegrow.selectedElements.reselect()):pinegrow.showQuickError('"'+t+'" is not a valid tag name.')}):((new PgApi).changeTag(o,this.change_tag),pinegrow.showQuickMessage("Tag name changed to "+("string"==typeof this.change_tag?this.change_tag:this.change_tag.tag)+"."),pinegrow.selectedElements.reselect())},f=["p","h1","h2","h3","h4","h5","h6","a","span",{tag:"li",parent_tag:"ul",label:"&bull; li",change_parent:["ol"]},{tag:"li",parent_tag:"ol",label:"1. li",change_parent:["ul"]},"div","section","..."],pinegrow.changeToElementList||(pinegrow.changeToElementList=f),f=pinegrow.changeToElementList,s=[],f.forEach(function(e){s.push({label:"string"==typeof e?e:e.label,action:i,change_tag:e})}),r.push({type:"header",label:`Change &lt;${c.tagName}&gt; to:`,group:"change_to"}),r.push({buttons:s,group:"change_to"}),r.push({type:"divider"})),"a"!=c.tagName?(0!=c.find("a").length||c.closest("a")||r.push({label:"Add link",class:"action-add-link",kbd:null,manage_change:!0,action:function(){b(l)}}),r.push({label:"Remove outer "+c.tagName,kbd:null,manage_change:!0,action:function(){C(l)}})):r.push({label:"Remove link",class:"action-remove-link",kbd:null,manage_change:!0,action:function(){C(l)}}),r.push({label:"Wrap with div",kbd:null,manage_change:!0,action:function(){(new PgApi).wrapWithElement(l,"<div></div>")}}),(1<(f=pinegrow.getCollection()).getLength()||!f.contains(c)&&0<f.getLength())&&r.push({label:"Merge selected into "+c.getName({short:!0}),manage_change:!0,action:function(){(new PgApi).mergeElements(pinegrow.getCollection(),c)}}),r.push({label:"Split parent "+c.parent.getName({short:!0})+" at this position",manage_change:!0,action:function(){(new PgApi).splitParent(l)}}),pgIsDev()&&0&&(r.push({label:`Use as transform source`,manage_change:!0,action:function(){pinegrow.transformSourcePgel=l||pinegrow.selectedElements.getLastSelected()}}),r.push({label:`Transform to`,manage_change:!0,action:function(){pinegrow.transformSourcePgel?(new PgApi).transformElement(l,pinegrow.transformSourcePgel):pinegrow.showQuickError("Select the transform source first.")}})),d.push({label:"Transform",submenu:r})),d.push({label:"Select",submenu:function(){return new PgSelectMenu(c).getActions()}}),d.push({type:"divider"}),d.push({label:"Copy",kbd:"CMD C",action:function(){pinegrow.clipboard.copy(p)},submenu:function(){function t(e){var t=[];e.forEach(function(e){t.push({def:e,values:e.getActionValuesForPgel(c)})}),pinegrow.clipboard.copySpecial("actions",t)}function n(e){var t=c.getAttr(e),n='"';pinegrow.clipboard.copySpecial("attributes",null!==t?e+`=`+n+pgEncodeAttribute(t)+n:``+e)}var o=[],a=(pgf.edit_html&&o.push({label:"HTML",action:function(){pinegrow.clipboard.copy(p)}}),[]),e=c.getPage().getAllActionTypes(c),r=(e.length&&(o.push({type:"divider"}),o.push({type:"header",label:"Actions"}),o.push({label:"All",action:function(){t(e)}}),e.forEach(function(e){o.push({label:e.name,action:function(){t([e])}}),a=a.concat(e.getActionParameters())})),[]);if(c.getAttrList().forEach(function(e){a.indexOf(e.name)<0&&!e.name.startsWith("data-pg-")&&r.push(e.name)}),r.length){var i=0;o.push({type:"divider"}),o.push({type:"header",label:"Attributes"});if(["class","src","href"].forEach(function(e){var t=r.indexOf(e);0<=t&&(r.splice(t,1),o.push({label:e,action:function(){n(e)}}),i++)}),r.length){r.sort();for(var s=i;s<=3&&r.length;s++){var l=r.shift();o.push({label:l,action:function(){n(l)}})}r.length&&o.push({label:"More",submenu:r.map(function(e){return{label:e,action:function(){n(e)}}})})}}return o}}),pinegrow.clipboard.getCurrentItem(),pinegrow.clipboard.getAll()),u=new PgContextMenuHelpers(c,pinegrow.clipboard.getPlacement()),f={label:"Paste",kbd:"CMD V"},h=(f.action=n,[]);if(0===g.length)h.push({type:"header",label:"Clipboard is empty."});else for(var m,w=0;w<g.length&&10!==w;w++)!pgf.edit_html&&"code"===g[w].type||((m="code"===g[w].type?u.getMenuItemWithPlacement(g[w].name):{label:g[w].name}).action=n,m.item=g[w],h.push(m));return h.push({type:"divider"}),h.push({label:"Show clipboard...",action:function(){new PgQuickClipboard}}),f.submenu=h,f.submenu_class=u.getMenuFixedSizeClass("lg"),d.push(f),d.push({type:"divider"}),pgf.edit_css&&d.push({label:"Create CSS rule",kbd:"R",manage_change:!0,action:function(e,t,n){pinegrow.showCreateCssRule()}}),pgf.edit_html&&(d.push({label:"Focus on...",kbd:"CMD F",manage_change:!0,action:function(){pinegrow.isolateElement(c)}}),pgf.html_snippets)&&d.push({label:"Add as HTML snippet",class:"action-add-comp",kbd:null,action:function(e){pinegrow.getCollection(l).forEachElement(function(e){addAsComponent(e)})}}),d},getActionsMenuFor:function(e,t,n){var o=[],a=e.getPage().getMainType(null,e),r=t?null:e;return"html"!==e.tagName&&pgf.edit_html&&o.push({label:"Insert",submenu:function(){return new PgInsertLibElementMenu(e,r).getActions()}}),a.action_menu&&a.action_menu.actions&&(o.push({type:"divider"}),o.push({label:a.name+" actions",type:"header"}),fe.each(a.action_menu.actions,function(e,t){o.push(t)})),o=o.concat(he.getActionsMenu(e,t,n))},buildActionsDropDownMenu:function(e,g,u,f,h){var m=!1;fe.each(e,function(e,s){var o,l,a,c,r,t,n,i,p,d;return!(!s.show_filter||s.show_filter(s))||("smartinput"===s.type?(o=fe('<li class="smartinput"></li>'),u.append(o),s.input.addToMenu(h,o),!0):("divider"==s.type?0<e&&(o=pg$E("li",{class:"divider"},s.label)):o="header"==s.type?pg$E("li",{class:"dropdown-header"},s.label):"html"==s.type?pg$E("li",null,s.html):s.link_url?pg$E("li",null,`<a href="${s.link_url}"${s.open_in_same_win?pgIsEmbeded()?' target="_top"':"":' target="_blank"'}>${s.label}</a>`):pg$E("li",null,'<a href="#">'+s.label+"</a>"),s.debug&&o.append(s.debug),s.helptext&&(s.submenu_icon="icon-none",s.submenu=[{type:"html",html:`<p style="color:rgba(255,255,255,0.75);margin-bottom:0;padding:10px 15px;">${s.helptext}</p>`}]),void(o&&(s[h.class_key]&&o.addClass(s[h.class_key]),s.on_click&&o.on("click",function(e){e.preventDefault(),s.on_click(o,e)}),l=o.find("a").data("action",s),s.kbd&&(crsaAddKbd(l,s.kbd),l.addClass(s.class)),u.append(o),s.onShow&&s.onShow(o),i=!1,c=a=null,r=180,l.on("mouseenter",function(e){if(!h._ignore_mouseenter){var t=fe(this);if(s.submenu){var n=t.data("pg-menu");if(n&&n===h.open_submenu)return!1}h.open_submenu&&(a&&clearTimeout(a),a=setTimeout(function(){h.open_submenu&&h.open_submenu.close(),a=null},r)),h.resetCloseTimer(),s.on_mouseenter&&s.on_mouseenter.call(s,t,e)}}),l.on("mouseleave",function(e){c&&(clearTimeout(c),c=null),a&&(clearTimeout(a),a=null),s.on_mouseleave&&s.on_mouseleave.call(s,l,e)}),s.buttons?(o.find("a").remove(),o.addClass("menu-item-buttons"),s.html&&o.append(s.html),s.buttons.forEach(function(n){var t=pg$E("a",{href:"#"},n.label);t.appendTo(o),t.on("click",function(e){if(e.preventDefault(),n.action.call(n,g,e,t),h.keepOpenOnClick)return t.parent().find(".active").removeClass("active"),t.addClass("active"),!1;f&&f(!0)}),n.class&&t.addClass(n.class),n.on_mouseenter&&t.on("mouseenter",function(e){var t=fe(this);n.on_mouseenter.call(n,t,e)}),n.on_mouseleave&&t.on("mouseleave",function(e){var t=fe(this);n.on_mouseleave.call(n,t,e)})})):s.submenu?(n=s.submenu_icon||"icon-right",fe('<i class="icon '+n+' open-sub"></i>').appendTo(l),l.addClass("with-open-sub"),t=function(){var a,e=l.data("pg-menu");return(!e||e!==h.open_submenu)&&(s.submenu_callback?(s.submenu_callback(function(e){s.submenu=e,s.submenu_callback=null,t()}),!1):void(0!==(a="function"==typeof s.submenu?s.submenu():s.submenu).length&&(h.show_submenu_for_node=l.get(0),c&&clearTimeout(c),c=setTimeout(function(){var e,t,n,r,i,o;h.closed||h.show_submenu_for_node!==l.get(0)||((e=new CrsaContextMenu(a,l,h)).targetPgel=h.targetPgel||null,e.keepOpenOnClick=h.keepOpenOnClick,(e.parent_action=s).on_before_submenu_open&&s.on_before_submenu_open(e),t=l.offset(),n=l.width(),r=h.$menu_ul.width(),i=l.closest("body").width(),o=l.closest("ul").width(),t.left+n+o>i&&t.left,e.showForElement(l,null,-20,0,function(e,t,n){s.submenu_class&&e.addClass(s.submenu_class);var o={x:t+r,y:n},a=e.width();return(i<o.x+a||h.submenu_open_on_left)&&(o.x=t-a,h.submenu_open_on_left=!0,o.x<0)&&(o.x=t+r+a<i?t+r:t+r-(i-a)<a-t?i-a:0,h.submenu_open_on_left=!1),o}),e.submenu_open_on_left=h.submenu_open_on_left,h.$menu_ul.find(".hovered").removeClass("hovered"),l.addClass("hovered"),h.$menu_ul.addClass("has-open-submenu"),s.on_submenu_open&&s.on_submenu_open(e)),c=null},r))))},s.action?i=!0:l.on("click",function(e){return e.preventDefault(),t()}),l.on("mouseenter",function(e){if(!h._ignore_mouseenter)return t()})):i=!0,i&&!s.dont_handle_click&&l.on("click",function(e){e.preventDefault();var t,n,o=fe(e.delegateTarget).data("action");if((fe(e.target).closest("extracmd,.extracmd").length?o.extra_action:o.action).call(o,g,e,n,o.data),h.keepOpenOnClick)return t=fe(e.target).closest("ul"),"check"in o&&(t.find(".icon-check").hide(),t.find(".icon-minus").show(),(n=fe(e.target).closest("li")).find(".icon-check").show(),n.find(".icon-minus").hide()),f&&f(!1),!1;f&&f(!0)}),"check"in s&&(m=!0,n="function"==typeof s.check?s.check():s.check,i='<i class="icon icon-check"></i>',"string"==typeof s.check&&(i=s.check),(p=fe(i).prependTo(l)).addClass("check-icon"),d=fe('<i class="icon icon-minus check-icon"></i>').prependTo(l),(n?pg$Hide:(pg$Hide(p),pg$Show))(d),s.check_action&&p.add(d).on("click",function(e){s.check_action(e)}),s.check_value=n,s.setCheckValue=function(e){(e?(pg$Show(p),pg$Hide):(pg$Hide(p),pg$Show))(d),s.check_value=e},s.check_tooltip)&&addTooltip(p.add(d),s.check_tooltip),s.on_painted)&&s.on_painted.call(s,o))))}),m&&u.addClass("with-checkboxes")}},i=!1,B=function(e,t){if(!i&&(!e||e.sourceNode)){var n=x,o=null==x||null==e||x!=e;if(x=e,pinegrow.lastActivePage.setPage(null),o||t){var a,o=require("nw.gui").Window.get(),o=(a="PG"===pgf.product?pgf.product_name+(pinegrow.hasActivatedProduct("WP")?" - WP":""):pgf.product_name,x&&(a=!x.localFile&&crsaIsFileUrl(x.url)?x.name+" - "+a:(x.localFile||x.url||x.name)+" - "+a),o.title=a,fe("body").trigger("crsa-page-selected",x),pinegrow.dispatchEvent("on_page_selected",x),pinegrow.selectedElements.hasSelection()&&pinegrow.selectedElements.areAllFromTheSamePage()||!pinegrow.selectedElements.hasSelection());if(n&&(n.selectedElementsOnPage=o?pinegrow.selectedElements.getCollection().clone():null),x&&o){i=!0;try{x.selectedElementsOnPage&&0<x.selectedElementsOnPage.getLength()?(pinegrow.selectedElements.setCollection(x.selectedElementsOnPage),x.selectedElementsOnPage=null,pinegrow.selectedElements.reselect()):pinegrow.selectedElements.clear(),i=!1}catch(e){i=!1,console.error(e)}}}}},_=function(e){(new PgApi).removeElements(e)},v=function(e,t){(new PgApi).duplicateElements(e,null,t)},b=function(e,t){function n(e){if("a"==e.tagName||e.find("a").length||e.closest("a"))return"The element already has a link."}var o=new PgApi,a=new PgCollection,r=new PgCollection,i=["h1","h2","h3","h4","h5","h6","p"];pinegrow.getCollection(e).forEachElement(function(e){((0<=i.indexOf(e.tagName)||"inside"===t)&&"outside"!==t?r:a).add(e)});0<a.getLength()&&o.wrapWithElement(a,'<a href=""></a>',n),0<r.getLength()&&o.wrapContentWithElement(r,'<a href=""></a>',n)},C=function(e){var t=pinegrow.getCollection(e).clone(),r=new PgCollection;crsaWillChangeDom(),t.forEachElement(function(e,t,n){var o,a=new pgParserSourceProblem(e);e||a.add("element",e,"remove element"),a.ok()?canMakeChange(e,"remove_tags")&&(willMakeChange(x,"Remove element / "+e.getName()),o=e.getChildAtPos(0,!0),r.add(e.parent),e.detag(),pinegrow.selectedElements.isSelectedElement(e))&&(o?pinegrow.selectedElements.replace(e,o):pinegrow.selectedElements.remove(e)):showAlert(a.toString(),"Can't remove element")}),pinegrow.changeManager.didChange(r,"Remove tag"),pinegrow.showQuickMessage("Done.")},ne=(fe.fn.crsa.defaults={types:{},rulesDefintion:{},rules:{},variables:{},lib:{},frameworks:{}},fe.fn.crsa.addFramework=function(e){fe.fn.crsa.defaults.frameworks[e.key]=e},fe.fn.crsa.addLibSection=function(e,t){fe.fn.crsa.defaults.lib[e]={name:t,elements:[]}},fe.fn.crsa.addElementsToLibSection=function(e,t){var n;e in fe.fn.crsa.defaults.lib||(n="Lib section "+e+" not found.",window.console&&window.console.log&&window.console.log("CRSA - "+n)),fe.fn.crsa.defaults.lib[e].elements=fe.fn.crsa.defaults.lib[e].elements.concat(t)},fe.fn.crsa.addDefinition=function(e){"priority"in e||(e.priority=1e3),fe.fn.crsa.defaults.types[e.type]=e},fe.fn.crsa.addRulesDefinition=function(e){fe.fn.crsa.defaults.rulesDefinition=e},fe.fn.crsa.addVariablesSection=function(e,t){return e in fe.fn.crsa.defaults.variables||(fe.fn.crsa.defaults.variables[e]={name:t,list:{}}),fe.fn.crsa.defaults.variables[e]},fe.fn.crsa.addVariable=function(e,t,n,o,a){var r=fe.fn.crsa.addVariablesSection(a,a);return r.list[e]={name:t,type:n,value:o,key:e},r.list[e]},fe.fn.crsa.addRulesSection=function(e,t){},fe.fn.crsa.addRule=function(e,t,n,o){},null),oe=null,V=(window.beforeElementMovedWithMouse=function(){oe=fe("body").find(".page > .content:visible")},null);function s(){return null}window.getCodeFromDefinition=function(e){var t=fe.trim("function"==typeof e.code?e.code(s()):e.code);return t=0<=(t=0<=t.indexOf("$IMAGE_URL")?t.replace(/\$IMAGE_URL/g,pinegrow.getPlaceholderImage()):t).indexOf("$ELEMENT_ID")?t.replace(/\$ELEMENT_ID/g,getUniqueId("element")):t},window.createPgElFromDefinition=function(e){var t,n=getCodeFromDefinition(e);return n&&0!=n.length?((n=pgCreateNodeFromHtml(n)).hasChildren()&&n.setAttr("data-pg-collapsed",null),e&&e.empty_placeholder&&(t="string"==typeof e.empty_placeholder?e.empty_placeholder:"pg-empty-placeholder",""==fe.trim(n.html())?pgf.empty_ph_attribute?n.hasAttribute(pgf.empty_ph_attribute)||n.setAttribute(pgf.empty_ph_attribute):n.hasClass(t)||n.addClass(t):(pgf.empty_ph_attribute&&n.removeAttribute(pgf.empty_ph_attribute),t&&n.removeClass(t))),n):null},window.collapseNewPgelIfNeeded=function(e){if(!pgf.kids)if(e instanceof PgCollection)e.forEachElement(collapseNewPgelIfNeeded);else for(var t=0;t<e.children.length;t++)if(e.children[t].isElementOrScript)return void e.setAttribute("data-pg-collapsed",null)},window.createPgElFromDefinitionMultiple=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var o=getCodeFromDefinition(e);if(!o||0==o.length)return null;var a,r=new pgParser,i=(r.assignIds=!1,r.parse(o),[]),s=!0,l={},c=new PgCollection;r.rootNode.find("img").forEach(function(e){e.hasAttribute("src")||e.setAttribute("src",pinegrow.getPlaceholderImage())});for(var p=0;p<r.rootNode.children.length;p++)r.rootNode.children[p].isElementOrScript?(s?(a=r.rootNode.children[p],c.add(a),s=!1):(i.push(r.rootNode.children[p]),c.add(r.rootNode.children[p])),t&&r.rootNode.children[p].assignIdAndAddToCatalog(!0),n&&r.rootNode.children[p].emitEvent("nodeCreated",{html:r.rootNode.children[p].toStringWithIds()})):r.rootNode.children[p].textNode&&0<fe.trim(r.rootNode.children[p].content).length&&(l.text_nodes=!0);if(!a)return null;r.rootNode.validateTree().length&&(l.syntax_errors=!0);var d,o=a;return o.hasChildren()&&!pgf.kids&&o.setAttr("data-pg-collapsed",null),e&&e.empty_placeholder&&(d="string"==typeof e.empty_placeholder?e.empty_placeholder:"pg-empty-placeholder",""==fe.trim(o.html())?pgf.empty_ph_attribute?o.hasAttribute(pgf.empty_ph_attribute)||o.setAttribute(pgf.empty_ph_attribute):o.hasClass(d)||o.addClass(d):(pgf.empty_ph_attribute&&o.removeAttribute(pgf.empty_ph_attribute),d&&o.removeClass(d))),l.pgel=o,l.rest=i,l.collection=c,l},window.createElementFromDefinition=function(e,t){var n,o=getCodeFromDefinition(e);if(!o||0==o.length)return null;t&&(o=o.replace(/<script/g,"<ascript").replace(/<\/script/g,"</ascript")),t||((n=pgCreateNodeFromHtml(o)).hasChildren()&&!pgf.kids&&n.setAttr("data-pg-collapsed",null),(r=pinegrow.getSelectedPage())&&pgCurrentRequestContext.setCurrentRequestContext(r.url,r.sourceNode),n.findIncludingSelf("img").forEach(function(e){e.hasAttribute("img")||e.setAttribute("src",pinegrow.getPlaceholderImage())}),o=n.toStringWithIds(!0,null,pgCurrentRequestContext.createProxyUrlNodeOutputFilter));var a,r=fe("<div/>").append(o).contents(),o=fe(r.get(0));return o.data("crsa-def",e),(o.get(0).crsaDef=e)&&e.empty_placeholder&&(a="string"==typeof e.empty_placeholder?e.empty_placeholder:"pg-empty-placeholder",o=0==o.get(0).innerHTML.length||""==fe.trim(o.html()),n)&&(o?pgf.empty_ph_attribute?n.hasAttribute(pgf.empty_ph_attribute)||n.setAttribute(pgf.empty_ph_attribute):n.hasClass(a)||n.addClass(a):(pgf.empty_ph_attribute&&n.removeAttribute(pgf.empty_ph_attribute),a&&n.removeClass(a))),r};var P=function(e){var t=e.pgStylesheet,n=pinegrow.pgPostCSSHelper.getNodeByIndices(t.getRootNode(),e.indices);return{pgStylesheet:t,rule:n}},me=function(e,t,n){return t.responsive_class?t.responsive_class(e,n):e};window.getValuesForObject=function(l,e){if(l instanceof pgParserNode){var c,p,d,g=l,t=new pgParserSourceProblem(g,null,!0);if(g||t.add("element",g.getName(),"change"),t.ok())return c=fe("div.canvas"),u={},p=null,l instanceof pgParserNode&&(p=l.getPage()),n=getDefinitionForObject(l,null,p),!e&&n&&(e=n.sections?Object.values(n.sections):null),d=p?p.classSetter:pgDefaultClassSetter,e&&fe.each(e,function(e,t){t.fields&&fe.each(t.fields,function(n,o){var e,t,a,r,i,s=o.action||"style";o.get_value?u[n]=o.get_value(g,n,u,o,p):"none"!=s&&("style"==s?(e||(t=g.getAttr("id"))&&(e=c.crsacss("find","#"+t)),e&&0<e.length&&(t=c.crsacss("getCss",e,n))&&("image"==o.type&&(t=t.replace(/url\(/g,"").replace(/\"/g,"").replace(/\'/g,"").replace(/\)/g,"")),u[n]=t)):"apply_class"===s?(r=_e(o,g))?(u[n]=null,fe.each(r,function(e,t){if(d.hasClass(g,me(t.key,o,g))&&(u[n]||(u[n]=""),u[n]+=" "+t.key,d.class_setter_info&&(u[n+".class_setter_info"]=d.class_setter_info),!o.multiple))return!1}),u[n]&&(u[n]=u[n].trim())):o.value&&(u[n]=d.hasClass(g,me(o.value,o,g))?o.value:null,d.class_setter_info)&&(u[n+".class_setter_info"]=d.class_setter_info):"apply_class_multiple"===s?(a=[],(r=_e(o,g)).forEach(function(e){d.hasClass(l,e.key)&&a.push(e.key)}),u[n]=a.join(",")):"element_id"==s?u[n]=g.getAttr("id"):"element_attribute"==s?o.empty_attribute&&o.value?g.hasAttr(o.attribute)&&(u[n]=o.value):u[n]=g.getAttr(o.attribute):"element_html"==s?u[n]=fe.trim(g.html()):"rules"==s&&(R.showOnlyClassesInProperties?(i=[],fe.each($el.get(0).classList,function(e,t){i.push("."+t)}),u[n]=i):u[n]=g.getClasses())),o.on_got_value&&o.on_got_value(n,o,u[n],g,r)})}),u;throw t}var u,s,f,n,h;return l.hasOwnProperty("indices")?(u={},t=P(l),s=t.rule,f=t.pgStylesheet,n=getDefinitionForObject(l),h=f.getPropValuePairFor(s),n&&n.sections&&fe.each(n.sections,function(e,t){fe.each(t.fields,function(e,t){var n,o,a,r,i=t.action||"style";t.get_value?u[e]=t.get_value(l,e):"style"==i&&h?(n=h[e]||null)&&(o=n.value,"image"==t.type&&(o=o.replace(/url\(/g,"").replace(/\"/g,"").replace(/\'/g,"").replace(/\)/g,"")),u[e]=n.value):"rule_name"==i?u[e]=f.filterSource(s.selector):"rule_media"==i?(a=pinegrow.pgPostCSSHelper.getMediaNode(s),r=pinegrow.pgPostCSSHelper.getAtRuleValue(a),u[e]=r||null):"rule_supports"==i&&(a=pinegrow.pgPostCSSHelper.getSupportsAtruleNode(s),r=pinegrow.pgPostCSSHelper.getAtRuleValue(a),u[e]=r||null)})}),u):{}},window.getDefinitionForObject=function(e,t,n){if(e instanceof pgParserNode)return(n=n||e.getPage())?n.getMainType(null,e):null;switch((e=e.hasOwnProperty("indices")?P(e).rule:e).type){case"element":return(n=n||getCrsaPageOfElement(e.data))?n.getMainType(null,getElementPgNode(e.data)):null;case"rule":return fe.fn.crsa.defaults.rulesDefinition}return null},window.crsaQuickMessage=function(e,t,n,o){var a,r,i,s,l,c;if(t=t||2500,!pinegrow.adaptor||!pinegrow.adaptor.canShowQuickMessage())return a=100,"1"!==pinegrow.getSetting("disable-quick-messages","0")||o?(l=fe(window).height()+5,r=!0,p>fe(window).width()/2&&.6*l<d&&(r=!1),i=l,(s=fe(".quick-message")).each(function(e,t){var n,o;s.length-1===e&&(n=fe(t),o=parseInt(n.css("top")),a<=o&&(a=o+n.outerHeight()+-4),o<i&&(i=o+8),0)}),l<a+50&&(a=100),i<100&&(i=l),n&&0<s.length?void 0:(l=t<0?'<i class="fa fa-refresh fa-spin"></i>&nbsp;':"",(c=fe("<div/>",{class:"quick-message"+(o?" quick-message-error":"")+(r?" quick-message-right":"")}).html("<p>"+l+e+"</p>").appendTo(fe("body")).css("opacity",1)).outerHeight(),c.css("top",a+"px"),c.on("mousemove",function(e){c.removeMessage(!0)}),c.removeMessage=function(e){c.animate({opacity:0},e?100:500,function(){c.remove()}),c.off("mousemove"),setTimeout(function(){c.remove()},1e3)},0<t&&setTimeout(function(){c.removeMessage()},t),c)):null;pinegrow.adaptor.showQuickMessage(e,o?"error":"info")},window.crsaGetCustomLogic=function(){return R};var f=function(e){try{e.loaded}catch(e){}};function pe(e,t,n,o,a,r,i){void 0===r&&(r=t.contents().scrollLeft()),void 0===i&&(i=t.contents().scrollTop()),a=a||t.position();var s=n,l=s.left*o+a.left-r*o,c=s.top*o+a.top-i*o,p={left:l+"px",top:c+"px"};"right"in n?(p.left="auto",p.right=s.right*o+a.left-r*o,e.css(p)):pg$PositionAt(e,l,c)}var G={$e:null,pos:null,$line:fe("<div/>",{class:"insertion-line",style:"height:2px;"}),$name:fe("<div/>",{class:"insertion-line-name"}),$center:fe('<div class="insertion-line-center"><span>Collapsed element - Hold <kbd>SHIFT</kbd> to insert inside</span></div>'),center_shown:!1};function q(L,N,$,j,W,H,R){var U;void 0===H&&(H=!1),!j&&!$&&L&&G.$e&&G.$e.is(L)&&G.pos===N&&G.center_shown===H||(U=pgFastdomTasks.create("showInsertionLine"),L?U.measure(function(){var e,t,n,o,a,r,i,s,l,c,p,d,g,u,f,h,m,w,_,v,b,y,P,k,C,S,E,T,I,A,x,M,D,O,F;($iframe=getIframeOfElement(L))&&(t=(e=$iframe.get(0)).parentNode,n=L.get(0),$page=$iframe.parent(),o=t.getBoundingClientRect(),a=e.getBoundingClientRect(),r={left:a.left-o.left,top:a.top-o.top},i=getCrsaPageForIframe($iframe).zoom,s=e.contentWindow.scrollX,l=e.contentWindow.scrollY,(c=n.getBoundingClientRect()).left=c.x=c.left+s,c.top=c.y=c.top+l,p=!1,d=parseInt(L.css("padding-left")),g=d*i,u=parseInt(L.css("padding-right")),f=u*i,h=parseInt(L.css("padding-top")),m=h*i,w=parseInt(L.css("padding-bottom")),_=w*i,v=parseInt(L.css("margin-top")),b=parseInt(L.css("margin-bottom")),y=parseInt(L.css("margin-left")),parseInt(L.css("margin-right")),P=L.innerWidth()-d-u,k=P*i,C=L.innerHeight()-h-w,S=C*i,j&&(d=g=u=f=h=m=w=_=v=b=y=0,c.left=c.x=j.left+c.left,c.top=c.y=j.top+c.top,P=j.width,k=P*i,C=j.height,S=C*i),E=t.clientWidth,T=t.clientHeight,A=I=0,x=null,M=!1,D=G.$line,O=G.$name,F=function(e){e.get(0).parentNode!==$page.get(0)&&e.appendTo($page)},K(L,null,!1,j),U.mutate(function(){F(D),F(O),G.$e=L,G.pos=N,pg$Show(D);var e,t,n,o=22;H&&0?(G.center_shown||(G.center_shown=!0,pg$Show(G.$center,"flex")),t={width:(e=crsaGetPositionOverElementCenterPosition(P+d+u,C+h+w,c.left,c.top)).w,height:e.h,transform:`scale(${1})`},e.w<50?G.$center.get(0).classList.add("small"):G.$center.get(0).classList.remove("small"),G.$center.css(t),pe(G.$center,$iframe,{left:e.left,top:e.top},i,r,s,l),G.$center.appendTo($page)):G.center_shown&&(G.center_shown=!1,pg$Hide(G.$center)),$?((n=D).css({width:2+"px",height:$.height*i+"px"}),pe(n,$iframe,{left:$.left,top:$.top},i,r,s,l),F(n),pg$Hide(O)):(pg$Show(O),"top"===N?((n=D).css({width:k+g+f+"px",height:2+"px"}),pe(n,$iframe,{left:A=c.left,top:I=c.top-v},i,r,s,l),F(n),x="Insert before",p=!0):"bottom"===N?((n=D).css({width:k+g+f+"px",height:2+"px"}),pe(n,$iframe,{left:A=c.left,top:I=c.top+h+C+w+b},i,r,s,l),F(n),x="Insert after"):"left"===N?((n=D).css({width:2+"px",height:m+S+_+"px"}),pe(n,$iframe,{left:A=c.left-y,top:I=c.top},i,r,s,l),F(n),x="Insert before",M=!0):"right"===N?((n=D).css({width:2+"px",height:m+S+_+"px"}),pe(n,$iframe,{left:A=c.left+d+P+u,top:I=c.top},i,r,s,l),F(n),x="Insert after",A+=o/i,p=M=!0):"inside-top"===N?((n=D).css({width:k+g+f-16+"px",height:2+"px"}),pe(n,$iframe,{left:A=c.left+8,top:I=c.top+(h<4?4:h)},i,r,s,l),F(n),x=pgf.kids?"Place inside":"Prepend",p=!0):"inside-bottom"===N&&((n=D).css({width:k+g+f-16+"px",height:2+"px"}),pe(n,$iframe,{left:A=c.left+8,top:I=c.top+h+C-(w<4?4:0)},i,r,s,l),F(n),x=pgf.kids?"Place inside":"Append"),H?x+=` collapsed - <span class="pg-collapse-shift-notice">Hold <kbd>SHIFT</kbd> to insert inside ${R||""}</span>`:R&&(x+=" "+R),W&&(x=W),c.top,(n=O).get(0).innerHTML=x,M?(O.addClass("insertion-line-name-vertical"),E<A+o/i&&(A-=o/i),p?O.addClass("insertion-line-name-top"):O.removeClass("insertion-line-name-top")):(O.removeClass("insertion-line-name-vertical"),(p=T+l*i<I+o/i?!0:p)&&o/i<I?(I-=o/i,O.addClass("insertion-line-name-top")):O.removeClass("insertion-line-name-top")),pe(n,$iframe,{left:M?A:A+0,top:M?I+0:I},i,r,s,l))}))}):(G.$e=null,U.mutate(function(){pg$Hide(G.$line),pg$Hide(G.$name),G.center_shown&&(pg$Hide(G.$center),G.center_shown=!1)})))}function K(n,o,e,t){if(n instanceof pgParserNode&&(n=n.get$DOMElement()),t||!g||!n||!g.is(n)||g.length!=n.length||e){if(n){var a=n.get(0);if(a&&(a.hasAttribute("data-pg-allow-click")||a.hasAttribute("data-pg-external-link")))return}function r(e,t,n){n=n||0;var o=e.get(0).querySelector(t+n);return o=o?fe(o):(t=t.replace(/\./g," "),fe("<div/>",{class:"crsa-hl-overlay "+t+" "+t+n}).appendTo(e))}var i,s,l,c;pgFastdomTasks.stopAll("unhighlightElements"),pgFastdomTasks.stopAll("highlightElements"),g&&(i=pgFastdomTasks.create("unhighlightElements"),s=g,i.measure(function(){var o,e=getIframeOfElement(s);e&&(l=getCrsaPageForIframe(e))&&(o=[],l.getPageViews().forEach(function(e){for(var t=e.get$Iframe().parent().get(0).querySelectorAll(".crsa-hl-overlay"),n=0;n<t.length;n++)o.push(t[n])}),o.length)&&i.mutate(function(){o.forEach(function(e){pgHide(e)})})}));n&&0<n.length?(a=getIframeOfElement(n))&&(l=getCrsaPageForIframe(a),a.parent(),c=l.getPageViewOf$DOMElement(n,a),g=n,highlightElementsInPageView(c,n,o,r,null,null,null,null,null,t),l)&&!t&&l.getPageViews().forEach(function(e){var t;e!=c&&(t=e.getEquvivalent$DOMElements(n))&&t.length&&highlightElementsInPageView(e,t,o,r)}):g=null}}window.highlightElementsInPageView=function(ee,e,te,ne,a,r,t,oe,ae,re,ie,se){t=t||"";var n,le,ce=getIframeOfElement(e);if(ce&&getCrsaPageForIframe(ce))return n=ce.data("pg-iframe-id"),le=ee.getFastdomManager().create("highlightElements"+t,n),a=a||"crsa-hl-overlay",r=r||"",ne=ne||function(e,t,n){var o="."+a+t+r+t+r+(n=n||0),o=e.get(0).querySelector(o);return o||(t=t.replace(/\./g," "),(o=document.createElement("div")).setAttribute("class",a+" "+a+r+" "+t+r+" "+t+r+n),e.get(0).append(o)),o=fe(o)},le.measure(function(){var K=ee.zoom,z=[],Q=ce.parent(),Y={left:0,top:0},Z=ce.contents().scrollLeft(),J=ce.contents().scrollTop(),X=Math.min(e.length,10);e.each(function(e,t){if(e==X)return!1;for(var N=e==X-1,o=fe(t),n=t.getBoundingClientRect(),$=!1,a=n,r=t;0===a.left&&0===a.top&&0===a.width&&0===a.height&&r.parentNode&&"BODY"!==r.nodeName;)$=!0,a=(r=r.parentNode).getBoundingClientRect();$&&(n.x=n.left=a.left,n.y=n.top=a.top);var s,l,i,c={},p=t.ownerDocument.defaultView.getComputedStyle(t),d=parseFloat(p.zoom||1),g=("HTML"==t.nodeName&&(d=1),parseInt(p.paddingLeft)),u=g*K*d,f=parseInt(p.paddingRight),h=f*K*d,m=parseInt(p.paddingTop),w=m*K*d,_=parseInt(p.paddingBottom),v=_*K*d,b=parseInt(p.marginTop),j=b*K,W=parseInt(p.marginBottom)*K,y=parseInt(p.marginLeft),H=y*K,R=parseInt(p.marginRight)*K,U=parseInt(p.borderTopWidth),B=parseInt(p.borderBottomWidth),V=parseInt(p.borderLeftWidth),G=parseInt(p.borderRightWidth),P=n.width*d-g-f,k=n.height*d-m-_,C=("border-box"!==p.boxSizing&&(P+=V+G,k+=U+B),P*K),S=k*K,q=(c.top=n.top*d+t.ownerDocument.defaultView.scrollY,c.left=n.left*d+t.ownerDocument.defaultView.scrollX,re&&(g=u=f=h=m=w=_=v=b=j=W=y=H=R=0,c.left=(re.left+c.left)*d,c.top=(re.top+c.top)*d,P=re.width,C=P*K,k=re.height,S=k*K),pinegrow.selectedElements.isSelected$Element(o)),E=ne(Q,".crsa-hl-size",se||e),T=ne(Q,".crsa-hl-padding-top",se||e),I=ne(Q,".crsa-hl-padding-bottom",se||e),A=ne(Q,".crsa-hl-padding-left",se||e),x=ne(Q,".crsa-hl-padding-right",se||e),M=ne(Q,".crsa-hl-margin-top",se||e),D=ne(Q,".crsa-hl-margin-bottom",se||e),O=ne(Q,".crsa-hl-margin-left",se||e),F=ne(Q,".crsa-hl-margin-right",se||e),L=(ie||(s=ne(Q,".crsa-hl-name",se||e)),getElementPgNode(o));L?(l=L.getName({short:!0,classes_filter:ee.getPage().getShowNameClassesFilter()}),"a"===L.tagName&&(i=L.getAttribute("href"))):(l=getElementName(o,null,!1,!0,!1,!0),"A"===t.tagName&&(i=t.getAttribute("href"))),l+=` | ${Math.round(100*n.width)/100} &times; `+Math.round(100*n.height)/100,i&&(i=pinegrow.getOriginalUrl(i),l+=" | "+i),re&&re.name&&(l=re.name),ae&&ae(le),le.mutate(function(){function e(e){var t=e.get(0);pgShow(t),t.parentNode!==Q[0]&&e.appendTo(Q)}var t=E.get(0),n=(te?E.css("border-color",te):E.css("border-color",""),C+u+h),n=(pg$CSS(E,{width:n+"px",height:S+w+v+"px"}),pe(E,ce,{left:c.left,top:c.top},K,Y,Z,J),e(E),z.push(t),L||getElementPgNode(o)),n=(!n||n.dynamic?t.classList.add("dyn"):t.classList.remove("dyn"),pg$CSS(T,{width:C+u+h+"px",height:w+"px"}),pe(T,ce,{left:c.left,top:c.top},K,Y,Z,J),e(T),z.push(T.get(0)),pg$CSS(I,{width:C+u+h+"px",height:v+"px"}),pe(I,ce,{left:c.left,top:c.top+m+k},K,Y,Z,J),e(I),z.push(I.get(0)),pg$CSS(A,{width:u+"px",height:S+"px"}),pe(A,ce,{left:c.left,top:c.top+m},K,Y,Z,J),e(A),z.push(A.get(0)),pg$CSS(x,{width:h+"px",height:S+"px"}),pe(x,ce,{left:c.left+g+P,top:c.top+m},K,Y,Z,J),e(x),z.push(x.get(0)),pg$CSS(M,{width:C+u+h+"px",height:j+"px"}),pe(M,ce,{left:c.left,top:c.top-b},K,Y,Z,J),e(M),z.push(M.get(0)),pg$CSS(D,{width:C+u+h+"px",height:W+"px"}),pe(D,ce,{left:c.left,top:c.top+m+k+_},K,Y,Z,J),e(D),z.push(D.get(0)),pg$CSS(O,{width:H+"px",height:w+S+v+"px"}),pe(O,ce,{left:c.left-y,top:c.top},K,Y,Z,J),e(O),z.push(O.get(0)),pg$CSS(F,{width:R+"px",height:w+S+v+"px"}),pe(F,ce,{left:c.left+g+P+f,top:c.top},K,Y,Z,J),e(F),z.push(F.get(0)),c.top-14/K),i=(ie||(s.get(0).innerHTML=l,(n<J+20||q)&&(n=c.top+m+k+_),pe(s,ce,{left:c.left,top:n},K,Y,Z,J),e(s),z.push(s.get(0))),{});N&&oe&&oe(z,function(e,t,n,o,a){var r=o;i[r]||(i[r]=[]),i[r].push({$point:e,point_w:t,point_h:n,placement:o,skip_show:a})}),fe.each(i,function(n,e){var o=20/K,t=0,a=n.startsWith("right")||n.startsWith("left"),r=(e.forEach(function(e){t+=a?e.point_h:e.point_w}),t+=(e.length-1)*o,a?m+k/2-t/2:g+P/2-t/2),i=(r<10&&(r=10),6);e.forEach(function(e){if(!e.skip_show)switch(n){case"center":pe(e.$point,ce,{left:c.left+(g+P/2)-e.point_w/2/K,top:c.top+(m+k/2)-e.point_h/2/K},K,Y,Z,J);break;case"right":pe(e.$point,ce,{left:c.left+g+P+f-e.point_w/2/K,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"right-outside":pe(e.$point,ce,{left:c.left+g+P+f+i/K,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"right-inside":pe(e.$point,ce,{left:c.left+g+P+f-(e.point_w+i)/K,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"left":var t=c.left-e.point_w/2/K;pe(e.$point,ce,{left:t=t<0?0:t,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"left-outside":t=c.left-(i+e.point_w)/K;pe(e.$point,ce,{left:t=t<0?0:t,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"left-inside":t=c.left+i/K;pe(e.$point,ce,{left:t=t<0?0:t,top:c.top+r-e.point_h/2/K},K,Y,Z,J);break;case"top":pe(e.$point,ce,{left:c.left+r-e.point_w/2/K,top:c.top},K,Y,Z,J);break;case"bottom":pe(e.$point,ce,{left:c.left+r-e.point_w/2/K,top:c.top+m+k+_-e.point_h/2/K},K,Y,Z,J);break;case"bottom-outside":pe(e.$point,ce,{left:c.left+r-e.point_w/2/K,top:c.top+m+k+_+i/2/K},K,Y,Z,J);break;case"bottom-inside":pe(e.$point,ce,{left:c.left+r-e.point_w/2/K,top:c.top+m+k+_-(i+e.point_h)/K},K,Y,Z,J);break;case"inside-top-left":pe(e.$point,ce,{left:c.left+8,top:c.top+8},K,Y,Z,J)}r+=(a?e.point_h:e.point_w)+o})})})})}),le},window.getTreeRootForElement=function(e,t){return R&&R.getTreeRootForElement?R.getTreeRootForElement(e,t):t?fe(getIframeBody(t.get(0))).parent():null};function z(e,t,n,o,a,r){e&&(e instanceof pgParserNode?e=(l=e).get$DOMElement():console.log("Select element with $el")),new CrsaProfile;var i,s,l,c="tree"===t,p=(r=r||{},null),d=pinegrow.selectedElements.getLastSelected(),d=(d&&(p=d.get$DOMElement()),(e=e&&1!=e.get(0).nodeType?null:e)?getIframeOfElement(e):p?getIframeOfElement(p):null);(d||c)&&(d=getCrsaPageForIframe(d)||l?.getPage(),e&&d&&(i=getElementPgNode(e))&&i.document!=d.sourceNode||(!i&&c&&(i=l),null!=x&&x==d||B(d),l=null,((p=e||null)||c)&&i&&(l=d.getMainType(null,i),d.selected_element_pgid=getElementPgId(p),n?"shift"===n?(s=pinegrow.selectedElements.addRange(i,r))||pinegrow.showQuickMessage("Can only SHIFT select elements on the same level.",4e3,!1,"error"):s=pinegrow.selectedElements.addOrRemove(i,r):s=pinegrow.selectedElements.select(i,r),s)&&(l=d.getMainType(null,i))&&l.on_selected&&l.on_selected(i),i&&(i.user_action=t,fe("body").trigger("crsa-element-selected",i),i.user_action=null),x&&x.callFrameworkHandler("on_element_selected",i,{clicked_element:o,event:a})))}window.repositionSelectedElementMenu=function(e){pinegrow.selectedElements.repositionMenus(e)},window.addAsComponent=function(e,n){var t,o,a;"body"==e.tagName||e.find("body").length||!e.closest("body")?showAlert("BODY and HEAD elements can't be added as snippet","Notice"):(t=e.getPage(),n||fe.each(t.frameworks,function(e,t){if(t.user_lib)return n=t,!1}),n||((n=new PgFramework("userlib"+Math.floor(1e5*Math.random()),"User Lib")).user_lib=!0,pinegrow.addFramework(n),t.addFramework(n)),0<n.lib_sections.length?o=n.lib_sections[0]:(o=new PgFrameworkLibSection(n.key+"_components","Snippets"),n.addLibSection(o)),a=n.getAutoId("comp"),a=new PgComponentType(a.type,"Comp "+a.count),copyElementToDef(e,a,t,!0),n.addComponentType(a),o.addComponentType(a),n.changed=!0,pinegrow.frameworksChanged(),crsaQuickMessage("Snippet was added to LIB."))},window.copyElementToDef=function(e,n,t,o){var a=t.getAllTypes(null,e),r=(n.code=e.toStringOriginal(!0,pinegrow.getFormatHtmlOptions()),n.parent_selector=null,n.preview=null,!o);fe.each(a,function(e,t){if(t.name&&!r&&(r=!0,n.name+=" / "+t.name),t.parent_selector)return n.parent_selector=t.parent_selector,!1})},window.getElementPositionOnScreen=function(e,t){return getPageViewOfElement(e).get$ElGlobalRect(e)},window.getElementPositionInCanvas=function(e,t){var n,o,a,r;if(t=t||getIframeOfElement(e))return n=getCrsaPageForIframe(t),n=M.crsapages("getZoom",n),o=t.position(),a=t.closest(".page").position(),{left:(r=e?e.offset():{top:0,left:0}).left*n+o.left+0*a.left,top:r.top*n+o.top+a.top+M.scrollTop()-t.contents().scrollTop()*n,width:e?e.outerWidth():0,height:e?e.outerHeight():0}},window.getElementPositionOnPage=function(e,t){var n,o,a;if(t=t||getIframeOfElement(e))return n=getCrsaPageForIframe(t),n=M.crsapages("getZoom",n),o=t.position(),a=t.parent().position(),o.left+=a.left,o.top+=a.top,{left:(a=e?e.offset():{left:0,top:0}).left*n+o.left,top:a.top*n+o.top-t.contents().scrollTop()*n,width:e?e.outerWidth()*n:0,height:e?e.outerHeight()*n:0}},window.showAutoCompleteOnInput=function(e){var t;e.on("inputRead",function(r){clearTimeout(t),r.state.completionActive||(t=setTimeout(function(){try{if("1"==pinegrow.getSetting("code-autocomplete","1")&&r.showHint){var e=r.getDoc().getCursor(),t=r.getModeAt(e);if(t&&"xml"==t.name)for(var n=r.getDoc().getLine(e.line),o=0,a=e.ch-1;0<=a;a--){if("<"==n.charAt(a))r.showHint(r);else if(">"==n.charAt(a)||1e3<o)break;o++}else(n=r.getDoc().getLine(e.line)).charAt(e.ch-1).match(/[a-z0-9\-]/)&&r.showHint(r)}}catch(e){}},300))})};var k={x:0,y:0};window.showCodeEditorUnder=function(t,e,n,o,a,r){t.on("keydown",function(e){27==e.which&&(t.find("button.ok").trigger("click"),e.preventDefault())}),t.addClass("code-edit");var i=!1,s=fe('<div class="cm-source-content"></div>').appendTo(t),l=null,c=CodeMirror(function(e){l=fe(e),s.append(l)},pinegrow.populateCodeMirrorOptions({mode:e,autoFocus:!0,lineWrapping:!0,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseTags:!0,matchTags:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],profile:"xhtml",hintOptions:{completeSingle:!1},pgWindow:s.get(0).ownerDocument.defaultView})),p=(showAutoCompleteOnInput(c),setLightDarkClassForEditor(l,pinegrow.getSetting("code-theme-cm",pinegrow.defaults.codeTheme)),pinegrow.code_editors.register(c),l.attr("data-has-codemirror","").data("codeMirrorInstance",c),"true"===pinegrow.getSetting("editor-emmet",pgf.default_emmet_setting)&&emmetCodeMirror(c),setTimeout(function(){c.focus()},100),!0);c.on("change",function(){o(p),p=!1,i&&0,i=!0});return{mirror:c,dialog:t,editor_el:l,close:function(){r(),pinegrow.code_editors.unregister(c)}}},window.showCodeEditor=function(e,t,n,o,a,r){function i(){r(),l.hide(),l.remove(),pinegrow.code_editors.unregister(m)}var s=fe("body"),l=makeDialog(t,"Cancel","Close &amp; Keep changes [Esc]","<div></div>").css("width","50%").addClass("crsa-dialog-edit"),c=(s.append(l),l.on("keydown",function(e){27==e.which&&(l.find("button.ok").trigger("click"),e.preventDefault())}),l.addClass("code-edit"),!1),p=!1,d=!1,g=200,u=500,f=l.find(".modal-body>div"),h=null,m=CodeMirror(function(e){h=fe(e),f.append(h.css("height","100%"))},pinegrow.populateCodeMirrorOptions({mode:e,autoFocus:!0,lineWrapping:!0,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseTags:!0,matchTags:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],profile:"xhtml",hintOptions:{completeSingle:!1}})),w=(showAutoCompleteOnInput(m),setLightDarkClassForEditor(h,pinegrow.getSetting("code-theme-cm",pinegrow.defaults.codeTheme)),pinegrow.code_editors.register(m),h.attr("data-has-codemirror","").data("codeMirrorInstance",m),"true"===pinegrow.getSetting("editor-emmet",pgf.default_emmet_setting)&&emmetCodeMirror(m),fe('<label class="pull-left control-label" style="font-weight: normal;"><input type="checkbox" class="wrap"> Wrap lines</label>')),_=(l.find(".modal-footer").prepend(w),"1"==pinegrow.getSetting(n+"-wrap","1")?(w.find("input").attr("checked","checked"),m.setOption("lineWrapping",!0)):(w.find("input").removeAttr("checked"),m.setOption("lineWrapping",!1)),w.on("change",function(){var e=w.find("input").is(":checked");m.setOption("lineWrapping",e),pinegrow.setSetting(n+"-wrap",e?"1":"0")}),setTimeout(function(){m.focus()},100),m.on("change",function(){d=o(),p&&(c=!0),p=!0}),l.find("button.cancel").click(function(){c&&!m.getOption("readOnly")?showAlert("<p>Are you sure you want to cancel? Code changes will be lost.</p>","Confirmation","Don't close","Close it",function(){},function(){i()}):i()}),l.find("button.close, button.ok").click(function(){function e(){a(),l.hide(),l.remove(),pinegrow.code_editors.unregister(m)}c&&d&&!m.getOption("readOnly")?showAlert("<p>Are you sure you want to close the editor? The code has syntax errors and code changes were not applied to the document.</p>","Code has syntax errors","Don't close","Close it",function(){},function(){e()}):e()}),n&&(g=parseInt(pinegrow.getSetting("editor_"+n+"_h",g)),u=parseInt(pinegrow.getSetting("editor_"+n+"_w",u))),f.css("height",g+"px"),l.css("width",u+"px"),l.height()-f.height()),v=s.width()-l.width()-100,b=s.height()-l.height()-200,y=l.height(),v=parseInt(pinegrow.getSetting("editor_"+n+"_x")),b=parseInt(pinegrow.getSetting("editor_"+n+"_y"));return 0==fe(".crsa-dialog-edit:visible").not(l).length?(k.x=80,k.y=60):(v+=k.x,b+=k.y,k.x+=80,k.y+=60),(v=v+u>s.width()?s.width()-u:v)<0&&(v=0),(b=b+y+40>s.height()?s.height()-y-40:b)<0&&(b=0,f.css("height",(g=150)+"px"),pinegrow.setSetting("editor_"+n+"_h",g)),l.css("top",b+"px").css("left",v+"px"),l.find(".modal-header").css("cursor","move"),l.draggable({handle:".modal-header"}).on("dragstart",function(){fe.fn.crsapages("showOverlays")}).on("dragstop",function(){fe.fn.crsapages("showOverlays",!0),m.refresh(),pinegrow.setSetting("editor_"+n+"_y",l.css("top").replace("px","")),pinegrow.setSetting("editor_"+n+"_x",l.css("left").replace("px",""))}),l.resizable({minHeight:200,minWidth:400,resize:function(e,t){var n=t.size.height-_;f.css("height",n+"px")},start:function(e,t){fe.fn.crsapages("showOverlays")},stop:function(e,t){fe.fn.crsapages("showOverlays",!0),m.refresh(),n&&(pinegrow.setSetting("editor_"+n+"_h",t.size.height-_),pinegrow.setSetting("editor_"+n+"_w",t.size.width))}}),{mirror:m,dialog:l,editor_el:h,close:function(){c=!1,i()}}};function we(e,p,t,n,o,d){d=d||we;function a(e,t,n){t!==p||n.source&&n.source===d||h()}function r(e,t,n){var o=pinegrow.selectedElements.getLastSelected();p=o,h()}var i,s,l=fe("<ul/>",{class:""}).appendTo(e),c=fe("<button/>",{class:"pg-button pg-add-class-button",style:""}).html('<i class="icon icon-plus"></i> Add class'),g=(pgf.kids||c.insertAfter(l),c.on("click",function(e){e.preventDefault(),f(fe(e.delegateTarget))}),pinegrow.isClassTreeSupported()&&((i=fe("<button/>",{class:"pg-button pg-add-class-button"}).html('<i class="icon icon-Pin11" style="font-size: 13px;"></i>')).insertAfter(c),i.on("click",function(e){e.preventDefault(),pinegrow.showClassTree(e.altKey)}),addTooltip(i,`Show classes in editable tree view. ${pgShowKbd("ALT")} + Click to open in floating panel.`)),l.on("click",".crsa-input-rule-remove",function(e){var t=fe(this).parent().attr("data-class");(new PgApi).removeClass(null,t),e.preventDefault(),e.stopPropagation()}),l.on("click","li.pg-class-button",function(e){var n,o,a,t,r,i,s=fe(this),l=s.attr("data-class"),c={class:l,done:!1,prop:{name:null,options:null},actions:[]};if(!e.altKey&&(p.getPage().callFrameworkHandler("on_get_class_prop_options",c),c.prop.options))return r=null,n=c.prop.options.map(function(e){return e.key}),o=function(){var e=new PgApi,t=this.key;s.attr("data-class",t),r&&(r.destroy(),r=null),t?(e.addClass(null,t,{source:d},n),s.find("span").html(escapeHtmlCode(t))):e.removeClass(null,n,{})},r=new PgFastDOMClassPreviewForPgel(p,""),c.prop.colors?(a=fe('<input type="hidden" />').val(l),i=new PgColorPicker(a,c.prop.colors,c.prop.name||"Color",function(){return{}},{on_color_highlighted:function(e){r&&e&&r.setClass(e,c.prop.options)},on_show:function(){},on_value_set:function(){r&&(r.destroy(),r=null)},on_hide:function(){r&&(r.destroy(),r=null)}}),a.on("change",function(e){var t=a.val();o.call({key:t})}),i.showWithPosition(s)):(t=[],c.actions.length&&(c.actions.forEach(function(e){t.push(e)}),t.push({type:"divider"})),c.prop.name&&t.push({type:"header",label:"Set "+c.prop.name}),c.prop.options.forEach(function(e){t.push({label:e.name,key:e.key,check:e.key===l,action:o,on_mouseenter:function(){r.setClass(e.key,c.prop.options)},on_mouseleave:function(){r.restore()}})}),t.push({type:"divider"}),t.push({label:'<i class="icon icon-close" style="color:white;margin-right:8px;"></i> Clear',key:null,action:o}),(i=new CrsaContextMenu(t,s)).showForElement(s,null,8),i.onClosed=function(){r&&(r.destroy(),r=null)}),c.done=!0,!1;p.getPage().callFrameworkHandler("on_class_button_clicked",c),c.done||(i=new PgApi,p.hasClass(l)?(i.removeClass(null,l,{source:we}),s.addClass("class-off")):(i.addClass(null,l,{source:we}),s.removeClass("class-off"))),e.preventDefault(),e.stopPropagation()}),new PgClassButtonHelper(l,p,d),e.closest(".clearable-area").on("crsa-will-clear-area",u)),u=function(){pinegrow.removeEventHandler("on_selected_elements_changed",r),pinegrow.removeEventHandler("on_page_changed",a),pgf.kids&&pinegrow.removeEventHandler("on_insight_css_reindexed",s),g.off("crsa-will-clear-area",u)},f=(pinegrow.addEventHandler("on_selected_elements_changed",r),pinegrow.addEventHandler("on_page_changed",a),pgf.kids&&(s=function(e,t){h()},pinegrow.addEventHandler("on_insight_css_reindexed",s)),function(e){new PgQuickAssignClass(null,e)}),h=function(){o&&(c.detach(),i)&&i.detach();var e,t,n="";p&&(e=p.getPage(),pgf.kids?(t=p.getClasses(),pinegrow.insight.getClassesForPage(e).forEach(function(e){e.key.startsWith("pg-state")||e.key.startsWith("crsa-")||(n+=`<li class="pg-button pg-class-button crsa-input-rule ${t.indexOf(e.key)<0?"class-off":""}" data-class="${e.key}"><span>${escapeHtmlCode(e.key)}</span></li>`)})):(t=p.getClasses(),e&&e.classSorter&&(t=e.classSorter(t)),fe.each(t,function(e,t){n+='<li class="pg-button pg-class-button crsa-input-rule" data-class="'+t+'"><span>'+escapeHtmlCode(t)+'</span><i class="icon icon-close crsa-input-rule-remove"></i></li>'}))),0===n.length&&pgf.kids&&(n='<p style="margin:0;color:#9f9e9a;">No classes are defined.</p>'),l.get(0).innerHTML=n,o&&(l.append(c),l.append(i)),p&&e&&e.callFrameworkHandler("on_classes_shown_in_prop",l)};h()}var _e=function(e,t,n){n=n||"options";try{return e[n]?"function"==typeof e[n]?e[n](e,t):e[n]:null}catch(e){return console.log("get select options error: "+e),null}};function ae(e){var t=fe("#crsa-left-plane .nav-tabs");switch(e){case"lib":t.find("li:eq(0) a").tab("show");break;case"prop":t.find("li:eq(1) a").tab("show");break;case"css":t.find("li:eq(2) a").tab("show");break;case"act":t.find("li:eq(3) a").tab("show");break;case"wp":t.find("li:eq(4) a").tab("show");break;case"project":t.find("li:eq(5) a").tab("show")}}function Q(){var o,n,a,e,r,i,s,l,c,p,d,t,g,u,f,m="function"==typeof testGoldenLayout;arrangeTopBarSizes(),m||(o=pinegrow.getSetting("ui-panel-layout","L,P,C,T").split(","),m=M.offset(),m=h-m.top,n=fe("#crsa-left-plane"),a=fe("#crsa-tree"),e=fe("#textedit_wrapper"),f=fe("#textedit"),fe("#textedit_bar"),u=W.isInEdit()&&!W.showInExternalWindow,n.offset(),t=m,n.css("height",t+"px"),fe("#crsa-rules-out").data("panel").autoSize(),g=t-(t=n.find(".tab-content")).position().top,t.css("height",g+"px"),a.offset(),t=m,a.css("height",t+"px"),r=!0,s=10,l=i=0,c={L:n.is(":visible")?n.width():0,T:a.is(":visible")?a.width():0,C:0},p=function(e){for(var t=0,n=e+1;n<o.length;n++)t+=c[o[n]]+d||0;return t},d=1,o.forEach(function(e,t){switch(e){case"P":s=i+10,r=!1;break;case"C":break;case"L":n.is(":visible")&&(r?(n.css("left",i+"px"),n.css("right","auto"),n.addClass("left-side"),i+=c[e]+d):(n.css("right",p(t)+"px"),n.css("left","auto"),l+=c[e]+d,n.removeClass("left-side")));break;case"T":a.is(":visible")&&(r?(a.css("left",i+"px"),a.css("right","auto"),a.addClass("left-side"),i+=c[e]+d):(a.css("right",p(t)+"px"),a.css("left","auto"),a.removeClass("left-side"),l+=c[e]+d))}}),pinegrow.statusBar.onResize(s-12,l-1),u?(pinegrow.statusBar.$element.hide(),g=f.offset(),t=h-g.top,u=(w-a.width()-(n.width()+n.offset().left))/2,localStorage.crsaCodeEditWidth&&(u=parseInt(localStorage.crsaCodeEditWidth))<200&&(u=200),(f=w-a.width()-0-u)<20&&(u-=20-f,f=20),(t=(t=parseInt(localStorage.crsaCodeEditHeight||.4*h))<80?80:t)>h-80&&(t=h-80),m=(g=h-t)-20,u=s-10,f=l,e.css("height",t+"px").css("left",u+"px").css("right",f+"px").css("top",g+"px"),setTimeout(function(){W.editorSizeChanged()},100)):(pinegrow.statusBar.showIfNeeded(),fe(".empty-canvas").is(":visible")),M.css("height",m+"px"),alignEmptyCanvas(),0<l&&l--,M.crsapages("centerPages",s,l),a.find(".filter-form").css("width",c["T"]-46+"px"),fe.fn.crsapages("canvasResized"))}window.getPreviewPosition=function(e,t){var n=(t=t||fe("#crsa-left-plane")).offset(),o=fe(window).width();return n.left>o-n.left-t.width()?n.left-e-20:n.left+t.width()+0},window.arrangeTopBarSizes=function(){var e=fe("#main-navbar"),t=fe("#crsa-topbar .commands-toolbar"),n=fe("#crsa-topbar .right-toolbar"),o=fe(window).width(),e=(e.removeClass("narrow"),t.removeClass("narrow"),n.removeClass("narrow"),$.removeClass("narrow"),e.get(0).getBoundingClientRect()),a=t.get(0).getBoundingClientRect();n.get(0).getBoundingClientRect();0!==e.height&&(e.left,e.width,a.left,e.left+e.width+a.width>o-140?(t.addClass("narrow"),n.addClass("narrow"),$.addClass("narrow")):e.left+e.width+20>o/2-a.width/2?t.css({marginLeft:20,left:e.left+e.width}):buttonToolbarTopCenter.customReposition())},window.alignEmptyCanvas=function(){var e=fe(".empty-canvas"),t=(e.css("padding-top","0px"),e.height()),n=e.parent().height(),n=parseInt((n-t)/3);e.css("margin-top",(n=n<50?50:n)+"px")};var l=!1,re=(window.canMakeChange=function(e,t,n,o){if(e){if("delete_element"==t&&0<=["html","head","body"].indexOf(e.tagName))return pinegrow.showAlert("<p>Every page needs a <b>"+e.tagName+"</b> element.</p><p>Use the code editor if you really need to delete it.</p>","Can't delete the "+e.tagName+" element"),!1;if(e.singleTag&&"insert_element"==t)return pinegrow.showAlert("<p><b>"+e.tagName+"</b> can't have children elements.</p>","Can't insert element into "+e.tagName),!1;if(e.dynamic&&["remove_class","add_class","attr"].indexOf(t)<0)return pinegrow.showAlert(`<p>This operation is not supported because the element <code>${e.getName({short:!0})}</code> is a dynamic element created by Javascript code.</p><p>That means that any changes done to this element can't be saved back to the HTML source code.</p><p>You can:</p><ul>
<li><b>Select the element</b> in order to style it with the CSS panel.</li>
<li><b>Edit its classes and attributes</b> as part of styling the element. But these changes, including any inline styles, can't be saved.</li>
</ul>
<p><a href="${pgf.docs.dyn_elements_help}" class="external"><b>Learn more</b></a> about working with dynamic elements.</p>`,`Dynamic element can't be edited`),!1;var a=pinegrow.getCrsaPageOfPgParserNode(e);if(a){var r,a=a.callFrameworkHandler("on_can_make_change",e,t,n);if(a)return(o=l?!0:o)||(l=!0,(r=pinegrow.showAlert(a.msg,a.reason)).on("hidden.bs.modal",function(){l=!1}),a.on_display&&a.on_display(r),pinegrow.selectedElements.reselect()),!1}}return!0},window.willMakeChange=function(e,t){e instanceof CrsaPage||console.log("willMakeChange not a CP")},window.removeEmptyPlaceholderFromParents=function(e){for(var t=e.parent;t&&t.hasClass("pg-empty-placeholder")&&t.removeClass("pg-empty-placeholder"),pgf.empty_ph_attribute&&t&&t.hasAttribute(pgf.empty_ph_attribute)&&"always"!==t.getAttribute(pgf.empty_ph_attribute)&&(t.removeAttribute(pgf.empty_ph_attribute),t.placeholderWasAutoRemoved=!0),t=t.parent;);},function(){var e='<ul class="nav navbar-nav main-menu">                    <li class="dropdown menu-file"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span>File</span></a>                        <ul class="dropdown-menu">                            <li class="remove-in-cm pgf_edit_html"><a href="#" class="menu-file-template">New page...</a></li>                            <li><a href="#" class="menu-file-open-file pgf_edit_html">Open file...</a></li>                            <li class="remove-in-cm pgf_edit_html"><a href="#" class="menu-file-open-url">Open url...</a></li>                            <li><a href="#" class="menu-file-open-project">Open project...</a></li>                            <li class="remove-in-cm pgf_simple_file_menu"><a href="#" class="menu-file-open-project-win">Open project in new win...</a></li>                            <li class="remove-in-cm pgf_simple_file_menu"><a href="#" class="menu-file-load-project-lib">Load project as library...</a></li>                            <li class="dropdown menu-file-recent"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Open recent...</a></li>                            <li class="divider menu-save-divider"></li>                            <li><a href="#" class="menu-file-save pgf_save_html">Save</a></li>                            <li class="remove-in-cm pgf_save_html"><a href="#" class="menu-file-save-html">Save HTML only</a></li>                            <li><a href="#" class="menu-file-save-as pgf_save_html">Save as...</a></li>                            <li><a href="#" class="menu-file-save-all pgf_save_html">Save all</a></li>                            <li class="divider pgf_save_html"></li>                            <li><a href="#" class="menu-file-close">Close page</a></li>                            <li><a href="#" class="menu-file-close-all">Close all files</a></li>                            <li><a href="#" class="menu-file-close-project">Close project</a></li>                            <li class="divider menu-project-divider"></li>                            <li><a href="#" class="menu-file-save-project">Remember project</a></li>                            <li><a href="#" class="menu-file-load-project">Load project</a></li>                            <li><a href="#" class="menu-file-download">Download project Zip</a></li>                            <li class="divider pgf_simple_file_menu"></li>                            <li><a href="#" class="menu-file-cache pgf_simple_file_menu">Clear cache</a></li>                            <li><a href="#" class="menu-file-manage-ss pgf_simple_file_menu">Manage stylesheets...</a></li>                            <li><a href="#" class="menu-file-manage-fm pgf_simple_file_menu">Manage libraries &amp; plugins...</a></li>                                                        <li><a href="#" class="menu-file-new-window pgf_simple_file_menu">Open new window</a></li>                            <li class="divider"></li>                            <li><a href="#" class="menu-file-quit">Quit</a></li>                        </ul>                        <ul class="dropdown-menu submenu-file-recent">                            <li><a href="#" class="">New page...</a></li>                            <li><a href="#" class="">Open file...</a></li>                            <li><a href="#" class="">Open from url...</a></li>                        </ul>                    </li>                    <li class="dropdown menu-edit"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>                        <ul class="dropdown-menu">                            <li><a id="crsa-undo" href="#">Undo</a></li>                            <li><a id="crsa-redo" href="#">Redo</a></li>                            <li><a class="menu-show-history" href="#">Show History panel</a></li>                            <li class="divider"></li>                            <li><a class="menu-find-replace" href="#">Find &amp; Replace...</a></li>                            <li class="divider"></li>                            <li><a id="crsa-clipboard" href="#">Show Clipboard</a></li>                        </ul>                    </li>                    <li class="aadropdown menu-page"><a href="#" class="aadropdown-toggle" data-toggle="aadropdown">Page</a>                    </li>                    <li class="aadropdown menu-window insert-custom-here"><a href="#" class="aadropdown-toggle" data-toggle="aadropdown">Window</a>            </li>                    <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Support</a>                        <ul class="dropdown-menu">                           <li><a href="https://pinegrow.com/docs/getting-started/pinegrow-walkthrough-video/" target="_blank" class="external pgf_docs_intro_video">Pinegrow walkthrough - Video</a></li>                           <li><a href="help://intro" target="_blank" class="external pgf_docs_quick_intro">Quick introduction to Pinegrow</a></li>                           <li><a href="help://shortcuts" target="_blank" class="external pgf_docs_shortcuts_url">Keyboard shortcuts</a></li>                            <li class="aaa-remove-in-cm"><a href="help://docs.index" target="_blank" class="external pgf_help_url">Documentation</a></li>                            <li class="remove-in-cm"><a href="https://www.youtube.com/channel/UCo2RGSbsI9GIxVvJPXanUuw/playlists" target="_blank" class="menu-video-tutorials pgf_docs_video_tutorials">Video Tutorials</a></li>                            <li class="remove-in-cm"><a href="https://pinegrow.com#contact" target="_blank" class="menu-support-portal pgf_support_url">Support</a></li>                            <li class="divider"></li>                            <li><a href="#" class="menu-support-settings">Settings...</a></li>                            <li><a href="#" class="menu-support-buy">Purchase &amp; Activate...</a></li>                            <li class="divider"></li>                            <li class="remove-in-cm"><a href="#" class="menu-support-api">Show API url...</a></li>                            <li class="remove-in-cm"><a href="https://pinegrow.com/docs/master-pinegrow/using-external-code-editors/" class="menu-atom">Live sync with Atom &amp; VS Code...</a></li>                            <li class="remove-in-cm"><a href="#" class="menu-support-contact">Contact...</a></li>                            <li><a href="#" class="menu-support-about">About...</a></li>                            <li class="remove-in-cm"><a href="#" class="menu-support-new">What&#39;s new...</a></li>                        </ul>                    </li>                </ul>                <ul class="nav navbar-nav plugin-controls">                </ul>',t=(pgf.project_in_top_menu&&(e=`<ul class="nav navbar-nav main-menu">
<li><a href="#" class="menu-current-project"><span>My Project</span></a></li>
<li><a href="#" class="menu-project-menu">Menu</a></li>

<li><a href="#" class="menu-file-save pgf_save_html">Save</a></li>
</ul>`),'<div id="crsa-topbar" class="navbar navbar-inverse">            <div class="navbar-header">                <a class="navbar-brand external-link" href="'+pgf.product_url+'" target="_blank">                <img class="pg" src="images/logo_pine.png" />'),e=(pgf.logo&&(t+='<img class="pgsub" src="images/'+pgf.logo+'"/>'),pgf.logo_name&&(t+=`<span class="logo-name">${pgf.logo_name}</span>`),t+='</a>            </div>            <div class="" id="main-navbar">'+e+"</div>        </div>",(t=R.navBar?R.navBar:t)+'        <div class="canvas">        </div>            <div id="crsa-left-plane" class="tabbable">                 <i class="hider fa fa-minus"></i>                <ul class="nav nav-tabs">                    <li class="active"><a href="#tab1" data-toggle="tab" data-pg-tab="Lib">Lib</a></li>                    <li><a href="#tab3" data-toggle="tab" data-pg-tab="Prop">Prop</a></li>                    <li><a href="#tab4" data-toggle="tab" data-pg-tab="Css">CSS</a></li>                    <li><a href="#tab5" data-toggle="tab" data-pg-tab="Act">Act</a></li>                    <li><a href="#tab2" data-toggle="tab" data-pg-tab="Wp">WP</a></li>                    <li><a href="#tab-project" data-toggle="tab" data-pg-tab="Prj">Prj</a></li>                </ul>                <div class="tab-content">                    <div class="tab-pane active" id="tab1">                        <div id="crsa-elements" class="crsa-panel crsa-search-panel">                            <div class="header"></div>                            <div class="content"></div>                        </div>                    </div>                    <div class="tab-pane" id="tab3">                        <div id="crsa-properties" class="crsa-properties crsa-panel">                        </div>                    </div>                    <div class="tab-pane" id="tab4">                        <div id="crsa-rules" class="crsa-panel">                        </div>                        <div id="crsa-rule-edit" class="crsa-properties crsa-panel">                        </div>                    </div>                    <div class="tab-pane" id="tab5">                        <div id="crsa-actions" class="crsa-panel crsa-search-panel">                            <div class="header"></div>                            <div class="content"></div>                        </div>                    </div>                    <div class="tab-pane" id="tab2">                        <div id="crsa-cms" class="crsa-panel crsa-search-panel">                            <div class="header"></div>                            <div class="content"></div>                        </div>                    </div>                    <div class="tab-pane" id="tab-project">                        <div id="crsa-project" class="crsa-panel crsa-search-panel">                            <div class="header"></div>                            <div class="content  crsa-project-list"></div>                        </div>                    </div>                </div>            </div>        <div id="tooltip-garbagebin" style="display:none;"></div>        <div class="crsa-edit-toolbar"></div>        <input id="crsa-dummy-field" style="position:absolute;top:-1000px;" />        <div id="crsa-dummy-div" style="position:absolute;top:-1000px;" />');e+=`<div class="pg-splash-screen" style="position: absolute;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background-color: #373738;
    display: flex;
    align-content: center;
    justify-content: center;
    align-items: center;
    z-index: 100;
    color: #afafaf;
    text-align: center;
    font-size: 13px;
    font-family: "Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji" sans-serif;
    transition: opacity 0.2s;
    ">
    <div>
    Loading, please wait...
</div><div class="pg-splash-screen-sensor" style="display:none;position:absolute;height:1px;width:1px;"></div>
</div>`,fe("body").append(e),isApp()&&(fe(".external-link").on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)}),crsaHandleExternalLinks(fe("#crsa-topbar"))),fe("ul.dropdown-menu [data-toggle=dropdown]").on("click",function(e){e.preventDefault(),e.stopPropagation(),fe(this).parent().addClass("open"),fe(this).parent().find("ul").parent().find("li.dropdown").addClass("open")}),fe(".canvas").on("mousewheel",function(e){}),pgf.brand_dropdown_menu||addTooltip(fe(".navbar-brand"),pgf.product_name+" - click to visit the homepage.")}),ie=function(){var e,t,n;pinegrow.isPRO()||(e="#crsa-project",(t=pinegrow.isProTrialActive())&&(e+=", #crsa-actions"),n=crsaIsBig()?"Upgrade to PRO":"Buy Pinegrow",e=fe(e).addClass("with-pro-notice"),t='<div class="pro-notice"><p>Projects, master pages and components are features of PRO edition.'+(t&&crsaIsBig()?" <b>PRO Trial is active.</b>":"")+'</p><p><a href="#" class="upgrade btn btn-xs btn-primary">&nbsp;'+n+' »&nbsp;</a> <a href="'+pinegrow.pro_info_url+'" class="external learn-more btn btn-xs btn-link">Learn more »</a></p></div>',(n=fe(t).prependTo(e)).find("a.upgrade").on("click",function(e){e.preventDefault(),crsaIsBig()?pinegrow.showBuyProductScreen("PRO"):showIntroScreen()}),crsaHandleExternalLinks(n))};function se(e,t){showIntroScreen(e,t)}function le(e,t){var n='<p>Download Pinegrow desktop app for Windows and Mac to <b>open and save your local files directly</b>.</p><p><a href="https://pinegrow.com" target="_blank">Download Pinegrow for Mac, Windows and Linux</a></p>',n=(e&&(n=e+n),makeModalDialog("Download Pinegrow Web Designer"+(t?" "+t:""),"Close",null,n));isApp()&&n.find("a.link").on("click",function(e){e.preventDefault();var t=require("nw.gui"),n=fe(e.delegateTarget).attr("href");t.Shell.openExternal(n)})}function u(e){var t,n,o,a,r,i;return e.preventDefault(),e.stopPropagation(),!pgf.kids&&(t=S(t=e.target),t=fe(t),r=pinegrow.getSelectedPage(),t.is("html")&&(t=t.find("body")),n=new CrsaContextMenu(null,t),o=getElementPgNode(t))&&((i=pinegrow.selectedElements.isSelectedElement(o))&&crsaIsInEdit()&&(i=!1),e.shiftKey?a=new PgInsertLibElementMenu(o,i?null:o,!0).getActions():(a=he.getActionsMenuFor(o,i,e),o&&r.callFrameworkHandler("on_build_actions_menu",a,o,i)),n.actions=a,n.$target=t,n.targetPgel=o,n.addSmartInput(),i=(r=getPageViewOfElement(t)).pageRectToGlobalRect({left:e.pageX,top:e.pageY}),n.set$Body(r.getPageParent$Body()),n.setDocument(r.getPageParentDocument()),n.showAt(i.left,i.top),n.updatePosition(!0)),!1}window.getPageSource=function(e){var t=getIframeDocument(e.get(0)),t=fe(t).find("> html"),t=0<t.length?t[0].innerHTML:"";return t=removeCrsaClassesFromHtml(t=(t=t.replace(/(<[^>]*)\s*contenteditable="true"/gi,"$1")).replace(/(<[^>]*)\s*style=""/gi,"$1"))},window.showBuyScreen=se,window.addScrollHandlerToFrame=function(r,i){var d;pgf.select_elements&&(d=r.get$Iframe(),r.getPage(),function(t){function e(e){repositionSelectedElementMenu(!0),r.onScroll(e),g&&K(null),t.delayedTasks.run("repositionAfterScroll",function(){repositionSelectedElementMenu(!1)},500)}var s,n,l,c,p,o=d.get(0).contentDocument,a=(o.removeEventListener("scroll",e,!0),i||o.addEventListener("scroll",e,!0,!1),fe(o).off("keydown.crsa"),i||fe(o).on("keydown.crsa",function(e){he.processKeydownEvent(e)}),fe(o).off("keyup.crsa"),i||fe(o).on("keyup.crsa",he.processKeyupEvent),o.removeEventListener("contextmenu",u,!0),i||o.addEventListener("contextmenu",u,!0,!1),o.removeEventListener("click",E,!0),i||o.addEventListener("click",E,!0,!1),o.removeEventListener("dblclick",Se,!0),i||o.addEventListener("dblclick",Se,!0,!1),o.removeEventListener("input",Ee,!0),i||o.addEventListener("input",Ee,!0,!1),o.removeEventListener("mousemove",ce,!0),i||o.addEventListener("mousemove",ce,!0,!1),o.removeEventListener("mouseover",de,!0),i||o.addEventListener("mouseover",de,!0,!1),o.removeEventListener("mouseout",ge,!0),i||o.addEventListener("mouseout",ge,!0,!1),o.removeEventListener("mouseenter",ue,!0),i||o.addEventListener("mouseenter",ue,!0,!1),o.removeEventListener("mouseleave",Pe,!0),i||o.addEventListener("mouseleave",Pe,!0,!1),o.removeEventListener("mouseup",pinegrow.getClipboard().onPageMouseUp),i||o.addEventListener("mouseup",pinegrow.getClipboard().onPageMouseUp),o.removeEventListener("mousedown",ke,!0),i||o.addEventListener("mousedown",ke,!0,!1),isApp()||(o.removeEventListener("dragstart",Ce,!0),i)||o.addEventListener("dragstart",Ce,!0,!1),d.get(0).contentWindow);a.ondragover=i?null:function(e){return e.preventDefault(),!1},a.ondrop=i?null:function(e){return e.preventDefault(),!1},r.pageElementsDragHelper&&(r.pageElementsDragHelper.destroy(),r.pageElementsDragHelper=null),i||pgf.kids||((s=r.pageElementsDragHelper=new PgDragHelper(fe(o),"*:not(body,html,head)",r.getPageParentDocument()))._oAnotherDocument=fe(o),s._nDelay=500,s._nDistance=1e3,n=!1,s.onBefore=function(e){return!!pgf.edit_html&&((0<e.closest('[contenteditable="true"]').length||N)&&(n||setTimeout(function(){n=!1},1),n=!0),!n)},p=c=l=null,s.on("dragStart",function(e,t,n){fe.fn.crsapages("showOverlays");var o,a=p=s.dragTarget,r=getElementPgNode(a),i=getCrsaPageOfElement(a);r||(o={$el:a,pgel:null},i.callFrameworkHandler("on_dynamic_element",o),a=p=o.$el,r=o.pgel),r?(r=pinegrow.getChildOfForceParent(r,function(e){a=p=e.get$DOMElement()}))&&(c=a.attr("style"),a.css("opacity","0.35"),(l=new PgDragMenu(i.getMainType(null,r),!0,!0,null,r)).pgel=r,l.movedPgel=r,crsaFuncs.setDraggedMenu(l),l.handleMoveEvent(n,l)):pinegrow.showQuickError("Can't move a dynamic element.")},this),s.on("drag",function(e,t,n){l&&l.handleMoveEvent(n,l)},this),s.on("dragStop",async function(e,t){"string"==typeof c?p.attr("style",c):p.removeAttr("style"),fe.fn.crsapages("showOverlays",!0),l&&(await l.insertAsync(),l.destroy(),l=null,crsaFuncs.setDraggedMenu(null),crsaFuncs.showInsertionLine(null),pinegrow.highlightElement(null))},this))}(getCrsaPageForIframe(d)))},window.highlightUIElement=function(e,t){t=t||"show-ui-element",e.addClass(t),setTimeout(function(){e.removeClass(t)},350)};var m=function(){highlightUIElement(fe(".test-clicks-control"),"show-click")};function S(e){if(e.ownerSVGElement){var t=e.closest("svg");if("false"!==t.getAttribute("data-pg-collapsed")){if("paint"===pinegrow.paintToolManager.getMode()&&pinegrow.paintToolManager.getTool())return e;e=t}}return e}function E(e){var t,n,o,a,r,i,s,l,c;if(!pinegrow.getIgnoreClicks())return t=new CrsaProfile,document.activeElement&&"crsa-dummy-field"!==document.activeElement.id&&fe(document.activeElement).is("input,select, textarea")&&document.activeElement.blur(),n=S(n=e.target),o=fe(n),a=getCrsaPageOfElement(o),pinegrow.lastActivePage.setPage(null),r=getElementPgNode(o),s={stop:!1,multi:crsaIsCmdPressed(e),event:e,pgel:r},pinegrow.dispatchEvent("on_element_clicked",a,r,o,s),s.stop?(e.stopPropagation(),e.preventDefault(),!1):(l=N,(l=e.altKey?!N:l)?(m(),!(o=(l=o.closest("a")).length?l:o).attr("href")||(setTimeout(function(){a.refreshDisplay()},50),(l=o.attr("href")).startsWith("//")&&(l=new URL(a.url).protocol+l),i=crsaRemoveUrlParameters(l),l=a.makeAbsoluteUrl(l),"default"!==pinegrow.getMimeType(l)&&!pinegrow.isFileEditable(l))||(i.length?(crsaIsFileUrl(l)&&"file"!==crsaIsFileOrDir(crsaMakeFileFromUrl(l))?pinegrow.showQuickMessage(o.attr("href")+" not found!",3e3,!1,"error"):(pinegrow.showQuickMessage("Opening "+o.attr("href")+"..."),pinegrow.openOrShowPage(l,null,!0,!0),e.stopPropagation(),e.preventDefault()),!1):""!=i&&crsaRemoveUrlParameters(l)!=a.url||!n.hash||!e.altKey||(i=n.hash,a.getWindow().location.hash=i,!1))):n.hasAttribute("data-pg-allow-click")?(o.get(0).href&&(l=A.getOriginalUrl(o.get(0).href),pinegrow.openOrShowPage(l),e.stopPropagation(),e.preventDefault()),!1):n.hasAttribute("data-pg-external-link")?isApp()?(pinegrow.openExternalUrl(n.getAttribute("href")),!1):void 0:pinegrow.inlineEditManager.is$ElementInsideEdited(o)||pinegrow.inlineEditManager.is$ElementEdited(o)?(o.closest("a").length&&e.preventDefault(),!0):((i=o.find("body")).length&&(o=i),t.show("on el click 1"),r||(s={$el:o,pgel:null},a.callFrameworkHandler("on_dynamic_element",s),o=s.$el,r=s.pgel),r?(l=!1,crsaIsCmdPressed(e)?l="cmd":e.shiftKey&&(l="shift"),(c=a.getPageViewOf$DOMElement(o))&&c!=a.activeView&&a.view.setActiveView(c,!1),r=pinegrow.getChildOfForceParent(r,function(e){o=e.get$DOMElement(c.get$Html())},!1,!0),l||pinegrow.autoFocusOnElementIfNeeded(r),z(r,"click",l,o,e),c&&pinegrow.dispatchEvent("on_element_clicked_in_page_view",a,c,r,o),pinegrow.getShowDisplayHelpers()||highlightUIElement(fe("#crsa-topbar .helpers .with-carret"),"show-click")):pgf.kids?a.refresh():a.wrapper_node&&!o.get(0).closest("[data-pg-id]")?pinegrow.showQuickError("This element is a part of the wrapper page and can not be selected."):pgDynElementMessage("Can't select element created at run time."),t.show("on el click 2"),e.stopPropagation(),e.preventDefault(),$.trigger("click"),void t.show("on el click done")))}function ce(e){pinegrow.pineCone&&pinegrow.pineCone.onMouseMoveOverPage&&pinegrow.pineCone.onMouseMoveOverPage(e),pinegrow.paintToolManager.onMouseMoveOverPage(e),pinegrow.mousePosition.registerPositionInIframe(e)}function de(e){if(N)return!0;var t,n,o,a,r;F||pinegrow.shouldHighlightElements&&pinegrow.getShowDisplayHelpers()&&(o=S(o=e.target),t=fe(o),n=t.closest("html"),"HTML"!=o.tagName)&&((o=getElementPgNode(t))||(a=getCrsaPageOfElement(t))&&(r={$el:t,pgel:null},a.callFrameworkHandler("on_dynamic_element",r),t=r.$el,o=r.pgel),K(t=!o||(o=pinegrow.getChildOfForceParent(o,function(e){t=e.get$DOMElement(n)},!1,!0))?t:null))}function ge(e){if(N)return!0;var t;F||pinegrow.shouldHighlightElements&&(t=S(t=e.target),fe(t),K(null))}function ue(e){}function Pe(e){}function ke(e){if(N)return!0;F||(e.ctrlKey||e.shiftKey)&&e.preventDefault()}function Ce(e){e.target.getAttribute("draggable")||e.preventDefault()}function Se(e){var t,n,o,a;if(e.altKey?!N:N)return!0;pinegrow.paintToolManager.getTool()||pgf.kids||(t=e.target,getCrsaPageOfElement(t=fe(t)),(n=getElementPgNode(t))&&(isApp()&&"img"===n.tagName?canMakeChange(n,"attr","src")&&(a=crsaGetObjectParentUrl(n,o={mapped:!1,mappedBaseUrl:null}),PgChooseFile(function(e,t){e&&pinegrow.makeChanges(n,"Set image",function(){n.setAttr("src",e),pinegrow.reselectElement(n)})},{parent_url:a,save_as:null,folder:null,no_proxy:null,no_url:null,must_be_in_base_to_be_relative:o.mappedBaseUrl})):(a=n.closest("svg"))?"false"===a.getAttribute("data-pg-collapsed")?(a.removeAttribute("data-pg-collapsed"),pinegrow.showQuickMessage("SVG is now collapsed.")):(a.setAttribute("data-pg-collapsed","false"),pinegrow.showQuickMessage("SVG is now expanded.")):(pinegrow.inlineEditManager.edit(t,!0,!1,e),pinegrow.getSetting("ui-explainer-double-click-inline-text")||(pinegrow.current_ui_explainer&&(pinegrow.current_ui_explainer.close(),pinegrow.current_ui_explainer=null),pinegrow.current_ui_explainer=new PgUIElementExplainer(fe(".pg-inline-edit-toolbar"),'Double click activates the inline text editing mode. You can now edit the text of the selected element. Press the <reveal sel=".pg-inline-edit-toolbar .pg-text-edit-menu-done">Done button</reveal> to finish text editing, or simply select another element.',{show_delay:500,close_delay:1e5,focus:!1,position:"auto",width:320,scroll_container:null,button:"Got it!",on_close:function(){pinegrow.setSetting("ui-explainer-double-click-inline-text","1"),pinegrow.current_ui_explainer=null}})))),e.preventDefault(),e.stopPropagation())}function Ee(e){if(N)return!0;var t=e.target;fe(t).is("input")&&setTimeout(function(){showNotice("If you want to edit field's initial value do that in PROP panel.","Notice","edit-field-value")},100)}function Te(n){!1!==pgf.whatsnew&&pinegrow.getComponent("whatsnew",function(e){var t=e.html,t=showNotice(t,"What's new in Pinegrow "+crsaGetVersion(),"new_version_"+crsaGetVersion(),null,!0,n);t&&(t.addClass("whats-new"),t.find(".pgf_whatsnew_left").html(pgf.whatsnew.left),t.find(".pgf_whatsnew_right").html(pgf.whatsnew.right),t.find(".pgf_whatsnew_image").attr("src",pgMakeFileUrl(crsaGetBaseForUrl(window.location.href))+"/"+pgf.whatsnew.image),(t=t.find(".modal-footer")).find(".ok").removeClass("btn-primary btn-sm").addClass("btn-default btn-lg").html("Close"),fe(`<a href="${pgf.whatsnew.url}" class="external btn btn-primary btn-lg">Learn more</a>`).prependTo(t).on("click",function(e){e.preventDefault()}).css({"margin-right":"12px"}))})}window.setUIZoom=function(t){isApp()&&(require("nw.gui").Window.get(),pgGetAppWindows().forEach(function(e){pgAppWindowSetZoom(e,t)}),setTimeout(function(){0<t&&fe("body").width()<1e3&&(pinegrow.showAlert("<p>The window size at the chosen zoom level was too small. If you need such large magnification, please make the Pinegrow window bigger or use a larger screen.</p><p>The UI zoom was restored to the default value.</p>","The UI is too small",null,"OK",null,function(){}),setUIZoom(0))},2e3))},window.getUIZoom=function(){var e=require("nw.gui").Window.get().zoomLevel;return e=-2.224==e?-2:e},window.updateProductInfoIn$Element=function(e){e.find(".pgf_support_url").attr("href",pgf.docs.support_url),e.find(".pgf_help_url").attr("href",pgf.docs.help_url),e.find(".pgf_buy_url").attr("href",pgf.buy_url),pgf.docs.shortcuts_url?e.find(".pgf_docs_shortcuts_url").attr("href",pgf.docs.shortcuts_url):e.find(".pgf_docs_shortcuts_url").parent().remove(),pgf.docs.intro_video_url?e.find(".pgf_docs_intro_video").attr("href",pgf.docs.intro_video_url).html(pgf.docs.intro_video_label):e.find(".pgf_docs_intro_video").parent().remove(),pgf.docs.video_tutorials_url?e.find(".pgf_docs_video_tutorials").attr("href",pgf.docs.video_tutorials_url):e.find(".pgf_docs_video_tutorials").parent().remove(),pgf.docs.quick_intro_url?e.find(".pgf_docs_quick_intro").attr("href",pgf.docs.quick_intro_url).html(pgf.docs.quick_intro_label):e.find(".pgf_docs_quick_intro").parent().remove(),pgf.save_html||e.find(".pgf_save_html").remove(),pgf.edit_html||e.find(".pgf_edit_html").remove(),pgf.simple_file_menu&&e.find(".pgf_simple_file_menu").remove(),pgf.clipboard||e.find(".menu-edit").remove(),pgf.simple_file_menu&&(e.find(".menu-page").remove(),e.find(".menu-window").remove()),pgf.settings||e.find(".menu-support-settings").parent().remove(),!1===pgf.whatsnew&&e.find(".menu-support-new").parent().remove()};var Ie=!0,Y=function(e,t){void 0===t&&(t=0);for(var n,o=[],a=(e?o.push(e):o=pinegrow.getAllPages(),{save:!0,reason:""}),r=0;r<o.length;r++)o[r].callFrameworkHandler("on_can_save_page",a);return a.save?(n=function(e){setTimeout(function(){se(),pinegrow.alert("Saving files is disabled.")},e)},(crsaIsBig()||!ee)&&!!Ie||(n(),!1)):(setTimeout(function(){pinegrow.showAlert(a.reason,"The page can't be saved","Close","Purchase &amp; Activate",null,function(){se()})},t),!1)},Ae=(window.canDoStuffOrIsTrialDisabled=function(){return!(!crsaIsBig()&&ee&&(show(),1))},window.canSavePage=function(e){return Y(e)},function(e){var t=!0,n=crsaStorage.getValue("validDate");(t=n?parseFloat(n)<(new Date).getTime()/1e3:t)&&crsaStorage.getValue("currentVersion")!=crsaGetVersion()?checkLicense():getLicenseInfo(function(t,e,n){t&&t.sub_id&&("past_due"==t.sub_status?t.sub_update_url&&pinegrow.getComponent("payment-due",function(e){pinegrow.showAlert(e.html,"Notice").find(".update-url").attr("href",t.sub_update_url)}):"deleted"==t.sub_status&&(Ie=!1,deactivateLicense(),pinegrow.showAlert("Your Pinegrow subscription expired.","Subscription expired",null,"OK",null,showIntroScreen)))})});window.crsaIsCmdPressed=function(e){return isApp()?is_mac?e.metaKey:e.ctrlKey:is_mac_browser?e.metaKey:e.ctrlKey},window.crsaFuncs={findActionMenuForInsertingDefIntoEl:function(n,e,t){t=t||x.getAllTypes(null,e);var o=null;return fe.each(t,function(e,t){if(t.action_menu&&t.action_menu.add&&0<=t.action_menu.add.indexOf(n.type))return o=t.action_menu,!1}),o},insertThroughActionMenu:function(a,e,r,i,s){var l,t=pinegrow.getCollection(e),c=new PgCollection;return t.forEachElement(function(n){var e,t,o=new pgParserSourceProblem(n);n||o.add("element",n,"find"),o.ok()?(e=n.getPage(),t=n.getName(),willMakeChange(e,"Add element / "+t),pinegrow.repeater.repeat(function(e){l=createElementFromDefinition(r);var t=getElementPgNode(l);if(0==e&&!canMakeChange(n,"insert_element",{inserted:t}))return!1;a&&a.on_add?a.on_add(n,t,r,s):s?n.prepend(t):n.append(t),(l=t.get$DOMElement()).data("crsa-def",null),i&&(z(t),t.scrollTo(),i=!1),c.add(t)})):showAlert(o.toString(),"Can't edit this element")}),pinegrow.changeManager.didInsert(c,null,!0,{insert_operation:"insert_with_action_menu"}),pinegrow.repeater.done(),l},insertBeforeOrAfter:function(e,r,i,s){var l,t=pinegrow.getCollection(e),c=new PgCollection;return t.forEachElement(function(o){var a=o.getPage(),e=new pgParserSourceProblem(o);o||e.add("element",o,"find"),e.ok()?pinegrow.repeater.repeat(function(e){var t=getElementName(l=createElementFromDefinition(r),r),n=getElementPgNode(l);if(0==e&&!canMakeChange(o.parent,"insert_element",{inserted:n}))return!1;willMakeChange(a,"Add element / "+t),s?n.insertAfter(o):n.insertBefore(o),(l=n.get$DOMElement()).data("crsa-def",null),i&&z(n),c.add(n)}):showAlert(e.toString(),"Can't edit this element")}),pinegrow.changeManager.didInsert(c,null,!0,{insert_operation:"insert_crsa"}),pinegrow.repeater.done(),crsaQuickMessage("Element <b>"+name+"</b> was inserted."),l},replaceElement:function(e,r){var t=pinegrow.getCollection(e),i=new PgCollection,s=new PgCollection;t.forEachElement(function(e){var o,t=createElementFromDefinition(r),n=getElementPgNode(t),a=new pgParserSourceProblem(e);e||a.add("element",e,"find"),n||a.add("element",getElementName(t),"find"),a.ok()?canMakeChange(e.parent,"insert_element",{inserted:n})&&(o=n,e.replaceWith(n),s.add(e),i.add(n),pinegrow.repeater.repeatOthers(function(e,t){var n=createElementFromDefinition(r),n=getElementPgNode(n);n.insertAfter(o),o=n,i.add(n)})):showAlert(a.toString(),"Can't edit this element")}),pinegrow.repeater.done(),pinegrow.changeManager.batchChanges(function(){pinegrow.changeManager.didDelete(s),pinegrow.changeManager.didInsert(i,null,!0,{insert_operation:"replace_element"})},"Replace element"),crsaQuickMessage("Element was replaced.")},createPreviewElementFromDefinition:function(e){if(pgf.kids&&e.preview_description)return fe(`<div>${e.preview_description}</div>`);var t;if(e.preview_image)return t=fe("<img/>"),r=e.framework.getImagePreviewBaseUrl()+e.preview_image+"?z="+pinegrow.cache_breaker,t.attr("src",r),t.data("crsa-def",e),t.get(0).crsaDef=e,t;var n=e.preview?"function"==typeof e.preview?e.preview(s()):e.preview:getCodeFromDefinition(e);if("none"==e.preview||!n)return null;for(var o=["html","body","head>"],a=0;a<o.length;a++)0<=n.indexOf("<"+o[a])&&(n="<p>Can not preview elements with <b>&lt;"+escapeHtmlCode(o[a])+"&gt;</b>.</p>");var n=(n=(n=(n=pinegrow.createProxyLinksForPlaceholderImagesInCode(n)).replace(/<script/g,"<ascript").replace(/<\/script/g,"</ascript")).replace(/<link/g,"<alink")).replace(/<iframe/g,"<div").replace(/<\/iframe/g,"<span>iframe</span></div"),r=fe("<div/>").append(n).contents();return r.data("crsa-def",e),r.get(0).crsaDef=e,r},deleteCurrentElement:_,duplicateCurrnetElement:v,setDraggedMenu:function(e){F=e},showInsertionLine:q,elementMovedWithMouse:function e(l,t){if(V=V||new PgDOMHelper,t=t||F){var n=l.view,c=null,p=0,d=0,g=null;try{var o,a,r,i,s,u,f,h,m,w,_,v="none";if((o=pinegrow.isOverTreeView(l,t))&&(m=o.treeView.getDropPositionInfo(l,t,o),v="tree",m)&&(t.treeDropPosition=m,"html"===t.dragType?(i=m.$e.closest("body"),m.data.pgel,q(m.$e,m.position,null,null,null,null,m.target_pgel?m.target_pgel.getName({short:!0}):null)):pinegrow.getTreeViews().forEach(function(e){e.canHandleDragType&&e.canHandleDragType(t.dragType)&&e.markInsertPositionInTree(m.data,m.position,!0)})),m||n!==window||"html"!==t.dragType||(u=M.crsapages("getZoom"),oe.each(function(e,t){fe(t);var n=V.closestWithClass(t,"page-tab-canvas"),o=(V.getScrollLeft(n),V.getWidth(n)),n=V.getOffset(n),a=V.getOffset(t),r=V.getWidth(t),i=V.getHeight(t),s=Math.max(n.left,a.left);if(l.pageX>=s&&l.pageX<=Math.min(a.left+r,n.left+o)&&l.pageY>=a.top&&l.pageY<=a.top+i)return c=V.findChildByTag(t,"IFRAME"),p=l.pageX-a.left,d=l.pageY-a.top,(g=getPageViewOfIframe(c))&&g.dragOver({left:p,top:d,height:i}),!1}),t.overInvalidParent=!1,c&&(fe(c),r=getIframeDocument(a=c),i=fe(getIframeBody(a)),s=g?g.getPage():getCrsaPageForIframe(fe(a)),u=M.crsapages("getZoom",s),p/=u,d/=u,f=r.scrollingElement.scrollTop,h=r.scrollingElement.scrollLeft,w=fe(r.elementFromPoint(p,d)),m=crsaGetPositionOverElement(r,p,d,g?g.getPage():null,t.prev_info||null,l.shiftKey),t.setDropInside(m&&m.collapsed||!1),v="page",t.prev_info=m)&&m.target_pgel&&("inside-top"===m.position||"inside-bottom"===m.position?t.pgel&&"img"===m.target_pgel.tagName&&"img"===t.pgel.tagName&&!pgf.kids?m.position_label="Replace image":m.target_pgel.canHaveChildren()&&m.target_pgel.canInsertElement(t.pgel||t.movedPgel)||(m.position=m.position.replace("inside-","").replace("left","top").replace("right","bottom")):"body"!==m.target_pgel.tagName||m.position.startsWith("inside-")||(m.position="inside-"+m.position.replace("left","top").replace("right","bottom")))),ne!==g&&(ne&&ne.autoScroll.stopAutoScroll(),ne=g),t.setOver(v),m&&"html"===t.dragType){if(w=0<(w=m.$e).has(i.get(0)).length?i:w,pinegrow.drag_drop_options,w.closest(".crsa-selected"),!w)return!0;if(0<(w=getClosestCrsaElement(w)).length&&(_=w),0===w.length||!_||0===_.length)return!0;if("tree"!==v&&t&&t.parentSelector&&!t.parentSelectorDisabled)for(var b=_;b&&b.length;){if(b.parent().is(t.parentSelector)&&0<=["top","bottom","left","right"].indexOf(m.position)){_=b;break}b.is(t.parentSelector)&&(_=b),b=b.parent()}getElementPgNode(w);var y,P,k,C,S=getElementPgNode(_),E=_.offset(),T=(E.left,E.top,_.width(),_.height(),!1);D&&(clearTimeout(D),D=null),O&&(clearTimeout(O),O=null),t.insertInText=!1,t.forcePosition&&(m.position=t.forcePosition),m.over_center&&(O=setTimeout(function(){O=null,e(l)},200)),!m.over_text||S.script||pgf.kids||(y=null,(y=r.caretRangeFromPoint?r.caretRangeFromPoint(p,d):y)&&3==(P=y.startContainer).nodeType&&P.parentNode==_.get(0)&&(J?(k=y.startOffset,y.setEnd(P,k+1),C=y.getBoundingClientRect(),k==P.length-1&&p-C.left>C.width/4&&(C={left:C.right,top:C.top,height:C.height},k++),C={left:C.left+h,top:C.top+f,height:C.height},q(_,null,C),T=!0,t.position=k,t.insertInText=!0,t.positionTextNode=P,t.positionPgel=S):D=setTimeout(function(){D=null,_.html(s.getViewInnerHTMLForElement(S,!0)),J=!0,e(l)},1600))),T||(q(_,m.position,null,m.grid?m.rect:null,t.forcePositionLabel||m.position_label||null,m.collapsed||!1,m.target_pgel?m.target_pgel.getName({short:!0}):null),t.position=m.position,t.gridPosition=m.grid_position||null,t.positionPgel=S,J=!1,pinegrow.getTreeViews().forEach(function(e){e.canHandleDragType&&e.canHandleDragType(t.dragType)&&e.markInsertPositionInTree&&e.markInsertPositionInTree(S,m.position,!0)}))}else q(null,null,null)}catch(e){console.log(e)}}},positionElementMenu:function(g,u,f,e,h){var t=getCrsaPageForIframe(f),m=fe.fn.crsapages("getZoom",t),w=pgFastdomTasks.create(e);w.measure(function(){for(var e={left:0,top:0},t=0,n=0,t=(e.left+=t,e.top+=n,u.get(0)),n=t.getBoundingClientRect(),o=!1,a=n,r=t;0===a.left&&0===a.top&&0===a.width&&0===a.height&&r.parentNode&&"BODY"!==r.nodeName;)o=!0,a=(r=r.parentNode).getBoundingClientRect();o&&(n.x=n.left=a.left,n.y=n.top=a.top);var i,s=t.ownerDocument.defaultView.getComputedStyle(t),s=parseFloat(s.zoom||1),t=t.ownerDocument.defaultView,l=(n={top:n.top*s+t.pageYOffset,left:n.left*s+t.pageXOffset}).left*m+e.left,c=n.top*m+e.top-t.pageYOffset*m,n=g.outerHeight(),e=g.outerWidth(),t=l,p=c-=n,d=f.width();c<0&&(i=u.outerHeight(),c=c+n+i*m*s,(i=g.parent().height())<c+n)&&(c=i-n),d*m<(l=l<0?0:l)+e&&(l=d*m-e),h&&h({left:t,top:p}),w.mutate(function(){pg$PositionAt(g,l,c)})})},createPgElFromDefinition:createPgElFromDefinition,updateRulesList:we,detagElement:C,addLinkAroundElement:b}}(jQuery);var online_addon,crsaHasChanges=function(){var n,e;return isApp()?(n=!1,e=$.fn.crsapages("getAllPages"),$.each(e,function(e,t){n=n||t.hasChanges()}),n=n||pinegrow.hasUnsavedFrameworks()):(e=pinegrow.getCurrentProject())&&e.hasUnsavedChanges()},crsaLoadedScripts={},crsaLoadScript=function(n,o){var e={};if(!(n in crsaLoadedScripts))return e=$.extend(e||{},{dataType:"script",cache:!0,url:n}),jQuery.ajax(e).done(function(e,t){crsaLoadedScripts[n]=!0,o()});o()},gaNoCookieSendHit=function(e,t,n){var o=parseInt(99999999*Math.random());localStorage.gaNoCookieUid||(localStorage.gaNoCookieUid="uid"+1e9*Math.random());var o="http://www.google-analytics.com/collect?payload_data&v=1&aip=1&z="+o+"&tid="+e+"&cid="+localStorage.gaNoCookieUid+"&t="+t+"&"+n,a=document.createElement("img");a.setAttribute("src",o),a.style.position="absolute",a.style.height="0px",document.body.appendChild(a),setTimeout(function(){$(a).remove()},1e3)},gaNoCookieSendPageView=function(e,t,n){t=encodeURIComponent(t),n=encodeURIComponent(n);gaNoCookieSendHit(e,"pageview","dp="+t+"&dt="+n+"&")},gaNoCookieSendEvent=function(e,t,n,o){void 0===o&&(o=""),t=encodeURIComponent(t),n=encodeURIComponent(n),o=encodeURIComponent(o),gaNoCookieSendHit(e,"event","ec="+t+"&ea="+n+"&el="+o+"&")},gaSendPageView=function(e){var t;"object"==typeof pinegrow&&"1"==pinegrow.getSetting("disable-stats","0")||(t=isApp()?"/PinegrowApp/":"/PinegrowWeb/",isApp()?(crsaIsBig()&&!crsaStorage.getValue("activatedSerial")&&(t+="Banana/"),t+=crsaIsBig()?"Pro/":"Demo/",e&&(t+=e+"/"),t+=crsaGetVersion(),pg_is_beta&&(t+=pg_is_beta),gaNoCookieSendPageView("UA-344271-72",t,"Pinegrow App Run")):"undefined"!=typeof ga&&(e&&(t+=e+"/"),t+=crsaGetVersion(),ga("send","pageview",t)))},crsaIsInEdit=function(){return pinegrow.inlineEditManager.isInEdit()},crsaEndEditModeIfActive=function(){return!!crsaIsInEdit()&&(pinegrow.inlineEditManager.setTextMode(!1,null),!0)},crsaWillChangeDom=function(){},crsaGetKbdDisplay=function(e,t){var n=0<=e.indexOf("SHIFT"),o=0<=e.indexOf("CMD"),a=0<=e.indexOf("ALT"),r=isApp()?is_mac:is_mac_browser,i="";return n&&(i+=t?"SHIFT":"&#8679;",e=e.replace("SHIFT","")),a&&(i+=t?"ALT":r?"&#8997;":"ALT ",e=e.replace("ALT","")),o&&(i+=r?t?"CMD":"&#8984;":t?"CTRL":"^",e=e.replace("CMD","")),i+=$.trim(e)},crsaAddKbd=function(e,t){var n=crsaGetKbdDisplay(t);e.append('<span class="kbdspacer"></span><span class="kbd">'+n+"</span>"),e.parent().addClass("haskbd")},PgCustomLogic=function(){this.nodeFilter=null,this.getTreeRootForElement=null,this.navBar=null,this.defaultZoom="fit",this.showOnlyClassesInProperties=!1,this.openTab="lib",this.textPropsElementNotSelected="Click on any element on the page to show its properties.",this.onPageLoaded=null,this.onPageChanged=null,this.scrollMode=!0,this.warnOnUnloadPage=!0},pgDontShowPageUI=!1,pgIsNodePageUI=function(e){return e.classList.contains("pinegrow-ui-helper")||e.hasAttribute("data-pg-page-ui")&&pgDontShowPageUI},CrsaLocalStorage=function(){function n(){e&&clearTimeout(e),e=setTimeout(function(){var e=JSON.stringify(o),e=window.btoa(encodeURIComponent(e));localStorage.crsaInternal=e},100)}var o={},e=null,a=!0;if(this.setValue=function(e,t){a||isApp()?(o[e]=t,n()):localStorage[e]=t},this.getValue=function(e){return a||isApp()?e in o?o[e]:null:e in localStorage?localStorage[e]:null},this.hasValue=function(e){return a||isApp()?e in o:e in localStorage},a||isApp())if(0&&!localStorage.crsaInternal)$.each(localStorage,function(e,t){o[e]=t}),n();else try{o=JSON.parse(decodeURIComponent(window.atob(localStorage.crsaInternal)))}catch(e){o={}}},pgIsInTrial=function(){return!crsaIsBig()},PgAddOn=function(){function t(e){var t=crsaStorage.getValue("activatedUserEmail")||"",n=crsaStorage.getValue("activatedSerial")||"";return e.replace("{email}",t).replace("{serial}",n).replace("{product}",o.product_id||o.key)}var o=this,n=!1&&pgIsDev(),a=(this.key=null,this.name=null,this.description=null,this.info_url=null,this.image_url=null,this.price=null,this.product_id=null,this.get_it_url="",this.force_active=!1,this.extra_button=null,this.order=0,this.active_label="Active",this.startTrial=function(e){pgStartTrial(this.key,"",function(e){})},this.getTrialStatus=function(e){return pgIsInTrial()?(e("ok"),!0):(e("no"),!1)},!1),r=!1;this.getUpgradeUrl=function(){return crsaStorage.getValue("subId")?"https://pinegrow.com/shop/my-pinegrow":t(this.get_it_url)},this.isActive=function(e){return n?(r=!0,e&&e(r)):this.force_active?e&&e(!0):(pgIsInTrial()||!isApp()?r=!0:a||(r=!!pinegrow.hasActivatedProduct(this.key)),e&&e(r)),r},this.isPurchased=function(){return pinegrow.hasActivatedProduct(this.key)||this.force_active},this.getDisplayHtml=function(){var e=`<div class="addons-item">
    
    <div class="addons-item-desc">
        <h4>${this.name}</h4>
        <div>${t(this.description)}</div>
    </div>
    <div class="addons-item-status">`;return this.isPurchased()?(e+=`<div class="addons-item-status-active">
    <span>${this.active_label} <i class="icon icon-check"></i></span>
    
</div>`,this.extra_button&&(e+=this.extra_button)):e+=`<div class="addons-item-status-not-active">
    <a href="${this.getUpgradeUrl()}" class="btn pg-button pg-button-primary addon-get external">Get it</a>
    <a class="addons-item-link addon-trial" href="#">Start trial</a>
</div>`,e+=`</div>
</div>`}},withPinegrow=function(n){$(function(){"undefined"!=typeof pinegrow&&pinegrow.ready?n(pinegrow):$("body").one("pinegrow-ready",function(e,t){n(t)})})},withPineCone=function(n){withPinegrow(function(){pinegrow.pineCone?n(pinegrow.pineCone):pinegrow.addEventHandler("on_pine_cone_ready",function(e,t){n(t)})})},PgAddOnManager=function(){var n=[];this.register=function(e){n.push(e)},this.getAddons=function(){return n.sort(function(e,t){return e.order<t.order?1:e.order===t.order?0:-1}),n},this.findAddon=function(e){for(var t=0;t<n.length;t++)if(n[t].key===e)return n[t];return null},this.isAddonActive=function(e){var t=this.findAddon(e);return!!t&&t.isActive()},this.hasAllAddons=function(){for(var e=0;e<n.length;e++)if(!n[e].isActive())return!1;return!0}},pgAddOnManager=new PgAddOnManager,pro_addon=new PgAddOn,wc_addon=(pro_addon.key="PRO",pro_addon.name="PRO Edition",pro_addon.description=`<p>Speed up your work with projects, components, master pages and libraries.</p>`,pro_addon.get_it_url="https://pinegrow.com/shop/upgradetopro?email={email}&serial={serial}",pgAddOnManager.register(pro_addon),new PgAddOn),wp_addon=(wc_addon.key="WC",wc_addon.name="Shop Builder for WooCommerce",wc_addon.description=`<p>Create custom WooCommerce themes without coding. Requires WordPress Builder. <a href="https://pinegrow.com/docs/woocommerce/" class="external">Learn more »</a></p>`,wc_addon.price="$50 / year",wc_addon.get_it_url="https://pinegrow.com/shop/upgradetowc/{email}/{serial}",pgAddOnManager.register(wc_addon),new PgAddOn);wp_addon.key="WP",wp_addon.name="WordPress Builder",wp_addon.description=`<p>Create fully-featured custom WordPress themes and plugins without coding. <a href="https://pinegrow.com/docs/wordpress/" class="external">Learn more »</a></p>`,wp_addon.price="$50 / year",wp_addon.get_it_url="https://pinegrow.com/shop/upgradetowp/{email}/{serial}",pgAddOnManager.register(wp_addon),"PG"===pgf.product&&((online_addon=new PgAddOn).key="ONLINE",online_addon.name="Pinegrow Online",online_addon.description=`<p>Edit local projects on your computer with browser-based Pinegrow editor. <a href="https://pinegrow.online/edit/?licenseEmail={email}&licenseSerial={serial}" class="external">Activate it with your license »</a></p>`,online_addon.price="Included",online_addon.get_it_url="https://pinegrow.online/edit/?licenseEmail={email}&licenseSerial={serial}",online_addon.force_active=!0,online_addon.extra_button=`<a href="https://pinegrow.online/edit/" class="btn pg-button pg-button-primary external">Open editor</a>`,online_addon.order=10,online_addon.active_label="Included",pgAddOnManager.register(online_addon));
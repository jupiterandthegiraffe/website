var CrsaSelect=function(t,i,e,c){var h=this;this.$input=t,this.options=null,this.$val=i,this.val_dict={};this.opts=$.extend({},{modal:!0,title:"Select an item",multiple:!1,class:"rich-select"},c),this.setOptions=function(t){this.val_dict={};for(var i=0;i<t.length;i++){var e=t[i];this.val_dict[e.key]=e}this.options=t},this.setOptions(e),this.getSelectedItem=function(){var t=this.$input.val(),i=null;return i=t&&t in this.val_dict?this.val_dict[t]:i},this.paintVal=function(){var t=this.getSelectedItem();this.$val.html(""),t&&this.$val.html(t.html)},this.paintVal(),this.showSelect=function(){var n,l,t,i,a,e,s,o;this.opts.modal&&(n=this.getSelectedItem(),l=null,t=$("<div/>"),i=$('<form class="form-inline search-icon"><div class="form-group"><label for="search-for-icon">Search:</label><input type="search" class="form-control" placeholder="Search for an icon..." style="margin: 10px 2px; min-width: 250px" id="search-for-icon"></div></form>').appendTo(t).find("input"),a=$("<ul/>").addClass(c.class).appendTo(t),e=function(){a.html("");for(var t=0;t<h.finalOptions.length;t++){var i=h.finalOptions[t],e=$("<li/>",{class:"pg-icon-container",title:i.name}).data("item",i).appendTo(a);$(i.html).appendTo(e),$("<span/>").html(i.name).appendTo(e);n==i&&(e.addClass("selected"),l=e)}a.find(">li").on("click",function(t){var i=$(t.delegateTarget),e=i.data("item");l&&(l.removeClass("selected"),l=null),n==e?n=null:(n=e,(l=i).addClass("selected")),s(),o.modal("hide"),t.preventDefault()})},this.finalOptions=this.options,e(),s=function(){h.getSelectedItem()!=n&&(n?h.$input.val(n.key):h.$input.val(""),h.paintVal(),h.$input.trigger("change"))},o=makeModalDialog(this.opts.title,"Cancel","Select",t,function(){},function(){s()}),i.keyup(function(){i.val()?h.finalOptions=h.options.filter(function(t){if(t.name)return t.name.match(i.val())}):h.finalOptions=h.options,e()}))},i.on("click",function(t){h.$input.trigger("crsa-select-show"),h.showSelect(),t.preventDefault()})};